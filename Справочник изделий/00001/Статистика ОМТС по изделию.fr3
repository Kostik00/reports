<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.5.2" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="43019,7628445486" ReportOptions.Description.Text="" ReportOptions.Name="Статистика ОМТС за период по запуску 1.fr3 Справочник изделий" ReportOptions.LastChange="43460,6996243056" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;       SmSm:integer;&#13;&#10;&#13;&#10;&#13;&#10;procedure Memo2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;function FnRezerv:string;&#13;&#10;begin&#13;&#10;  Result:='-';&#13;&#10;&#13;&#10;  if (&#60;Позиции.&#34;PredmKolvo&#34;&#62; &#60;= &#60;Позиции.&#34;KolvoR&#34;&#62;) OR ( &#60;Позиции.&#34;PredmKolvo&#34;&#62; &#60;= &#60;Позиции.&#34;KolvoZap&#34;&#62;) then&#13;&#10;  begin&#13;&#10;    Result:='+';&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;function FnRezerv1:string;&#13;&#10;begin&#13;&#10;  Result:='-';&#13;&#10;&#13;&#10;  if &#60;Позиции.&#34;PredmKolvo&#34;&#62; &#60;= &#60;Позиции.&#34;KolvoR&#34;&#62; then&#13;&#10;  begin&#13;&#10;    if &#60;Позиции.&#34;KolvoR&#34;&#62; &#60;= &#60;Позиции.&#34;KolvoR1&#34;&#62; then&#13;&#10;      Result  :=  '+'&#13;&#10;  end;&#13;&#10;  if &#60;Позиции.&#34;PredmKolvo&#34;&#62; &#60;= &#60;Позиции.&#34;KolvoZap&#34;&#62; then&#13;&#10;  begin&#13;&#10;    if &#60;Позиции.&#34;DataZapUtv&#34;&#62; &#62;=&#60;Позиции.&#34;Date_Zap&#34;&#62; then&#13;&#10;    Result  :=  '+'&#13;&#10;&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;function FnZap:string;&#13;&#10;begin&#13;&#10;  Result:='-';&#13;&#10;&#13;&#10;  if &#60;Позиции.&#34;PredmKolvo&#34;&#62; &#60;= &#60;Позиции.&#34;KolvoZap&#34;&#62; then&#13;&#10;  begin&#13;&#10;    Result  :=  '+'&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;function FnZap1:string;&#13;&#10;begin&#13;&#10;  Result:='-';&#13;&#10;&#13;&#10;  if &#60;Позиции.&#34;PredmKolvo&#34;&#62; &#60;= &#60;Позиции.&#34;KolvoZap&#34;&#62; then&#13;&#10;  begin&#13;&#10;    if &#60;Позиции.&#34;DataZapUtv&#34;&#62; &#62;= Trunc(&#60;Позиции.&#34;Date_Zap&#34;&#62;) then&#13;&#10;    Result  :=  '+'&#13;&#10;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;function FnZapPasp:string;&#13;&#10;begin&#13;&#10;  Result:='-';&#13;&#10;&#13;&#10;  if &#60;Позиции.&#34;PredmKolvo&#34;&#62; &#60;= &#60;Позиции.&#34;KolvoZapPasp&#34;&#62; then&#13;&#10;  begin&#13;&#10;    Result  :=  '+'&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure SmHdrMemoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  SmD:int;&#13;&#10;begin&#13;&#10;  SmSm:=0;&#13;&#10;  SmD:=SUM(FnD,MasterData1);&#13;&#10;&#13;&#10;  ItogMemo.Lines.Values('ОМТС (Дефицит)'):=&#13;&#10;         IntToStr(&#13;&#10;         SmD&#13;&#10;         );&#13;&#10;end;&#13;&#10;&#13;&#10;function FnCnt(I:integer):integer;&#13;&#10;begin&#13;&#10;  Result:=0;&#13;&#10;  if I &#62; 0 then&#13;&#10;    Result:=1;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo31OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  TmpI:integer;&#13;&#10;begin&#13;&#10;  TmpI:= SUM(FnCnt(&#60;ERQuery1.&#34;CNT&#34;&#62;),MasterData1);&#13;&#10;  SmSm:= SmSm + TmpI ;&#13;&#10;&#13;&#10;  if TmpI &#62; 0   then&#13;&#10;&#13;&#10;  case &#60;ERQuery1.&#34;Key_Pasp_Status&#34;&#62; of&#13;&#10;&#13;&#10;    -8,-4:&#13;&#10;         ItogMemo.Lines.Values('ОМТС'):=&#13;&#10;         IntToStr(&#13;&#10;         StrToInt(ItogMemo.Lines.Values('ОМТС'))+&#13;&#10;         TmpI&#13;&#10;         );&#13;&#10;&#13;&#10;&#13;&#10;    -7:&#13;&#10;         ItogMemo.Lines.Values('Конструкторский отдел'):=&#13;&#10;         IntToStr(&#13;&#10;         StrToInt(ItogMemo.Lines.Values('Конструкторский отдел'))+&#13;&#10;         TmpI&#13;&#10;         );&#13;&#10;&#13;&#10;    -5,-6:&#13;&#10;         ItogMemo.Lines.Values('Служба качества'):=&#13;&#10;         IntToStr(&#13;&#10;         StrToInt(ItogMemo.Lines.Values('Служба качества'))+&#13;&#10;         TmpI&#13;&#10;         );&#13;&#10;&#13;&#10;    -3:&#13;&#10;         ItogMemo.Lines.Values('Производство (Испытания)'):=&#13;&#10;         IntToStr(&#13;&#10;         StrToInt(ItogMemo.Lines.Values('Производство (Испытания)'))+&#13;&#10;         TmpI&#13;&#10;         );&#13;&#10;&#13;&#10;&#13;&#10;    0,-1,-2:&#13;&#10;         ItogMemo.Lines.Values('Технологический отдел'):=&#13;&#10;         IntToStr(&#13;&#10;         StrToInt(ItogMemo.Lines.Values('Технологический отдел'))+&#13;&#10;         TmpI&#13;&#10;         );&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;function MyFnNames:string;&#13;&#10;begin&#13;&#10;  Result:= ItogMemo.Lines.Names(&#60;Line&#62;-1);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;function MyFnValues:string;&#13;&#10;begin&#13;&#10;  Result:= ItogMemo.Lines.Values(MyFnNames);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ItogMemoOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;function FnD:integer;&#13;&#10;begin&#13;&#10; Result:=0;&#13;&#10; if FnRezerv = '-' then Result:=1;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Page2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    MasterData3.RowCount:=ItogMemo.Lines.Count;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  SmSm:=0;&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="ERQuery1" DataSetName="ERQuery1"/>
    <item DataSet="MainFrxDS" DataSetName="MainDS"/>
    <item DataSet="PostQRY" DataSetName="Позиции"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="PostQRY" UserName="Позиции" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="DECLARE @DateFrom datetime&#13;&#10;DECLARE @DateTo   datetime&#13;&#10;&#13;&#10;SET @DateFrom = :DateFrom                                      &#13;&#10;SET @DateTo = :DateTo            &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;SELECT &#13;&#10;	P_VKZ_SmPos.*,&#13;&#10; P_VKZ.Cod_Zak,                                     &#13;&#10;	T_VPredm.Cod_Predm,&#13;&#10;	T_VPredm.Name_Predm,&#13;&#10;&#13;&#10;&#13;&#10;	SubjSnab.Name_Sub OtvSnab,             &#13;&#10;	PredmM.Name_Predm Name_Predm_M,&#13;&#10;	PredmM.Sortam SortamM,&#13;&#10;	PredmM.Marka MarkaM,&#13;&#10;	TZ.KolvoR,&#13;&#10;&#13;&#10;	TZ1.KolvoR KolvoR1,&#13;&#10;	TZap.KolvoZap,&#13;&#10;	TZap.Date_Zap,                           &#13;&#10;	TZap1.KolvoZap KolvoZapPasp,                                  &#13;&#10;	&#13;&#10;	TPZ.SUM_TPZ,&#13;&#10;	TPZ.SUM_Tsht                                    &#13;&#10;&#13;&#10;FROM &#13;&#10;	P_VKZ_SmPos&#13;&#10;	INNER JOIN	P_VKZ&#13;&#10;			ON	P_VKZ.Key_VKZ=P_VKZ_SmPos.Key_VKZ_Izdel&#13;&#10;			AND P_VKZ.Cod_SosZ='Д'  &#13;&#10;	INNER JOIN	T_VPredm&#13;&#10;			ON	T_VPredm.Key_Predm = P_VKZ_SmPos.Key_Predm&#13;&#10;	LEFT JOIN	T_SP&#13;&#10;			ON	T_SP.Key_Predm = T_VPredm.Key_Predm&#13;&#10;			AND T_SP.SP_Version = T_VPredm.SP_Version&#13;&#10;	LEFT JOIN	T_SPRows&#13;&#10;			ON  T_SPRows.Key_SP = T_SP.Key_SP&#13;&#10;			AND T_SPRows.SP_position = 0 &#13;&#10;	LEFT JOIN   T_VPredm PredmM&#13;&#10;			ON  PredmM.Key_Predm = T_SPRows.Key_Predm&#13;&#10;	INNER JOIN  T_Prinadl&#13;&#10;			ON  T_Prinadl.Cod_Prin =   T_VPredm.Cod_Prin&#13;&#10;	LEFT JOIN  (SELECT	T_VPredm.Key_Predm,			&#13;&#10;					  SUM(T_TPRows.Tpz) AS SUM_TPZ,&#13;&#10;                      SUM(T_TPRows.Tsht) AS SUM_Tsht&#13;&#10;                       FROM&#13;&#10;                         T_VPredm &#13;&#10;                       INNER JOIN&#13;&#10;                       T_SP &#13;&#10;                               ON T_VPredm.Key_Predm = T_SP.Key_Predm&#13;&#10;							   and T_VPredm.SP_Version = T_SP.SP_Version						     &#13;&#10;                       INNER JOIN&#13;&#10;					   T_TP&#13;&#10;								ON T_SP.Key_SP = T_TP.Key_SP&#13;&#10;                       INNER JOIN&#13;&#10;					   T_TPRows &#13;&#10;                               ON T_TPRows.Key_TP = T_TP.Key_TP &#13;&#10;                       	group by T_VPredm.Key_Predm) TPZ      &#13;&#10;on TPZ.Key_Predm = T_VPredm.Key_Predm                                    &#13;&#10;&#13;&#10;  LEFT JOIN &#13;&#10;(&#13;&#10;&#13;&#10;	SELECT &#13;&#10;		P_VKZ_SMPos.Key_VKZ_Izdel,&#13;&#10;		P_VKZ_SMPos.Key_Predm,&#13;&#10;	--	P_VKZ_SMPos.PredmKolvo,&#13;&#10;	--	P_VKZ_SMPos.DataZapUtv,&#13;&#10;		SUM(SmTBL.Kolvo) KolvoR&#13;&#10;&#13;&#10;	FROM  P_VKZ_SMPos&#13;&#10;&#13;&#10;		LEFT JOIN &#13;&#10;		(&#13;&#10;		  SELECT   &#13;&#10;			   P_VKZ.Key_VKZ_Izdel&#13;&#10;			  ,P_VKZ.Key_VKZ&#13;&#10;			  ,P_VKZ.Key_Predm&#13;&#10;			  ,P_VKZ.Kolvo&#13;&#10;		  FROM  &#13;&#10;			P_VKZ&#13;&#10;&#13;&#10;			LEFT JOIN T_SPRows T_SPRows_BySP&#13;&#10;				ON T_SPRows_BySP.Key_SPRow = P_VKZ.Key_SPRow&#13;&#10;  &#13;&#10;		 INNER JOIN P_VKZ_Zap_Det&#13;&#10;		  ON P_VKZ_Zap_Det.Key_Vkz = P_VKZ.Key_Vkz&#13;&#10;&#13;&#10;		 INNER JOIN P_VMZ&#13;&#10;		  ON P_VMZ.Key_VKZ_Zap =  P_VKZ_Zap_Det.Key_VKZ_Zap                                                            &#13;&#10;    &#13;&#10;			INNER JOIN  T_SPRows&#13;&#10;				ON T_SPRows.Key_SPRow = P_VMZ.Key_SPRow&#13;&#10;				AND T_SPRows.SP_Position = '0'&#13;&#10;&#13;&#10;			INNER JOIN &#13;&#10;			(&#13;&#10;				SELECT        &#13;&#10;					P_VMZ.Key_VMZ, &#13;&#10;					P_VMZ.KolDSE, &#13;&#10;					Isnull(SUM(A_Rezerv.KolDT),0) AS SMR&#13;&#10;				FROM            &#13;&#10;					P_VMZ &#13;&#10;					LEFT JOIN A_Rezerv &#13;&#10;						ON P_VMZ.Key_VMZ = A_Rezerv.Key_VMZ&#13;&#10;				GROUP BY P_VMZ.Key_VMZ, P_VMZ.KolDSE&#13;&#10;				HAVING P_VMZ.KolDSE &#60;= Isnull(SUM(A_Rezerv.KolDT),0)&#13;&#10;			) SMR&#13;&#10;			ON SMR.Key_VMZ = P_VMZ.Key_VMZ&#13;&#10;&#13;&#10;		GROUP BY&#13;&#10;				P_VKZ.Key_VKZ_Izdel&#13;&#10;			   ,P_VKZ.Key_VKZ&#13;&#10;			   ,P_VKZ.Key_Predm&#13;&#10;			   ,P_VKZ.Kolvo&#13;&#10;		HAVING&#13;&#10;			P_VKZ.Kolvo &#60;= SUM(P_VKZ_Zap_Det.KolvoZapPln)&#13;&#10;		) SmTBL&#13;&#10;		ON &#13;&#10;			SmTBL.Key_VKZ_Izdel = P_VKZ_SMPos.Key_VKZ_Izdel&#13;&#10;		AND SmTBL.Key_Predm = P_VKZ_SMPos.Key_Predm&#13;&#10;	GROUP BY&#13;&#10; &#13;&#10;		P_VKZ_SMPos.Key_VKZ_Izdel,&#13;&#10;		P_VKZ_SMPos.Key_Predm,&#13;&#10;		P_VKZ_SMPos.PredmKolvo &#13;&#10;	HAVING SUM(SmTBL.Kolvo) &#62;= P_VKZ_SMPos.PredmKolvo&#13;&#10;&#13;&#10;) TZ&#13;&#10;  ON TZ.Key_VKZ_Izdel	= P_VKZ_SmPos.Key_VKZ_Izdel&#13;&#10;  AND TZ.Key_Predm		= P_VKZ_SmPos.Key_Predm&#13;&#10;&#13;&#10;&#13;&#10;LEFT JOIN&#13;&#10;(&#13;&#10;&#13;&#10;&#13;&#10;	SELECT &#13;&#10;		P_VKZ_SMPos.Key_VKZ_Izdel,&#13;&#10;		P_VKZ_SMPos.Key_Predm,&#13;&#10;	--	P_VKZ_SMPos.PredmKolvo,&#13;&#10;	--	P_VKZ_SMPos.DataZapUtv,&#13;&#10;		SUM(SmTBL.Kolvo) KolvoR&#13;&#10;&#13;&#10;	FROM  P_VKZ_SMPos&#13;&#10;&#13;&#10;		LEFT JOIN &#13;&#10;		(&#13;&#10;		  SELECT   &#13;&#10;			   P_VKZ.Key_VKZ_Izdel&#13;&#10;			  ,P_VKZ.Key_VKZ&#13;&#10;			  ,P_VKZ.Key_Predm&#13;&#10;			  ,P_VKZ.Kolvo&#13;&#10;		  FROM  &#13;&#10;			P_VKZ&#13;&#10;&#13;&#10;			LEFT JOIN T_SPRows T_SPRows_BySP&#13;&#10;				ON T_SPRows_BySP.Key_SPRow = P_VKZ.Key_SPRow&#13;&#10;  &#13;&#10;		 INNER JOIN P_VKZ_Zap_Det&#13;&#10;		  ON P_VKZ_Zap_Det.Key_Vkz = P_VKZ.Key_Vkz&#13;&#10;&#13;&#10;		 INNER JOIN P_VMZ&#13;&#10;		  ON P_VMZ.Key_VKZ_Zap =  P_VKZ_Zap_Det.Key_VKZ_Zap                                                            &#13;&#10;    &#13;&#10;			INNER JOIN  T_SPRows&#13;&#10;				ON T_SPRows.Key_SPRow = P_VMZ.Key_SPRow&#13;&#10;				AND T_SPRows.SP_Position = '0'&#13;&#10;&#13;&#10;			INNER JOIN &#13;&#10;			(&#13;&#10;		SELECT        &#13;&#10;			P_VMZ.Key_VMZ, &#13;&#10;			P_VMZ.KolDSE, &#13;&#10;			Isnull(SUM(A_Rezerv.KolDT),0) AS SMR&#13;&#10;		FROM            &#13;&#10;			P_VMZ &#13;&#10;			INNER JOIN A_Rezerv &#13;&#10;				ON P_VMZ.Key_VMZ = A_Rezerv.Key_VMZ&#13;&#10;&#13;&#10;			INNER JOIN P_WSNRM&#13;&#10;				ON P_WSNRM.Key_WSNRM=P_VMZ.Key_WSNRM&#13;&#10;&#13;&#10;&#13;&#10;			INNER JOIN&#13;&#10;				(&#13;&#10;					SELECT A_ID_Mat.Key_ID_Mat, Isnull(MDT.DT,'20010101')  DT &#13;&#10;					FROM A_ID_Mat&#13;&#10;					LEFT JOIN &#13;&#10;					(&#13;&#10;					SELECT        &#13;&#10;						A_ID_Mat.Key_ID_Mat, &#13;&#10;						MAX(A_Nacl.Data_Nacl) AS Dt&#13;&#10;					FROM            &#13;&#10;						A_ID_Mat &#13;&#10;						INNER JOIN A_Nacl_Str &#13;&#10;							ON A_ID_Mat.Key_ID_Mat = A_Nacl_Str.Key_ID_Mat &#13;&#10;						INNER JOIN A_Nacl &#13;&#10;							ON A_Nacl_Str.Key_Nacl = A_Nacl.Key_Nacl &#13;&#10;						INNER JOIN S_SubVer &#13;&#10;							ON A_Nacl.Key_Sub_Ver_From = S_SubVer.Key_Sub_Ver &#13;&#10;						INNER JOIN S_Subjects &#13;&#10;							ON S_SubVer.Key_Sub = S_Subjects.Key_Sub&#13;&#10;							AND        (S_Subjects.Key_Class = 2)&#13;&#10;					GROUP BY A_ID_Mat.Key_ID_Mat&#13;&#10;					) MDT&#13;&#10;					ON MDT.Key_ID_Mat = A_ID_Mat.Key_ID_Mat&#13;&#10;				) A_ID_Mat&#13;&#10;				ON A_ID_Mat.Key_ID_Mat = A_Rezerv.Key_ID_Mat&#13;&#10;				AND A_ID_Mat.Dt  &#60;= P_WSNRM.DataWSNRM&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;		GROUP BY P_VMZ.Key_VMZ, P_VMZ.KolDSE&#13;&#10;		HAVING P_VMZ.KolDSE &#60;= Isnull(SUM(A_Rezerv.KolDT),0)&#13;&#10;			) SMR&#13;&#10;			ON SMR.Key_VMZ = P_VMZ.Key_VMZ&#13;&#10;&#13;&#10;		GROUP BY&#13;&#10;				P_VKZ.Key_VKZ_Izdel&#13;&#10;			   ,P_VKZ.Key_VKZ&#13;&#10;			   ,P_VKZ.Key_Predm&#13;&#10;			   ,P_VKZ.Kolvo&#13;&#10;		HAVING&#13;&#10;			P_VKZ.Kolvo &#60;= SUM(P_VKZ_Zap_Det.KolvoZapPln)&#13;&#10;		) SmTBL&#13;&#10;		ON &#13;&#10;			SmTBL.Key_VKZ_Izdel = P_VKZ_SMPos.Key_VKZ_Izdel&#13;&#10;		AND SmTBL.Key_Predm = P_VKZ_SMPos.Key_Predm&#13;&#10;	GROUP BY&#13;&#10; &#13;&#10;		P_VKZ_SMPos.Key_VKZ_Izdel,&#13;&#10;		P_VKZ_SMPos.Key_Predm,&#13;&#10;		P_VKZ_SMPos.PredmKolvo &#13;&#10;	HAVING SUM(SmTBL.Kolvo) &#62;= P_VKZ_SMPos.PredmKolvo&#13;&#10;&#13;&#10;&#13;&#10;)  TZ1  &#13;&#10;  ON TZ1.Key_VKZ_Izdel	= P_VKZ_SmPos.Key_VKZ_Izdel&#13;&#10;  AND TZ1.Key_Predm		= P_VKZ_SmPos.Key_Predm&#13;&#10;      &#13;&#10;&#13;&#10;LEFT JOIN &#13;&#10;(&#13;&#10;SELECT  DISTINCT                                          &#13;&#10;	P_VKZ_SmPos.Key_VKZ_Izdel, &#13;&#10;	P_VKZ_SmPos.Key_Predm, &#13;&#10;	P_VMZ.Key_SpRow,&#13;&#10;	P_VMZ.Key_Sub_Ver&#13;&#10;FROM            &#13;&#10;	P_VMZ INNER JOIN&#13;&#10;                         P_VKZ_Zap ON P_VMZ.Key_VKZ_Zap = P_VKZ_Zap.Key_VKZ_Zap INNER JOIN&#13;&#10;                         P_VKZ_SmPos ON P_VKZ_Zap.Key_VKZ_Izdel = P_VKZ_SmPos.Key_VKZ_Izdel AND P_VKZ_Zap.Key_Predm = P_VKZ_SmPos.Key_Predm&#13;&#10;) OTV&#13;&#10;  ON OTV.Key_VKZ_Izdel	= P_VKZ_SmPos.Key_VKZ_Izdel&#13;&#10;  AND OTV.Key_Predm		= P_VKZ_SmPos.Key_Predm&#13;&#10;  AND OTV.Key_SpRow = T_SpRows.Key_SpRow&#13;&#10;&#13;&#10;&#13;&#10;LEFT JOIN S_SubVer SubVerSnab&#13;&#10;       ON SubVerSnab.Key_Sub_Ver= isnull(OTV.Key_Sub_Ver, dbo.Gr_GetOtvSnab(PredmM.Key_Predm))&#13;&#10;LEFT JOIN S_Subjects SubjSnab                &#13;&#10;       ON  SubjSnab.Key_Sub = SubVerSnab.Key_Sub&#13;&#10;&#13;&#10;&#13;&#10;LEFT JOIN &#13;&#10;(&#13;&#10;&#13;&#10;SELECT        &#13;&#10;	P_VKZ.Key_VKZ_Izdel, &#13;&#10;	P_VKZ.Key_Predm,&#13;&#10;	SUM(Pr_PaspDet.KolvoZap) AS KolvoZap, &#13;&#10;	MAX(Pr_Pasp.Date_ZapR) AS Date_Zap&#13;&#10;FROM            &#13;&#10;	P_VKZ &#13;&#10;	INNER JOIN Pr_PaspDet &#13;&#10;		ON P_VKZ.Key_VKZ = Pr_PaspDet.Key_VKZ &#13;&#10;	INNER JOIN Pr_Pasp &#13;&#10;		ON Pr_PaspDet.Key_Pasport = Pr_Pasp.Key_Pasport&#13;&#10;WHERE       &#13;&#10;	(Pr_Pasp.Key_Pasp_Status &#62; 0)&#13;&#10;&#13;&#10;&#13;&#10;GROUP BY &#13;&#10;	P_VKZ.Key_VKZ_Izdel, &#13;&#10;	P_VKZ.Key_Predm		 &#13;&#10;&#13;&#10;&#13;&#10;) TZap&#13;&#10;	ON  TZap.Key_VKZ_Izdel = P_VKZ_SmPos.Key_VKZ_Izdel&#13;&#10;    AND TZap.Key_Predm  =    P_VKZ_SmPos.Key_Predm&#13;&#10;&#13;&#10;LEFT JOIN &#13;&#10;(&#13;&#10;&#13;&#10;SELECT        &#13;&#10;	P_VKZ.Key_VKZ_Izdel, &#13;&#10;	P_VKZ.Key_Predm,&#13;&#10;	SUM(Pr_PaspDet.KolvoZap) AS KolvoZap, &#13;&#10;	MAX(Pr_Pasp.Date_Zap) AS Date_Zap&#13;&#10;FROM            &#13;&#10;	P_VKZ &#13;&#10;	INNER JOIN Pr_PaspDet &#13;&#10;		ON P_VKZ.Key_VKZ = Pr_PaspDet.Key_VKZ &#13;&#10;	INNER JOIN Pr_Pasp &#13;&#10;		ON Pr_PaspDet.Key_Pasport = Pr_Pasp.Key_Pasport&#13;&#10;&#13;&#10;&#13;&#10;GROUP BY &#13;&#10;	P_VKZ.Key_VKZ_Izdel, &#13;&#10;	P_VKZ.Key_Predm		 &#13;&#10;&#13;&#10;&#13;&#10;) TZap1&#13;&#10;	ON  TZap1.Key_VKZ_Izdel = P_VKZ_SmPos.Key_VKZ_Izdel&#13;&#10;    AND TZap1.Key_Predm  =    P_VKZ_SmPos.Key_Predm&#13;&#10;	&#13;&#10;WHERE &#13;&#10;--       P_VKZ_SmPos.DataZapUtv BETWEEN @DateFrom and @DateTo AND &#13;&#10;       T_Prinadl.ReportFlag = 1 AND &#13;&#10;       ((Isnull(TZap.KolvoZap,0) &#60; P_VKZ_SmPos.PredmKolvo) OR ( :NoZap = 0))&#13;&#10;&#13;&#10;	      AND P_VKZ_SmPos.Key_VKZ_Izdel = :Key_VKZ_Izdel  &#13;&#10;     &#13;&#10;ORDER BY P_VKZ_SmPos.Key_VKZ_Izdel , OtvSnab, P_VKZ_SmPos.DataZapUtv                           " PropData="05704C65667402440470546F7002240A506172616D657465727301010C41000000204E616D653D224461746546726F6D222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746546726F6D2E446174652200010C3D000000204E616D653D2244617465546F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D2244617465546F2E446174652200010C3D000000204E616D653D224E6F5A6170222044617461547970653D226674496E7465676572222045787072657373696F6E3D224E6F5A61702E436865636B65642200010C2A000000204E616D653D224B65795F564B5A5F497A64656C222044617461547970653D226674556E6B6E6F776E220000"/>
    <TfrxERQuery Name="ERQuery1" UserName="ERQuery1" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="PostQRY" IgnoreDupParams="False" SQL.Text="SELECT Pr_Pasp_Status.Key_Pasp_Status, Pr_Pasp_Status.Name_Pasp_Status, T1.CNT , T1.KolvoZap             &#13;&#10;&#13;&#10;FROM dbo.Pr_Pasp_Status Pr_Pasp_Status&#13;&#10;LEFT JOIN &#13;&#10;	(&#13;&#10;		SELECT        &#13;&#10;			P_VKZ.Key_VKZ_Izdel, &#13;&#10;			P_VKZ.Key_Predm, &#13;&#10;			COUNT(Pr_Pasp.Key_Pasport) AS Cnt,&#13;&#10;   SUM(Pr_PaspDet.KolvoZap) KolvoZap,                                            &#13;&#10;			Pr_Pasp.Key_Pasp_Status&#13;&#10;		FROM            &#13;&#10;&#13;&#10;			Pr_PaspDet &#13;&#10;			INNER JOIN Pr_Pasp &#13;&#10;				ON Pr_PaspDet.Key_Pasport = Pr_Pasp.Key_Pasport &#13;&#10;			INNER JOIN P_VKZ &#13;&#10;				ON Pr_PaspDet.Key_VKZ = P_VKZ.Key_VKZ &#13;&#10;&#13;&#10;&#13;&#10;		GROUP BY &#13;&#10;			P_VKZ.Key_VKZ_Izdel, &#13;&#10;			P_VKZ.Key_Predm, &#13;&#10;			Pr_Pasp.Key_Pasp_Status&#13;&#10;	) T1&#13;&#10;	ON T1.Key_Pasp_Status =  Pr_Pasp_Status.Key_Pasp_Status&#13;&#10; AND T1.Key_VKZ_Izdel = :Key_VKZ_Izdel&#13;&#10; AND T1.Key_Predm = :Key_Predm                                &#13;&#10;  &#13;&#10;  &#13;&#10;ORDER BY  &#13;&#10;	Pr_Pasp_Status.Key_Pasp_Status  " PropData="05704C65667403D8000470546F7002240A506172616D657465727301010C2A000000204E616D653D224B65795F564B5A5F497A64656C222044617461547970653D226674556E6B6E6F776E2200010C26000000204E616D653D224B65795F507265646D222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="233" ClientHeight="194" Left="373" Top="118" Width="300" ClientWidth="284">
    <TfrxDateEditControl Name="DateFrom" Left="112" Top="24" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="42736" Time="42736" WeekNumbers="False"/>
    <TfrxDateEditControl Name="DateTo" Left="112" Top="64" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="47484,9999884259" Time="47484,9999884259" WeekNumbers="False"/>
    <TfrxButtonControl Name="Button1" Left="184" Top="152" Width="75" Height="25" ShowHint="True" Caption="OK" ModalResult="1"/>
    <TfrxCheckBoxControl Name="NoZap" Left="112" Top="104" Width="149" Height="17" ShowHint="True" Caption="Скрывать запущеные" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="420" PaperHeight="297" PaperSize="8" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" EndlessHeight="True" EndlessWidth="True" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="200,31509" Left="0" Top="16" Width="1511,812">
      <TfrxMemoView Name="ERQuery1Name_Pasp_Status" Left="1031,81169" Top="0" Width="41,57483" Height="200,31509" DataField="Name_Pasp_Status" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="[ERQuery1.&#34;Name_Pasp_Status&#34;]"/>
      <TfrxMemoView Name="Memo15" Left="744,56741" Top="0" Width="30,23622047" Height="200,31509" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РќР°Р»РёС‡РёРµ СЂРµР·РµСЂРІР°"/>
      <TfrxMemoView Name="Memo16" Left="774,80365" Top="0" Width="30,23622047" Height="200,31509" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Р РµР·РµСЂРІ РёР· РЅР°Р»РёС‡РёСЏ"/>
      <TfrxMemoView Name="Memo17" Left="805,03989" Top="0" Width="30,23622047" Height="200,31509" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Р—Р°РїСѓС‰РµРЅРѕ"/>
      <TfrxMemoView Name="Memo18" Left="835,27613" Top="0" Width="30,23622047" Height="200,31509" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Р—Р°РїСѓС‰РµРЅРѕ РІРѕ РІСЂРµРјСЏ"/>
      <TfrxMemoView Name="Memo19" Left="895,74861" Top="0" Width="79,37011047" Height="200,31509" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РћС‚РІ. Р·Р° СЃРЅР°Р±Р¶РµРЅРёРµ"/>
      <TfrxMemoView Name="Memo20" Left="706,77211" Top="0" Width="37,79528047" Height="200,31509" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕР»-РІРѕ Р”РЎР•"/>
      <TfrxMemoView Name="Memo21" Left="642,5201" Top="0" Width="64,25199047" Height="200,31509" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЈС‚РІ. РґР°С‚Р° Р·Р°Рї"/>
      <TfrxMemoView Name="Memo22" Left="544,25232" Top="71,81107" Width="98,26776047" Height="128,50402" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РњР°СЂРєР°"/>
      <TfrxMemoView Name="Memo23" Left="453,5436" Top="71,81107" Width="90,70870047" Height="128,50402" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎРѕСЂС‚Р°РјРµРЅС‚"/>
      <TfrxMemoView Name="Memo24" Left="393,07112" Top="0" Width="249,44896047" Height="71,81107" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РњР°С‚РµСЂРёР°Р»"/>
      <TfrxMemoView Name="Memo25" Left="181,41744" Top="0" Width="211,65366047" Height="200,31509" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”РЎР•"/>
      <TfrxMemoView Name="Memo26" Left="393,07112" Top="71,81107" Width="60,47246047" Height="128,50402" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ"/>
      <TfrxMemoView Name="Memo27" Left="60,47248" Top="0" Width="26,45669047" Height="200,31509" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– РџРџ"/>
      <TfrxMemoView Name="Memo29" Left="865,51237" Top="0" Width="30,23622047" Height="200,31509" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РќР°Р»РёС‡РёРµ РїР°СЃРїРѕСЂРѕРІ"/>
      <TfrxMemoView Name="Memo37" Left="975,11874" Top="0" Width="37,79528047" Height="200,31509" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РћР±С‰Р°СЏ С‚СЂСѓРґРѕРµРјРєРѕСЃС‚СЊ "/>
      <TfrxMemoView Name="Memo40" Left="86,92919" Top="0" Width="94,48823047" Height="200,31509" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapY="4" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– Р·Р°Рє"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="336" Width="1511,812" ColumnWidth="0" ColumnGap="0" DataSet="PostQRY" DataSetName="Позиции" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo3" Left="181,41744" Top="0" Width="211,65368" Height="18,89765" StretchMode="smMaxHeight" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџРѕР·РёС†РёРё.&#34;Cod_Predm&#34;] [РџРѕР·РёС†РёРё.&#34;Name_Predm&#34;]">
        <Formats>
          <item/>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo4" Left="393,07112" Top="0" Width="60,47248" Height="18,89765" StretchMode="smMaxHeight" DataField="Name_Predm_M" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџРѕР·РёС†РёРё.&#34;Name_Predm_M&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="453,5436" Top="0" Width="90,70872" Height="18,89765" StretchMode="smMaxHeight" DataField="SortamM" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџРѕР·РёС†РёРё.&#34;SortamM&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="544,25232" Top="0" Width="98,26778" Height="18,89765" StretchMode="smMaxHeight" DataField="MarkaM" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџРѕР·РёС†РёРё.&#34;MarkaM&#34;]"/>
      <TfrxMemoView Name="ERQuery1CNT" Left="1031,81169" Top="0" Width="41,57483" Height="18,89765" StretchMode="smMaxHeight" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[ERQuery1.&#34;CNT&#34;]">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo7" Left="706,77211" Top="0" Width="37,79527559" Height="18,89765" StretchMode="smMaxHeight" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[РџРѕР·РёС†РёРё.&#34;PredmKolvo&#34;]">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo9" Left="642,5201" Top="0" Width="64,25201" Height="18,89765" StretchMode="smMaxHeight" DataField="DataZapUtv" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[РџРѕР·РёС†РёРё.&#34;DataZapUtv&#34;]"/>
      <TfrxMemoView Name="Memo1" Left="0" Top="0" Width="26,4566929133858" Height="18,89765" StretchMode="smMaxHeight" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Line]"/>
      <TfrxMemoView Name="Memo2" Left="744,56741" Top="0" Width="30,23622047" Height="18,89765" StretchMode="smMaxHeight" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FnRezerv]"/>
      <TfrxMemoView Name="Memo10" Left="895,74861" Top="0" Width="79,37013" Height="18,89765" StretchMode="smMaxHeight" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџРѕР·РёС†РёРё.&#34;OtvSnab&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="774,80365" Top="0" Width="30,23622047" Height="18,89765" StretchMode="smMaxHeight" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FnRezerv1]"/>
      <TfrxMemoView Name="Memo13" Left="805,03989" Top="0" Width="30,23622047" Height="18,89765" StretchMode="smMaxHeight" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FnZap]"/>
      <TfrxMemoView Name="Memo14" Left="835,27613" Top="0" Width="30,23622047" Height="18,89765" StretchMode="smMaxHeight" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FnZap1]"/>
      <TfrxMemoView Name="Memo30" Left="865,51237" Top="0" Width="30,23622047" Height="18,89765" StretchMode="smMaxHeight" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FnZapPasp]"/>
      <TfrxMemoView Name="Memo8" Left="1114,96135" Top="0" Width="45,35436" Height="18,89765" StretchMode="smMaxHeight" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;ERQuery1.&#34;CNT&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo38" Left="975,11874" Top="0" Width="37,7953" Height="18,89765" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[&#60;РџРѕР·РёС†РёРё.&#34;SUM_TPZ&#34;&#62;+&#60;РџРѕР·РёС†РёРё.&#34;PredmKolvo&#34;&#62;*&#60;РџРѕР·РёС†РёРё.&#34;SUM_Tsht&#34;&#62;]"/>
      <TfrxMemoView Name="Memo39" Left="86,92919" Top="0" Width="94,48825" Height="18,89765" StretchMode="smMaxHeight" DataField="Cod_Zak" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџРѕР·РёС†РёРё.&#34;Cod_Zak&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="1046,92981" Left="60,47248" Top="0" Vertical="True" Width="952,44156"/>
    <TfrxMasterData Name="MasterData2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="1046,92981" Left="1031,81169" Top="0" Vertical="True" Width="41,57483" ColumnWidth="0" ColumnGap="0" DataSet="ERQuery1" DataSetName="ERQuery1" RowCount="0"/>
    <TfrxGroupHeader Name="GroupHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="41,57483" Left="0" Top="276" Width="1511,812" Condition="Позиции.&#34;OtvSnab&#34;">
      <TfrxMemoView Name="Memo11" Left="60,47248" Top="0" Width="914,64626" Height="41,57483" StretchMode="smMaxHeight" DataSet="PostQRY" DataSetName="Позиции" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="16777180" ParentFont="False" VAlign="vaCenter" Text="[РџРѕР·РёС†РёРё.&#34;OtvSnab&#34;]"/>
    </TfrxGroupHeader>
    <TfrxFooter Name="Footer1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="1046,92981" Left="1114,96135" Top="0" Vertical="True" Width="45,35436"/>
    <TfrxFooter Name="Footer2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="49,13389" Left="0" Top="420" Width="1511,812">
      <TfrxMemoView Name="Memo31" Left="1031,81169" Top="0" Width="41,57483" Height="22,67718" OnBeforePrint="Memo31OnBeforePrint" StretchMode="smMaxHeight" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="8421631" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[SUM(FnCnt(&#60;ERQuery1.&#34;CNT&#34;&#62;),MasterData1)]"/>
      <TfrxMemoView Name="Memo28" Left="1114,96135" Top="0" Width="45,35436" Height="22,67718" StretchMode="smMaxHeight" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="8421631" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[SmSm]"/>
      <TfrxMemoView Name="SmHdrMemo" Left="0" Top="0" Width="582,04762" Height="22,67718" OnBeforePrint="SmHdrMemoOnBeforePrint" StretchMode="smMaxHeight" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="8421631" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="РС‚РѕРіРѕ"/>
      <TfrxMemoView Name="Memo35" Left="0" Top="26,45671" Width="37,7953" Height="22,67718" Visible="False" OnBeforePrint="SmHdrMemoOnBeforePrint" StretchMode="smMaxHeight" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="8421631" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="РС‚РѕРіРѕ [SUM(FnD,MasterData1)]"/>
    </TfrxFooter>
    <TfrxGroupFooter Name="GroupFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="376" Width="1511,812">
      <TfrxMemoView Name="Memo36" Left="1031,81169" Top="0" Width="41,57483" Height="22,67718" StretchMode="smMaxHeight" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[SUM(FnCnt(&#60;ERQuery1.&#34;CNT&#34;&#62;),MasterData1)]"/>
    </TfrxGroupFooter>
    <TfrxGroupHeader Name="GroupHeader2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="236" Width="1511,812" Condition="Позиции.&#34;Key_VKZ_Izdel&#34;">
      <TfrxMemoView Name="MainDSCod_Zak" Align="baWidth" Left="0" Top="0" Width="1511,812" Height="18,89765" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="РР·РґРµР»РёРµ   [MainDS.&#34;Cod_Predm&#34;] [MainDS.&#34;Name_Predm&#34;] (#[РџРѕР·РёС†РёРё.&#34;Key_VKZ_Izdel&#34;])"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage2" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Visible="False" Height="200" ClientHeight="161" Left="308" Top="117" Width="300" ClientWidth="284">
    <TfrxMemoControl Name="ItogMemo" Left="40" Top="24" Width="185" Height="89" ShowHint="True" Color="-16777211" Lines.Text="ОМТС (Дефицит)=0&#13;&#10;ОМТС=0&#13;&#10;Технологический отдел=0&#13;&#10;Производство (Испытания)=0&#13;&#10;Служба качества=0&#13;&#10;Конструкторский отдел=0" MaxLength="0" OnClick="ItogMemoOnClick"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page2" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page2OnBeforePrint">
    <TfrxMasterData Name="MasterData3" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="34,01577" Left="0" Top="18,89765" Width="718,1107" ColumnWidth="0" ColumnGap="0" RowCount="6">
      <TfrxMemoView Name="Memo32" Left="0" Top="0" Width="245,66945" Height="34,01577" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[MyFnNames]"/>
      <TfrxMemoView Name="Memo33" Left="245,66945" Top="0" Width="132,28355" Height="34,01577" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[MyFnValues]"/>
    </TfrxMasterData>
    <TfrxFooter Name="Footer3" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="34,01577" Left="0" Top="75,5906" Width="718,1107">
      <TfrxMemoView Name="Memo34" Left="245,66945" Top="0" Width="132,28355" Height="34,01577" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[SUM(StrToInt(MyFnValues))]"/>
    </TfrxFooter>
  </TfrxReportPage>
</TfrxReport>
