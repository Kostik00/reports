<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.6.18" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38513,0822621875" ReportOptions.Description.Text="" ReportOptions.Name="Èñïîëüçîâàíèå ñâîáîäíûõ îñòàòêîâ.fr3 Ñïðàâî÷íèê îñòàòêîâ" ReportOptions.LastChange="43774,3463733218" ScriptLanguage="PascalScript" ScriptText.Text="//Test&#13;&#10;&#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  DateTo.Date:=Date;&#13;&#10;  DateFrom.Date:=Date-7;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="MainFrxDS" DataSetName="MainDS"/>
    <item DataSet="Stat" DataSetName="Ñòàòèñòèêà"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="Stat" UserName="Ñòàòèñòèêà" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="DECLARE @DateFrom datetime&#13;&#10;DECLARE @DateTo datetime&#13;&#10;&#13;&#10;SET @DateFrom = :DateFrom                &#13;&#10;SET @DateTo =   :DateTo            &#13;&#10;&#13;&#10;&#13;&#10;SELECT &#13;&#10;	T1.Name_Sub,&#13;&#10;	COUNT(T1.Key_Rezerv) Kolvo,&#13;&#10;	SUM(T1.Plus) SmKolvoRPlus,&#13;&#10;	SUM(T1.Minus) SmKolvoRMinus,&#13;&#10;	SUM(T1.KolvoInBaseEd*T1.Price) SmSm,&#13;&#10;	SUM(T1.KolvoInBaseEd*T1.Price*T1.Plus) SmPlus,&#13;&#10;	SUM(T1.KolvoInBaseEd*T1.Price*T1.Minus) SmMinus&#13;&#10;&#13;&#10;FROM &#13;&#10;&#13;&#10;(&#13;&#10;		SELECT        &#13;&#10;			A_Ostatok_Mat.Key_ID_Mat,&#13;&#10;			A_Rezerv.Key_Rezerv, &#13;&#10;			S_ALL_Sub.Name_Sub, &#13;&#10;			S_ALL_Sub.Key_Class, &#13;&#10;			A_Rezerv.DateR,&#13;&#10;			A_Ostatok_Mat.LastDate,&#13;&#10;			P_WSNRM.DataWSNRM,&#13;&#10;&#13;&#10;			A_Rezerv.KolvoInBaseEd,&#13;&#10;			dbo.A_FnGetMaxFPrice(A_Ostatok_Mat.Key_ID_Mat) Price,&#13;&#10;&#13;&#10;			CASE &#13;&#10;				WHEN (A_Ostatok_Mat.LastDate &#60;= P_WSNRM.DataWSNRM) THEN 1&#13;&#10;				ELSE 0&#13;&#10;			END  AS Plus&#13;&#10;			,&#13;&#10;			CASE &#13;&#10;				WHEN (A_Ostatok_Mat.LastDate &#62; P_WSNRM.DataWSNRM) THEN 1&#13;&#10;				ELSE 0&#13;&#10;			END  AS Minus&#13;&#10;&#13;&#10;&#13;&#10;		FROM            &#13;&#10;			A_Rezerv &#13;&#10;			LEFT OUTER JOIN S_ALL_Sub &#13;&#10;				ON A_Rezerv.Usr = S_ALL_Sub.cod_sub&#13;&#10;&#13;&#10;			INNER JOIN A_Ostatok_Mat&#13;&#10;				ON  A_Ostatok_Mat.Key_ID_Mat = A_Rezerv.Key_Id_Mat&#13;&#10;				AND A_Ostatok_Mat.Key_Sub_Ver= A_Rezerv.Key_Sub_Ver&#13;&#10;&#13;&#10;			INNER JOIN P_VMZ&#13;&#10;				ON P_VMZ.Key_VMZ = A_Rezerv.Key_VMZ&#13;&#10;			INNER JOIN P_WSNRM&#13;&#10;				ON P_WSNRM.Key_WSNRM = P_VMZ.Key_WSNRM&#13;&#10;&#13;&#10;&#13;&#10;		WHERE        (S_ALL_Sub.Key_Class = 5)&#13;&#10;&#13;&#10;			AND A_Rezerv.DateR BETWEEN @DateFrom and @DateTo&#13;&#10;) T1&#13;&#10;&#13;&#10;GROUP BY T1.Name_Sub  " PropData="05704C65667402600470546F7002400A506172616D657465727301010C41000000204E616D653D224461746546726F6D222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746546726F6D2E446174652200010C3D000000204E616D653D2244617465546F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D2244617465546F2E44617465220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="200" ClientHeight="161" Left="319" Top="131" Width="300" ClientWidth="284" OnActivate="DialogPage1OnActivate">
    <TfrxDateEditControl Name="DateFrom" Left="120" Top="28" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="43770" Time="43770" WeekNumbers="False"/>
    <TfrxDateEditControl Name="DateTo" Left="120" Top="64" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="43770,9999884259" Time="43770,9999884259" WeekNumbers="False"/>
    <TfrxButtonControl Name="OK" Left="188" Top="120" Width="75" Height="25" ShowHint="True" Caption="OK" ModalResult="1"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="19,77953" Left="0" Top="196,53556" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="Stat" DataSetName="Ñòàòèñòèêà" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo2" Left="37,7953" Top="0" Width="226,7718" Height="18,89765" DataField="Name_Sub" DataSet="Stat" DataSetName="Ñòàòèñòèêà" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;Name_Sub&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="0" Top="0" Width="37,7953" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[Line]"/>
      <TfrxMemoView Name="Memo4" Left="264,5671" Top="0" Width="75,5906" Height="18,89765" DataField="Kolvo" DataSet="Stat" DataSetName="Ñòàòèñòèêà" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;Kolvo&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="340,1577" Top="0" Width="75,5906" Height="18,89765" DataField="SmKolvoRPlus" DataSet="Stat" DataSetName="Ñòàòèñòèêà" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;SmKolvoRPlus&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="415,7483" Top="0" Width="37,7953" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" DisplayFormat.FormatStr="%2.1f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[100.0*&#60;Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;SmKolvoRPlus&#34;&#62;/&#60;Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;Kolvo&#34;&#62;]"/>
      <TfrxMemoView Name="Memo7" Left="453,5436" Top="0" Width="113,3859" Height="18,89765" DataField="SmSm" DataSet="Stat" DataSetName="Ñòàòèñòèêà" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;SmSm&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="566,9295" Top="0" Width="113,3859" Height="18,89765" DataField="SmPlus" DataSet="Stat" DataSetName="Ñòàòèñòèêà" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;SmPlus&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="680,3154" Top="0" Width="37,7953" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" DisplayFormat.FormatStr="%2.1f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[&#60;Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;SmPlus&#34;&#62;*100/&#60;Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;SmSm&#34;&#62;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="64,25201" Left="0" Top="109,60637" Width="718,1107">
      <TfrxMemoView Name="Memo10" Left="37,7953" Top="45,35436" Width="226,7718" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð¤Ð˜Ðž"/>
      <TfrxMemoView Name="Memo11" Left="0" Top="45,35436" Width="37,7953" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="â„– Ð¿Ð¿."/>
      <TfrxMemoView Name="Memo12" Left="264,5671" Top="45,35436" Width="75,5906" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð’ÑÐµÐ³Ð¾"/>
      <TfrxMemoView Name="Memo13" Left="340,1577" Top="45,35436" Width="75,5906" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð˜Ð· Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ"/>
      <TfrxMemoView Name="Memo14" Left="415,7483" Top="45,35436" Width="37,7953" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" DisplayFormat.FormatStr="%2.1f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="%"/>
      <TfrxMemoView Name="Memo15" Left="453,5436" Top="45,35436" Width="113,3859" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð’ÑÐµÐ³Ð¾"/>
      <TfrxMemoView Name="Memo16" Left="566,9295" Top="45,35436" Width="113,3859" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð˜Ð· Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ"/>
      <TfrxMemoView Name="Memo17" Left="680,3154" Top="45,35436" Width="37,7953" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" DisplayFormat.FormatStr="%2.1f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="%"/>
      <TfrxMemoView Name="Memo18" Left="264,5671" Top="26,45671" Width="188,9765" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐšÐ¾Ð»-Ð²Ð¾"/>
      <TfrxMemoView Name="Memo19" Left="453,5436" Top="26,45671" Width="264,5671" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð¡ÑƒÐ¼Ð¼Ð°"/>
    </TfrxHeader>
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="30,23624" Left="0" Top="18,89765" Width="718,1107"/>
    <TfrxMemoView Name="Memo1" Align="baWidth" Left="0" Top="3,77953" Width="718,1107" Height="45,35436" Font.Charset="1" Font.Color="0" Font.Height="-21" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð ÐµÐ·ÐµÑ€Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ñ‹Ñ… Ð¾ÑÑ‚Ð°Ñ‚ÐºÐ¾Ð²&#13;&#10;Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ñ [DateFrom.Date] Ð¿Ð¾ [DateTo.Date]">
      <Formats>
        <item FormatStr="dd.mm.yyyy" Kind="fkDateTime"/>
        <item FormatStr="dd.mm.yyyy" Kind="fkDateTime"/>
      </Formats>
    </TfrxMemoView>
    <TfrxFooter Name="Footer1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="238,11039" Width="718,1107">
      <TfrxMemoView Name="Memo20" Left="566,9295" Top="0" Width="113,3859" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;SmPlus&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo21" Left="453,5436" Top="0" Width="113,3859" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;SmSm&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo22" Left="680,3154" Top="0" Width="37,7953" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" DisplayFormat.FormatStr="%2.1f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;SmPlus&#34;&#62;)*100/SUM(&#60;Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;SmSm&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo23" Left="415,7483" Top="0" Width="37,7953" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" DisplayFormat.FormatStr="%2.1f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[100.0*SUM(&#60;Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;SmKolvoRPlus&#34;&#62;)/SUM(&#60;Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;Kolvo&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo24" Left="264,5671" Top="0" Width="75,5906" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;Kolvo&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo25" Left="340,1577" Top="0" Width="75,5906" Height="18,89765" DataSet="Stat" DataSetName="Ñòàòèñòèêà" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°.&#34;SmKolvoRPlus&#34;&#62;)]"/>
    </TfrxFooter>
  </TfrxReportPage>
</TfrxReport>
