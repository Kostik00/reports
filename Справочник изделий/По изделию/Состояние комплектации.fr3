<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.5.2" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38513,0822621875" ReportOptions.Description.Text="" ReportOptions.Name="Состояние комплектации.fr3 Справочник изделий" ReportOptions.LastChange="43447,732828912" ScriptLanguage="PascalScript" ScriptText.Text="Uses 'CommonRU.pas';&#13;&#10;&#13;&#10;function FnPredm:string;&#13;&#10;begin&#13;&#10;  Result:=PrintPredm  ( &#60;Материалы.&#34;PrintFlagBySP&#34;&#62;, &#60;Материалы.&#34;Cod_PredmBySP&#34;&#62;,     &#60;Материалы.&#34;Name_PredmBySP&#34;&#62;,&#13;&#10;                       &#60;Материалы.&#34;SortamBySP&#34;&#62;,   &#60;Материалы.&#34;Type_NTD_SortamBySP&#34;&#62;, &#60;Материалы.&#34;Name_NTD_SortamBySP&#34;&#62;,&#13;&#10;                       &#60;Материалы.&#34;MarkaBySP&#34;&#62;,    &#60;Материалы.&#34;Type_NTD_MarkaBySP&#34;&#62;,  &#60;Материалы.&#34;Name_NTD_MarkaBySP&#34;&#62;);&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="MainFrxDS" DataSetName="MainDS"/>
    <item DataSet="VMZQry" DataSetName="Материалы"/>
    <item DataSet="ERQuery1" DataSetName="ERQuery1"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="VMZQry" UserName="Материалы" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;  P_WSNRM.Key_WSNRM,&#13;&#10;  P_WSNRM.Cod_WSNRM,&#13;&#10;  P_WSNRM.DataWSNRM,&#13;&#10;&#13;&#10;  P_VMZ.Key_VMZ,&#13;&#10;  P_VMZ.Key_Id_Mat,&#13;&#10;  P_VMZ.VMZActive,&#13;&#10;&#13;&#10;&#13;&#10;  P_VMZ.DtAdd ,&#13;&#10;  P_Vmz.DtEdit,&#13;&#10;&#13;&#10;  P_VMZ.Key_VKZ_Zap,&#13;&#10;  P_VKZ_Zap.Key_VKZ_Izdel,&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;  P_VKZ_Izdel.Cod_Zak,&#13;&#10;  Izdel.Cod_Predm Cod_Predm_Izdel,&#13;&#10;  Izdel.Name_Predm Name_Predm_Izdel,&#13;&#10;&#13;&#10;  &#13;&#10;&#13;&#10;  DSE.Cod_Predm AS Cod_PredmDSE,&#13;&#10;  DSE.Name_Predm AS Name_PredmDSE,&#13;&#10;  P_VMZ.KolDSE,&#13;&#10;&#13;&#10;  PredmBySP.Name_Postav      Name_PostavBySP,&#13;&#10;&#13;&#10;  PredmBySP.PrintFlag        PrintFlagBySP,&#13;&#10;  PredmBySP.Cod_Predm        Cod_PredmBySP,&#13;&#10;  PredmBySP.Name_Predm       Name_PredmBySP,&#13;&#10;  PredmBySP.Sortam           SortamBySP,&#13;&#10;  PredmBySP.Type_NTD_Sortam  Type_NTD_SortamBySP,&#13;&#10;  PredmBySP.Name_NTD_Sortam  Name_NTD_SortamBySP,&#13;&#10;  PredmBySP.Marka            MarkaBySP,&#13;&#10;  PredmBySP.Type_NTD_Marka   Type_NTD_MarkaBySP,&#13;&#10;  PredmBySP.Name_NTD_Marka   Name_NTD_MarkaBySP,&#13;&#10;  PredmBySP.Cod_Postav  Cod_Postav,&#13;&#10;&#13;&#10;  P_VMZ.Cod_Zagotov_BySP,&#13;&#10;  P_VMZ.Prof_Razm_BySP,&#13;&#10;  P_VMZ.MZag_BySP,&#13;&#10;  P_VMZ.KolZag_BySP,&#13;&#10;  P_VMZ.Kolvo_BySP,&#13;&#10;  P_VMZ.KolvoInBaseEd_BySP,&#13;&#10;  P_VMZ.PlnPrice PlnPrice,&#13;&#10;  P_VMZ.Key_Sub_Ver,&#13;&#10;&#13;&#10;  P_VMZ.Cod_Ed_Izm_BySP,&#13;&#10;&#13;&#10;  P_VMZ.VMZ_Notes,&#13;&#10;&#13;&#10;  Convert(bigint, P_VMZ.TSV) TSV,&#13;&#10;  Convert(bigint, T_SPRows.TS) TS,&#13;&#10;&#13;&#10;&#13;&#10;  S_Subjects.Name_Sub,&#13;&#10;&#13;&#10;  T_Zagotov_BySP.Name_Zagotov Name_Zagotov_BySP,&#13;&#10;  T_EdizmBySP.Name_K_Ed           Name_K_EdBySP,&#13;&#10;  T_EdizmBySPBE.Name_K_Ed       Name_K_EdBySPBE,&#13;&#10;&#13;&#10;&#13;&#10;  T1.KolvoDTR,&#13;&#10;  P_VMZ.KolDSE - Isnull(T1.KolvoDTR,0)  KolvoOst,&#13;&#10;&#13;&#10;  T1.Kolvo_BySpR,&#13;&#10;  (P_VMZ.Kolvo_BySP -  Isnull(T1.Kolvo_BySpR,0))    Kolvo_BySpOst,&#13;&#10;&#13;&#10;  P_VMZ.DatePostav,&#13;&#10;&#13;&#10;  TUtv.DataZapUtv DataZapUtv,&#13;&#10;  TUtv.DataZap DataZap,&#13;&#10;&#13;&#10;  P_VKZ_Zap.KolvoZap,&#13;&#10;&#13;&#10;  P_VMZ.KEY_SP,&#13;&#10;&#13;&#10;  Base_SP.Key_SP KEY_SPNEW,&#13;&#10;&#13;&#10;  T_SPRows.Sp_Position,&#13;&#10;  Zayavka.ZCnt,&#13;&#10;  Zayavka.DateCZ,&#13;&#10;&#13;&#10;  T_SPRows.UseZagotov,&#13;&#10;  T_SPRows.KolZag,&#13;&#10;  T_SPRows.EdNorm&#13;&#10;&#13;&#10;  ,Pr_Pasp.Cod_Pasp&#13;&#10;  ,Pr_Pasp.ZavNumFrom&#13;&#10;  ,Pr_Pasp.ZavNumTo&#13;&#10;&#13;&#10;FROM&#13;&#10;  P_WSNRM&#13;&#10;  INNER JOIN P_VMZ&#13;&#10;    ON  P_VMZ.Key_WSNRM=  P_WSNRM.Key_WSNRM&#13;&#10;&#13;&#10;  LEFT JOIN P_VKZ_Zap&#13;&#10;    ON  P_VKZ_Zap.Key_VKZ_Zap =  P_VMZ.Key_VKZ_Zap&#13;&#10;&#13;&#10;  LEFT JOIN Pr_Pasp&#13;&#10;    ON Pr_Pasp.Key_Pasport=  P_VKZ_Zap.Key_Pasport&#13;&#10;&#13;&#10;  LEFT JOIN P_VKZ   P_VKZ_Izdel&#13;&#10;    ON P_VKZ_Izdel.Key_VKZ = P_VKZ_Zap.Key_VKZ_Izdel&#13;&#10;  LEFT JOIN T_VPredm Izdel&#13;&#10;	  ON Izdel.Key_Predm = P_VKZ_Izdel.Key_Predm&#13;&#10;&#13;&#10;&#13;&#10;  INNER JOIN T_VPredm_DSE AS DSE&#13;&#10;    ON P_VMZ.Key_PredmDSE = DSE.Key_Predm&#13;&#10;&#13;&#10;  INNER JOIN T_VPredm AS PredmBySP&#13;&#10;    ON P_VMZ.Key_Predm_BySP = PredmBySP.Key_Predm&#13;&#10;&#13;&#10;  LEFT JOIN  T_SP   Base_SP&#13;&#10;    ON  Base_SP.Key_SP = P_VKZ_Zap.Key_SP&#13;&#10; &#13;&#10;&#13;&#10;  LEFT JOIN T_Zagotov  T_Zagotov_BySP&#13;&#10;    ON P_VMZ.Cod_Zagotov_BySP = T_Zagotov_BySP.Cod_Zagotov&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;  LEFT JOIN T_Edizm T_EdizmBySP&#13;&#10;    ON T_EdizmBySP.Cod_Ed_Izm =  P_VMZ.Cod_Ed_Izm_BySP&#13;&#10;  INNER JOIN T_Edizm  T_EdizmBySPBE&#13;&#10;    ON T_EdizmBySPBE.Cod_Ed_Izm =  PredmBySP.Sklad_Ed_Izm&#13;&#10;&#13;&#10;  LEFT JOIN S_SubVer&#13;&#10;    ON P_VMZ.Key_Sub_Ver = S_SubVer.Key_Sub_Ver&#13;&#10;  LEFT JOIN S_Subjects&#13;&#10;    ON S_SubVer.Key_Sub = S_Subjects.Key_Sub&#13;&#10;&#13;&#10;  LEFT JOIN T_SPRows&#13;&#10;    ON  T_SPRows.Key_SPRow =   P_VMZ.Key_SPRow&#13;&#10;&#13;&#10;&#13;&#10;  LEFT JOIN&#13;&#10;  (&#13;&#10;    SELECT&#13;&#10;      P_VMZ.Key_VMZ,&#13;&#10;      SUM(A_Rezerv.KolDT) AS KolvoDTR,&#13;&#10;      SUM(A_Rezerv.Kolvo_BySp) AS Kolvo_BySpR&#13;&#10;    FROM&#13;&#10;          P_VMZ&#13;&#10;          LEFT OUTER JOIN A_Rezerv&#13;&#10;            ON P_VMZ.Key_VMZ = A_Rezerv.Key_VMZ&#13;&#10;            AND A_Rezerv.Key_RzStatus &#62;=0&#13;&#10;            &#13;&#10;    GROUP BY P_VMZ.Key_VMZ&#13;&#10;  )  T1&#13;&#10;  ON T1.Key_VMZ = P_VMZ.Key_VMZ&#13;&#10;&#13;&#10;  LEFT JOIN&#13;&#10;  (&#13;&#10;      SELECT     P_VMZ.Key_VMZ, MIN(P_VKZ.DataZapUtv) AS DataZapUtv, MIN(P_VKZ.DataZap ) DataZap&#13;&#10;      FROM         P_VMZ&#13;&#10;				INNER JOIN P_VKZ_ZAP&#13;&#10;					ON P_VKZ_ZAP.Key_VKZ_Zap = P_VMZ.Key_VKZ_Zap&#13;&#10;				INNER JOIN P_VKZ_Zap_Det&#13;&#10;					ON P_VKZ_Zap_Det.Key_VKZ_Zap=P_VKZ_ZAP.Key_VKZ_Zap&#13;&#10;				INNER JOIN P_VKZ&#13;&#10;					ON P_VKZ_Zap_Det.Key_VKZ = P_VKZ.Key_VKZ&#13;&#10;      GROUP BY P_VMZ.Key_VMZ&#13;&#10;  ) TUtv&#13;&#10;  ON   TUtv.Key_VMZ = P_VMZ.Key_VMZ&#13;&#10;&#13;&#10;&#13;&#10;  LEFT JOIN &#13;&#10;  (&#13;&#10;		SELECT        P_VMZ.Key_VMZ, SUM(Pr_CZ_DT.Kolvo_InSPEd) AS ZCnt, MIN (Pr_CZ.RQ_Date) DateCZ&#13;&#10;		FROM            &#13;&#10;					Pr_CZ &#13;&#10;					INNER JOIN Pr_CZ_DT &#13;&#10;						ON Pr_CZ.Key_Pr_CZ = Pr_CZ_DT.Key_Pr_CZ &#13;&#10;					INNER JOIN P_VKZ_Zap &#13;&#10;						ON Pr_CZ_DT.Key_Pasport = P_VKZ_Zap.Key_Pasport &#13;&#10;					INNER JOIN P_VMZ &#13;&#10;						ON  P_VKZ_Zap.Key_VKZ_Zap = P_VMZ.Key_VKZ_Zap &#13;&#10;						AND Pr_CZ_DT.Key_SPRow = P_VMZ.Key_SPRow&#13;&#10;&#13;&#10;		WHERE        (Pr_CZ.Status_CZ = 1)&#13;&#10;		GROUP BY P_VMZ.Key_VMZ&#13;&#10;	) Zayavka&#13;&#10;	ON Zayavka.Key_VMZ = P_VMZ.Key_VMZ&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;WHERE P_VKZ_Zap.Key_Vkz_Izdel = :Key_Vkz_Izdel  &#13;&#10;AND T_SPRows.Sp_Position&#62;0                    &#13;&#10;&#13;&#10;ORDER BY &#13;&#10;       P_VKZ_Zap.Key_VKZ_Izdel,&#13;&#10;       Cod_PredmDSE, &#13;&#10;       Pr_Pasp.Cod_Pasp,&#13;&#10;       P_VMZ.Key_VKZ_Zap,&#13;&#10;       T_SPRows.Sp_Position&#13;&#10;         " PropData="05704C65667402380470546F7002380A506172616D657465727301010C2A000000204E616D653D224B65795F566B7A5F497A64656C222044617461547970653D226674556E6B6E6F776E220000"/>
    <TfrxERQuery Name="ERQuery1" UserName="ERQuery1" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="" PropData="05704C656674039C000470546F7002380A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="23,55906" Left="0" Top="181,41744" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="VMZQry" DataSetName="Материалы" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo5" Left="75,5906" Top="0" Width="933,54391" Height="22,67718" StretchMode="smMaxHeight" DataSet="VMZQry" DataSetName="Материалы" Text="РїРѕР·. [РњР°С‚РµСЂРёР°Р»С‹.&#34;Sp_Position&#34;]  [FnPredm]"/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="26,45671" Left="0" Top="86,92919" Width="1046,92981" Condition="Материалы.&#34;Cod_PredmDSE&#34;">
      <TfrxMemoView Name="Memo2" Align="baWidth" Left="0" Top="0" Width="1046,92981" Height="26,45671" DataField="Cod_PredmDSE" DataSet="VMZQry" DataSetName="Материалы" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text="[РњР°С‚РµСЂРёР°Р»С‹.&#34;Cod_PredmDSE&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupHeader Name="GroupHeader2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="45,35436" Left="0" Top="18,89765" Width="1046,92981" Condition="Материалы.&#34;Key_VKZ_Izdel&#34;">
      <TfrxMemoView Name="Memo1" Align="baWidth" Left="0" Top="0" Width="1046,92981" Height="45,35436" DataSet="VMZQry" DataSetName="Материалы" Font.Charset="1" Font.Color="0" Font.Height="-21" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[РњР°С‚РµСЂРёР°Р»С‹.&#34;Cod_Predm_Izdel&#34;] - [РњР°С‚РµСЂРёР°Р»С‹.&#34;Name_Predm_Izdel&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupHeader Name="GroupHeader3" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="136,06308" Width="1046,92981" Condition="Материалы.&#34;Key_VKZ_Zap&#34;">
      <TfrxMemoView Name="Memo3" Left="0" Top="0" Width="498,89796" Height="18,89765" DataSet="VMZQry" DataSetName="Материалы" Text="[РњР°С‚РµСЂРёР°Р»С‹.&#34;Cod_Pasp&#34;]  РџР—:[РњР°С‚РµСЂРёР°Р»С‹.&#34;Key_VKZ_Zap&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="967,55968" Top="0" Width="79,37013" Height="18,89765" DataField="Key_VKZ_Zap" DataSet="VMZQry" DataSetName="Материалы" Text="[РњР°С‚РµСЂРёР°Р»С‹.&#34;Key_VKZ_Zap&#34;]"/>
    </TfrxGroupHeader>
    <TfrxChild Name="Child1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="226,7718" Width="1046,92981"/>
  </TfrxReportPage>
</TfrxReport>
