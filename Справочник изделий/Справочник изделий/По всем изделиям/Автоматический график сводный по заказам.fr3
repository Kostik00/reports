<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.5.2" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42264,6930036574" ReportOptions.Description.Text="" ReportOptions.Name="Автоматический график по видам работ.fr3 Справочник изделий" ReportOptions.LastChange="42657,4445652199" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="IzdelQRY" DataSetName="Изделия"/>
    <item DataSet="DetailQRY" DataSetName="DetailQRY"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="IzdelQRY" UserName="Изделия" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT &#13;&#10;&#13;&#10;&#13;&#10;       VKZ_IZDEL.Cod_Zak, &#13;&#10;       VKZ_IZDEL.Key_VKZ AS Key_VKZ_Izdel, &#13;&#10;       IZDEL.Cod_Predm, &#13;&#10;       IZDEL.Name_Predm,&#13;&#10;&#13;&#10;       Usr_PlnStr.ReportNum           &#13;&#10;                                                 &#13;&#10;         &#13;&#10;FROM         &#13;&#10;       P_VKZ AS VKZ_IZDEL &#13;&#10;       INNER JOIN  T_VPredm AS IZDEL &#13;&#10;               ON VKZ_IZDEL.Key_Predm = IZDEL.Key_Predm&#13;&#10;                 &#13;&#10;&#13;&#10;    INNER JOIN ( &#13;&#10;       SELECT     ReportNum, MIN(DateFrom) AS DateFrom, MAX(DateTo) AS DateTo&#13;&#10;       FROM         Usr_PlnStr&#13;&#10;       WHERE Usr_PlnStr.Usr = User           &#13;&#10;       GROUP BY ReportNum&#13;&#10;       )  Usr_PlnStr&#13;&#10;    ON     Usr_PlnStr.ReportNum = :ReportNum       &#13;&#10;                                                                                &#13;&#10;      &#13;&#10;                 &#13;&#10;WHERE     &#13;&#10;       (VKZ_IZDEL.Key_VKZ_Master IS NULL) &#13;&#10;--       AND (VKZ_IZDEL.Key_VKZ_Type = 1) &#13;&#10;       AND (VKZ_IZDEL.Cod_SosZ = 'Д')&#13;&#10;       AND VKZ_IZDEL.DataVip is not null                                                        &#13;&#10;/*    &#13;&#10;       AND EXISTS &#13;&#10;       (&#13;&#10;               SELECT     &#13;&#10;                       P_VKZ.Key_VKZ_Izdel, &#13;&#10;                       P_VKZ_Oper.DateZap, &#13;&#10;                       P_VKZ_Oper.DateVip&#13;&#10;               FROM         &#13;&#10;                       P_VKZ_Oper&#13;&#10;                       INNER JOIN P_VKZ_Zap &#13;&#10;                               ON P_VKZ_Oper.Key_VKZ_Zap = P_VKZ_Zap.Key_VKZ_Zap &#13;&#10;                       INNER JOIN P_VKZ &#13;&#10;                               ON P_VKZ_Zap.Key_VKZ_Zap = P_VKZ.Key_VKZ_Zap&#13;&#10;               WHERE           P_VKZ_Oper.DateZap &#60;= Usr_PlnStr.DateTo&#13;&#10;                       AND     P_VKZ_Oper.DateVip &#62;= Usr_PlnStr.DateFrom&#13;&#10;                       AND     P_VKZ.Key_VKZ_Izdel = VKZ_IZDEL.Key_VKZ&#13;&#10;                       AND ((P_VKZ_Oper.TPzSm &#62; 0) OR  (P_VKZ_Oper.TShtSm &#62; 0))                                                                                  &#13;&#10;       )                                     &#13;&#10;&#13;&#10;*/             &#13;&#10;--       AND VKZ_IZDEL.Key_VKZ = 148794&#13;&#10;--       AND T_Oper_Gr.Name_GrGr like 'Свар%'                                        &#13;&#10;&#13;&#10;ORDER BY VKZ_IZDEL.Cod_Zak, IZDEL.Cod_Predm  " PropData="05704C65667402600470546F7002340A506172616D657465727301010C4C000000204E616D653D225265706F72744E756D222044617461547970653D226674496E7465676572222045787072657373696F6E3D22537472546F496E74285265706F72744E756D2E5465787429220000"/>
    <TfrxERQuery Name="DetailQRY" UserName="DetailQRY" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="IzdelQRY" IgnoreDupParams="False" SQL.Text="SELECT     &#13;&#10;	Usr_PlnStr.N_Str,&#13;&#10;	Usr_PlnStr.StrName,&#13;&#10;&#13;&#10;&#13;&#10;	SUM(&#13;&#10;	    T00.TZap  &#13;&#10;		) Trud&#13;&#10;&#13;&#10;	&#13;&#10;	&#13;&#10;FROM         &#13;&#10;	Usr_PlnStr&#13;&#10;&#13;&#10;	LEFT JOIN &#13;&#10;	(&#13;&#10;&#13;&#10;  SELECT     &#13;&#10;       P_VKZ_Oper.Key_VKZ_Zap, &#13;&#10;       Pr_Pln_Oper_Res.TZap,&#13;&#10;       Pr_Pln_Oper_Res.DayDate&#13;&#10;       &#13;&#10;  FROM         &#13;&#10;         P_VKZ_Oper  &#13;&#10;         INNER JOIN  Pr_Pln_Oper_Res &#13;&#10;                 ON  Pr_Pln_Oper_Res.Key_Vkz_Oper = P_VKZ_Oper.Key_Vkz_Oper &#13;&#10;&#13;&#10;      			INNER JOIN &#13;&#10;      				(&#13;&#10;&#13;&#10;              SELECT     P_VKZ.COD_ZAK, P_VKZ_Zap.Key_VKZ_Zap, SUM(P_VKZ.Kolvo) AS Kolvo, P_VKZ_Zap.KolvoZap&#13;&#10;              FROM  &#13;&#10;              	P_VKZ &#13;&#10;                  INNER JOIN P_VKZ_Zap &#13;&#10;                          ON P_VKZ.Key_VKZ_Zap = P_VKZ_Zap.Key_VKZ_Zap&#13;&#10;              GROUP BY &#13;&#10;                  P_VKZ.COD_ZAK, &#13;&#10;                  P_VKZ_Zap.Key_VKZ_Zap, &#13;&#10;                  P_VKZ_Zap.KolvoZap&#13;&#10;      &#13;&#10;&#13;&#10;      				) Zap_Izdel&#13;&#10;      				ON &#13;&#10;      						P_VKZ_Oper.Key_Vkz_Zap = Zap_Izdel.Key_Vkz_Zap&#13;&#10;      					AND Zap_Izdel.COD_ZAK = :COD_ZAK               &#13;&#10;  &#13;&#10;&#13;&#10;  &#13;&#10;  --       WHERE P_VKZ_Oper.Key_Pln_Res = :Key_Pln_Res                                   &#13;&#10;&#13;&#10;	) T00    &#13;&#10;		ON  T00.DayDate &#60;= Usr_PlnStr.DateTo&#13;&#10;		AND T00.DayDate &#62;= Usr_PlnStr.DateFrom&#13;&#10;&#13;&#10;                           &#13;&#10;  /*    &#13;&#10;&#13;&#10;	LEFT JOIN &#13;&#10;		(&#13;&#10;			SELECT     &#13;&#10;       P_VKZ.Key_VKZ_Izdel, &#13;&#10;       P_VKZ_Zap.Key_VKZ_Zap, &#13;&#10;       SUM(P_VKZ.Kolvo) AS Kolvo, &#13;&#10;       P_VKZ_Zap.KolvoZap&#13;&#10;			FROM         P_VKZ INNER JOIN&#13;&#10;								  P_VKZ_Zap ON P_VKZ.Key_VKZ_Zap = P_VKZ_Zap.Key_VKZ_Zap&#13;&#10;			GROUP BY P_VKZ.Key_VKZ_Izdel, P_VKZ_Zap.Key_VKZ_Zap, P_VKZ_Zap.KolvoZap&#13;&#10;    &#13;&#10;		) Zap_Izdel&#13;&#10;		ON &#13;&#10;			    Zap_Izdel.Key_Vkz_Zap = T00.Key_Vkz_Zap&#13;&#10;			AND Zap_Izdel.KolvoZap &#62; 0&#13;&#10;			AND Zap_Izdel.Key_VKZ_Izdel = :Key_VKZ_Izdel&#13;&#10;       */&#13;&#10;         &#13;&#10;WHERE &#13;&#10;       Usr_PlnStr.ReportNum = :ReportNum&#13;&#10;       AND Usr_PlnStr.Usr = User                                            &#13;&#10;                     &#13;&#10;GROUP BY 	&#13;&#10;	Usr_PlnStr.N_Str,&#13;&#10;	Usr_PlnStr.StrName&#13;&#10;    &#13;&#10;&#13;&#10;&#13;&#10;ORDER BY N_Str&#13;&#10;  " PropData="05704C65667403CC000470546F7002340A506172616D657465727301010C24000000204E616D653D22434F445F5A414B222044617461547970653D226674556E6B6E6F776E2200010C28000000204E616D653D224B65795F506C6E5F526573222044617461547970653D226674556E6B6E6F776E2200010C2A000000204E616D653D224B65795F564B5A5F497A64656C222044617461547970653D226674556E6B6E6F776E2200010C26000000204E616D653D225265706F72744E756D222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="200" ClientHeight="162" Left="365" Top="134" Width="300" ClientWidth="284">
    <TfrxEditControl Name="ReportNum" Left="148" Top="52" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="1"/>
    <TfrxButtonControl Name="Button1" Left="196" Top="128" Width="75" Height="25" ShowHint="True" Caption="Button1" ModalResult="1"/>
    <TfrxLabelControl Name="Label1" Left="16" Top="56" Width="13" Height="13" ShowHint="True" Caption="№" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Orientation="poLandscape" PaperWidth="420" PaperHeight="297" PaperSize="8" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" EndlessHeight="True" EndlessWidth="True" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="16" Width="1511,812"/>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="96" Width="1511,812" ColumnWidth="0" ColumnGap="0" DataSet="IzdelQRY" DataSetName="Изделия" OutlineText="&#60;Изделия.&#34;Cod_Predm&#34;&#62;" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo2" Left="22,67718" Top="0" Width="113,3859" Height="18,89765" StretchMode="smMaxHeight" DataField="Cod_Zak" DataSet="IzdelQRY" DataSetName="Изделия" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" SuppressRepeated="True" VAlign="vaCenter" Text="[РР·РґРµР»РёСЏ.&#34;Cod_Zak&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="136,06308" Top="0" Width="226,7718" Height="18,89765" StretchMode="smMaxHeight" DataSet="IzdelQRY" DataSetName="Изделия" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[РР·РґРµР»РёСЏ.&#34;Cod_Predm&#34;] [РР·РґРµР»РёСЏ.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="DetailQRYTrud" Left="381,73253" Top="0" Width="60,47248" Height="18,89765" StretchMode="smMaxHeight" DataField="Trud" DataSet="DetailQRY" DataSetName="DetailQRY" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[DetailQRY.&#34;Trud&#34;]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="176" Width="1511,812">
      <TfrxMemoView Name="Memo1" Align="baRight" Left="1436,2214" Top="0" Width="75,5906" Height="18,89765" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="1046,92981" Left="381,73253" Top="0" Vertical="True" Width="60,47248" ColumnWidth="0" ColumnGap="0" DataSet="DetailQRY" DataSetName="DetailQRY" RowCount="0"/>
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="1046,92981" Left="22,67718" Top="0" Vertical="True" Width="340,1577"/>
    <TfrxHeader Name="Header2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="56" Width="1511,812" Stretched="True">
      <TfrxMemoView Name="DetailQRYStrName" Left="381,73253" Top="0" Width="60,47248" Height="18,89765" StretchMode="smMaxHeight" DataField="StrName" DataSet="DetailQRY" DataSetName="DetailQRY" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[DetailQRY.&#34;StrName&#34;]"/>
    </TfrxHeader>
    <TfrxFooter Name="Footer1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="136" Width="1511,812">
      <TfrxMemoView Name="Memo6" Left="381,73253" Top="0" Width="60,47248" Height="18,89765" StretchMode="smMaxHeight" DataSet="DetailQRY" DataSetName="DetailQRY" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Sum(&#60;DetailQRY.&#34;Trud&#34;&#62;,MasterData1)]"/>
      <TfrxMemoView Name="Memo8" Left="22,67718" Top="0" Width="340,15760236" Height="18,89765" DataSet="IzdelQRY" DataSetName="Изделия" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="РС‚РѕРіРѕ РїРѕ РІСЃРµРј РёР·РґРµР»РёСЏРј"/>
    </TfrxFooter>
  </TfrxReportPage>
</TfrxReport>
