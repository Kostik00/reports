<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.5.2" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="43012,4118899421" ReportOptions.Description.Text="" ReportOptions.Name="ÀÑÑ ìåòàëëîëîì çà ïåðèîä ïî äàòå ñïèñàíèÿ ìàòåðèàëà äåòàëèçàöèÿ.fr3 Ñïèñîê íàêëàäíûõ" ReportOptions.LastChange="43033,4155323843" ScriptLanguage="PascalScript" ScriptText.Text="Uses 'CommonRU.pas';&#13;&#10;&#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  Str:string;&#13;&#10;begin&#13;&#10;  Str:='01.01.01';&#13;&#10;  MyRestoreString('StartDate',Str);&#13;&#10;  DateFrom.Date:= StrToDate( Str );&#13;&#10;  Str:='01.01.01';&#13;&#10;  MyRestoreString('EndDate',Str);&#13;&#10;  DateTo.Date:= StrToDate( Str );&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnDeactivate(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  Str:string;&#13;&#10;begin&#13;&#10;  Str:=DateToStr(DateFrom.Date);&#13;&#10;  MySaveString('StartDate',Str);&#13;&#10;  Str:=DateToStr(DateTo.Date);&#13;&#10;  MySaveString('EndDate',Str);&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="LomQRY" DataSetName="Ëîì"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="LomQRY" UserName="Ëîì" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT &#13;&#10;	T1.*, &#13;&#10;&#13;&#10; T_Predm.Massa*T1.PaspKolvo SMD,                                       &#13;&#10;&#13;&#10;	SmMZ - T1.PaspKolvo*T1.Massa ML,&#13;&#10;	(SmMZ - T1.PaspKolvo*T1.Massa) * Gr_Othod.Percent_O / 100 SML , &#13;&#10;&#13;&#10;&#13;&#10;	Gr_Groups.Cod_Gr, &#13;&#10;	Gr_Groups.Name_Gr, &#13;&#10;&#13;&#10;  T_Predm_O.Key_Predm Key_Predm_O,                              &#13;&#10;		T_Predm_O.PrintFlag PrintFlag_O, &#13;&#10;		T_Predm_O.Cod_Predm Cod_Predm_O, &#13;&#10;		T_Predm_O.Name_Predm Name_Predm_O, &#13;&#10;&#13;&#10;		T_Predm_O.Sortam Sortam_O, &#13;&#10;		T_Predm_O.OrderSortam OrderSortam_O,&#13;&#10;&#13;&#10;		T_Predm_O.Type_NTD_Sortam AS Type_NTD_Sortam_O, &#13;&#10;		T_Predm_O.Name_NTD_Sortam AS Name_NTD_Sortam_O, &#13;&#10;		T_Predm_O.Marka Marka_O, &#13;&#10;		T_Predm_O.Type_NTD_Marka  AS Type_NTD_Marka_O, &#13;&#10;		T_Predm_O.Name_NTD_Marka  AS Name_NTD_Marka_O,&#13;&#10;&#13;&#10;  T_Predm.Cod_Predm,&#13;&#10;  T_Predm.Name_Predm,&#13;&#10;  Pr_Pasp.Cod_Zak                        &#13;&#10;        &#13;&#10;&#13;&#10;FROM&#13;&#10;(&#13;&#10;SELECT        &#13;&#10;	P_VKZ_GrZap.Key_GrZap, &#13;&#10;	Pr_Pasp.Key_Pasport,&#13;&#10;	Pr_Pasp.PaspKolvo,&#13;&#10;	T_SPRows.SP_position, &#13;&#10;	T_SPRows.Key_Predm,&#13;&#10;&#13;&#10;	T_Predm.Massa,&#13;&#10;&#13;&#10;	P_VKZ_GrZap.DateGrZap,&#13;&#10;	&#13;&#10;--	MIN(A_Nacl.DateAc) DateAc, &#13;&#10;--	MIN(A_Nacl.Data_Nacl) Data_Nacl,&#13;&#10;	TSP.DateAc,&#13;&#10;	TSP.Data_Nacl,&#13;&#10;	MAX(Pr_Pasp.Date_Zap) MaxDate_Zap,&#13;&#10;	MIN(Pr_Pasp.Date_Zap) MinDate_Zap,&#13;&#10;&#13;&#10;	SUM(Pr_SPDetail.M_Zag*Pr_SPDetail.Kolvo)  SmMz&#13;&#10;FROM            &#13;&#10;	P_VKZ_GrZap &#13;&#10;	INNER JOIN Pr_Pasp &#13;&#10;		ON P_VKZ_GrZap.Key_GrZap = Pr_Pasp.Key_GrZap &#13;&#10;	INNER JOIN T_Predm	&#13;&#10;		ON T_Predm.Key_Predm = Pr_Pasp.Key_Predm&#13;&#10;	INNER JOIN Pr_SP &#13;&#10;		ON Pr_Pasp.Key_Pasport = Pr_SP.Key_Pasport &#13;&#10;&#13;&#10;	INNER JOIN T_SPRows&#13;&#10;		ON T_SPRows.Key_SPRow = Pr_SP.Key_SPRow&#13;&#10;&#13;&#10;	INNER JOIN Pr_SPDetail&#13;&#10;		ON Pr_SPDetail.Key_PrSp =  Pr_SP.Key_PrSp&#13;&#10;&#13;&#10;LEFT JOIN &#13;&#10;(&#13;&#10;SELECT&#13;&#10;&#13;&#10;	A_Nacl_Str_GrZap.Key_GrZap,&#13;&#10;	A_Nacl_Str.Key_ID_Mat,&#13;&#10;	MIN(A_Nacl.DateAc) DateAc, &#13;&#10;	MIN(A_Nacl.Data_Nacl) Data_Nacl&#13;&#10;FROM A_Nacl_Str_GrZap &#13;&#10;&#13;&#10;	LEFT JOIN A_Nacl_Str &#13;&#10;		ON A_Nacl_Str_GrZap.Key_Nacl_Str = A_Nacl_Str.Key_Nacl_Str &#13;&#10;	LEFT JOIN A_Nacl &#13;&#10;		ON A_Nacl_Str.Key_Nacl = A_Nacl.Key_Nacl&#13;&#10;GROUP BY &#13;&#10;	A_Nacl_Str_GrZap.Key_GrZap,&#13;&#10;	A_Nacl_Str.Key_ID_Mat&#13;&#10;	) TSP&#13;&#10;	ON TSP.Key_GrZap =  P_VKZ_GrZap.Key_GrZap&#13;&#10;	AND TSP.Key_ID_Mat = Pr_SP.Key_ID_Mat&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;WHERE  &#13;&#10;	T_SPRows.SP_position = 0&#13;&#10;GROUP BY&#13;&#10;	P_VKZ_GrZap.Key_GrZap, &#13;&#10;	Pr_Pasp.Key_Pasport,&#13;&#10;	Pr_Pasp.PaspKolvo,&#13;&#10;	T_SPRows.SP_position, &#13;&#10;	T_SPRows.Key_Predm,&#13;&#10;	T_Predm.Massa,&#13;&#10;	TSP.DateAc,&#13;&#10;	TSP.Data_Nacl,&#13;&#10;	P_VKZ_GrZap.DateGrZap&#13;&#10;) T1&#13;&#10;&#13;&#10;		INNER JOIN  T_VPredm	&#13;&#10;			ON T_VPredm.Key_Predm = T1.Key_Predm&#13;&#10;&#13;&#10;  INNER JOIN Pr_Pasp&#13;&#10;   ON Pr_Pasp.Key_Pasport = T1.Key_Pasport                                                                              &#13;&#10;&#13;&#10;		INNER JOIN Gr_VxodPredm &#13;&#10;			ON T1.Key_Predm = Gr_VxodPredm.Key_Predm &#13;&#10;		INNER JOIN Gr_V_Othod&#13;&#10;			ON Gr_V_Othod.Key_VidGr = 1&#13;&#10;			AND Gr_V_Othod.Cod_Gr = Gr_VxodPredm.Cod_Gr&#13;&#10;		INNER JOIN Gr_Othod&#13;&#10;			ON Gr_Othod.Key_VidGr = Gr_V_Othod.Key_VidGr&#13;&#10;			AND Gr_Othod.Cod_Gr = Gr_V_Othod.Cod_Gr_To&#13;&#10;&#13;&#10;		INNER JOIN T_VPredm T_Predm_O&#13;&#10;			ON T_Predm_O.Key_Predm = Gr_Othod.Key_Predm_O &#13;&#10;&#13;&#10;		INNER JOIN Gr_VxodPredm  Gr_VxodPredm_O&#13;&#10;			ON T_Predm_O.Key_Predm = Gr_VxodPredm_O.Key_Predm &#13;&#10;		INNER JOIN Gr_Groups &#13;&#10;			ON Gr_VxodPredm_O.Key_VidGr = Gr_Groups.Key_VidGr &#13;&#10;			AND Gr_VxodPredm_O.Cod_Gr = Gr_Groups.Cod_Gr &#13;&#10;&#13;&#10;		INNER JOIN T_VPredm T_Predm &#13;&#10;			ON T_Predm.Key_Predm = Pr_Pasp.Key_Predm &#13;&#10;         &#13;&#10;&#13;&#10;WHERE &#13;&#10;       (SmMZ - T1.PaspKolvo*T1.Massa) &#62; 0&#13;&#10;       AND T1.DateAc  between :DateFrom and :DateTo                            &#13;&#10;ORDER BY &#13;&#10;		Gr_Groups.Cod_Gr,&#13;&#10;  T_Predm_O.Key_Predm,                                 &#13;&#10;		Cod_Zak                  " PropData="05704C65667402580470546F7002280A506172616D657465727301010C41000000204E616D653D224461746546726F6D222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746546726F6D2E446174652200010C3D000000204E616D653D2244617465546F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D2244617465546F2E44617465220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="200" ClientHeight="161" Left="314" Top="130" Width="300" ClientWidth="284" OnActivate="DialogPage1OnActivate" OnDeactivate="DialogPage1OnDeactivate">
    <TfrxDateEditControl Name="DateFrom" Left="120" Top="20" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="43012" Time="43012" WeekNumbers="False"/>
    <TfrxDateEditControl Name="DateTo" Left="120" Top="64" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="43012,9999884259" Time="43012,9999884259" WeekNumbers="False"/>
    <TfrxButtonControl Name="Button1" Left="188" Top="128" Width="75" Height="25" ShowHint="True" Caption="ÎÊ" ModalResult="1"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="46,45671" Left="0" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo17" Align="baWidth" Left="0" Top="7,55906" Width="718,1107" Height="30,23624" Font.Charset="1" Font.Color="0" Font.Height="-21" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="ÐœÐµÑ‚Ð°Ð»Ð»Ð¾Ð»Ð¾Ð¼ Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ñ [DateFrom.Date] Ð¿Ð¾ [DateTo.Date]">
        <Formats>
          <item FormatStr="dd.mm.yyyy" Kind="fkDateTime"/>
          <item FormatStr="dd.mm.yyyy" Kind="fkDateTime"/>
        </Formats>
      </TfrxMemoView>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,8976378" Left="0" Top="253,22851" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="LomQRY" DataSetName="Ëîì" RowCount="0">
      <TfrxMemoView Name="Memo5" Left="75,5906" Top="0" Width="340,1577" Height="18,8976377952756" DataSet="LomQRY" DataSetName="Ëîì" Text="[Ð›Ð¾Ð¼.&#34;Cod_Predm&#34;] [Ð›Ð¾Ð¼.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="638,74057" Top="0" Width="79,37013" Height="18,8976378" DataField="SML" DataSet="LomQRY" DataSetName="Ëîì" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Text="[Ð›Ð¾Ð¼.&#34;SML&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="495,11843" Top="0" Width="79,37013" Height="18,8976378" DataField="SMD" DataSet="LomQRY" DataSetName="Ëîì" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Text="[Ð›Ð¾Ð¼.&#34;SMD&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="415,7483" Top="0" Width="79,37013" Height="18,8976378" DataField="SmMz" DataSet="LomQRY" DataSetName="Ëîì" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Text="[Ð›Ð¾Ð¼.&#34;SmMz&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="574,48856" Top="0" Width="64,25201" Height="18,8976378" DataField="ML" DataSet="LomQRY" DataSetName="Ëîì" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Text="[Ð›Ð¾Ð¼.&#34;ML&#34;]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="457,32313" Width="718,1107">
      <TfrxMemoView Name="Memo1" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="124,72449" Width="718,1107" Condition="Ëîì.&#34;Cod_Gr&#34;">
      <TfrxMemoView Name="Memo3" Left="0" Top="0" Width="400,63018" Height="18,89765" DataField="Name_Gr" DataSet="LomQRY" DataSetName="Ëîì" Text="[Ð›Ð¾Ð¼.&#34;Name_Gr&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupHeader Name="GroupHeader2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="166,29932" Width="718,1107" Condition="Ëîì.&#34;Key_Predm_O&#34;">
      <TfrxMemoView Name="Memo2" Left="18,89765" Top="3,77953" Width="400,63018" Height="18,89765" DataSet="LomQRY" DataSetName="Ëîì" Text="[PrintPredm(&#60;Ð›Ð¾Ð¼.&#34;PrintFlag_O&#34;&#62;,  &#60;Ð›Ð¾Ð¼.&#34;Cod_Predm_O&#34;&#62;, &#60;Ð›Ð¾Ð¼.&#34;Name_Predm_O&#34;&#62;,&#13;&#10;                                       &#60;Ð›Ð¾Ð¼.&#34;Sortam_O&#34;&#62;, &#60;Ð›Ð¾Ð¼.&#34;Type_NTD_Sortam_O&#34;&#62;, &#60;Ð›Ð¾Ð¼.&#34;Name_NTD_Sortam_O&#34;&#62;,&#13;&#10;                                       &#60;Ð›Ð¾Ð¼.&#34;Marka_O&#34;&#62;,   &#60;Ð›Ð¾Ð¼.&#34;Type_NTD_Marka_O&#34;&#62;,  &#60;Ð›Ð¾Ð¼.&#34;Name_NTD_Marka_O&#34;&#62;)]"/>
    </TfrxGroupHeader>
    <TfrxGroupHeader Name="GroupHeader3" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="211,65368" Width="718,1107" Condition="Ëîì.&#34;Cod_Zak&#34;">
      <TfrxMemoView Name="Memo4" Left="37,7953" Top="0" Width="238,11039" Height="18,89765" DataField="Cod_Zak" DataSet="LomQRY" DataSetName="Ëîì" Text="[Ð›Ð¾Ð¼.&#34;Cod_Zak&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="294,80334" Width="718,1107">
      <TfrxMemoView Name="Memo13" Left="37,7953" Top="0" Width="600,94527" Height="18,89765" DataSet="LomQRY" DataSetName="Ëîì" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text=" [Ð›Ð¾Ð¼.&#34;Cod_Zak&#34;] ">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo10" Left="638,74057" Top="0" Width="79,37013" Height="18,89765" DataSet="LomQRY" DataSetName="Ëîì" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;Ð›Ð¾Ð¼.&#34;SML&#34;&#62;)]"/>
    </TfrxGroupFooter>
    <TfrxGroupFooter Name="GroupFooter2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="336,37817" Width="718,1107">
      <TfrxMemoView Name="Memo14" Left="18,89765" Top="0" Width="396,85065" Height="18,89765" DataSet="LomQRY" DataSetName="Ëîì" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Fill.BackColor="13434879" ParentFont="False" Text="Ð˜Ñ‚Ð¾Ð³Ð¾ Ð¿Ð¾ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñƒ  [PrintPredm(&#60;Ð›Ð¾Ð¼.&#34;PrintFlag_O&#34;&#62;,  &#60;Ð›Ð¾Ð¼.&#34;Cod_Predm_O&#34;&#62;, &#60;Ð›Ð¾Ð¼.&#34;Name_Predm_O&#34;&#62;,&#13;&#10;                                       &#60;Ð›Ð¾Ð¼.&#34;Sortam_O&#34;&#62;, &#60;Ð›Ð¾Ð¼.&#34;Type_NTD_Sortam_O&#34;&#62;, &#60;Ð›Ð¾Ð¼.&#34;Name_NTD_Sortam_O&#34;&#62;,&#13;&#10;                                       &#60;Ð›Ð¾Ð¼.&#34;Marka_O&#34;&#62;,   &#60;Ð›Ð¾Ð¼.&#34;Type_NTD_Marka_O&#34;&#62;,  &#60;Ð›Ð¾Ð¼.&#34;Name_NTD_Marka_O&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo11" Left="638,74057" Top="0" Width="79,37013" Height="18,89765" DataSet="LomQRY" DataSetName="Ëîì" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;Ð›Ð¾Ð¼.&#34;SML&#34;&#62;)]"/>
    </TfrxGroupFooter>
    <TfrxGroupFooter Name="GroupFooter3" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="377,953" Width="718,1107">
      <TfrxMemoView Name="Memo15" Left="0" Top="0" Width="638,74057" Height="18,89765" DataSet="LomQRY" DataSetName="Ëîì" Text="Ð˜Ñ‚Ð¾Ð³Ð¾ Ð¿Ð¾ Ð³Ñ€ÑƒÐ¿Ð¿Ðµ: [Ð›Ð¾Ð¼.&#34;Name_Gr&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="638,74057" Top="0" Width="79,37013" Height="18,89765" DataSet="LomQRY" DataSetName="Ëîì" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;Ð›Ð¾Ð¼.&#34;SML&#34;&#62;)]"/>
    </TfrxGroupFooter>
  </TfrxReportPage>
</TfrxReport>
