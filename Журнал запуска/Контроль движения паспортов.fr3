<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.15" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="41702,6873822222" ReportOptions.Description.Text="" ReportOptions.Name="Контроль движения паспортов.fr3 Журнал запуска" ReportOptions.LastChange="42404,642326331" ScriptLanguage="PascalScript" ScriptText.Text="Uses 'CommonRU.pas';                  &#13;&#10;&#13;&#10;  &#13;&#10;procedure DateZapMemoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure EditDayOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CheckBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ParamPageOnActivate(Sender: TfrxComponent);&#13;&#10;&#13;&#10;var&#13;&#10;  Str:string;                                 &#13;&#10;begin&#13;&#10;  Str:='01.01.01';&#13;&#10;  MyRestoreString('DateFrom',Str);        &#13;&#10;  DateFrom.Date:= StrToDate( Str );  &#13;&#10;  Str:='01.01.01';&#13;&#10;  MyRestoreString('DateTo',Str);        &#13;&#10;  DateTo.Date:= StrToDate( Str );&#13;&#10;    &#13;&#10;  MyRestoreString('FIO', Fio.Text)         &#13;&#10;        &#13;&#10;      &#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ParamPageOnDeactivate(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  Str:string;                                 &#13;&#10;begin&#13;&#10;  Str:=DateToStr(DateFrom.Date);&#13;&#10;  MySaveString('DateFrom',Str);        &#13;&#10;  Str:=DateToStr(DateTo.Date);&#13;&#10;  MySaveString('DateTo',Str);        &#13;&#10;  MySaveString('FIO', Fio.Text)         &#13;&#10;  &#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403800203546F70022008446174617365747301010C2600000020446174615365743D22506173702220446174615365744E616D653D22CFE0F1EFEEF0F2E0220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="Pasp" UserName="Паспорта" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="DECLARE  @DTFrom datetime&#13;&#10;SET @DTFrom = :DateFrom                   &#13;&#10;DECLARE  @DTTo datetime&#13;&#10;SET @DTTo = :DateTo            &#13;&#10;&#13;&#10;&#13;&#10;SELECT     &#13;&#10; Pr_Pasp.Cod_Pasp,&#13;&#10;	T_VPredm.Cod_Predm,&#13;&#10;	T_VPredm.Name_Predm,&#13;&#10;	Pr_Pasp_Ev.Key_Pasp_Ev, &#13;&#10;	Pr_Pasp_Ev.Key_Pasport, &#13;&#10;	S_Subjects.Name_Sub, &#13;&#10;	Pr_Pasp_Ev.UserName, &#13;&#10;	Pr_Pasp_Ev.UserHost, &#13;&#10;	Pr_Pasp_Ev.FirstEv, &#13;&#10;	Pr_Pasp_Ev.Next_Pasp_Ev,&#13;&#10; Pr_Pasp_Status.Name_Pasp_Status,             &#13;&#10;	Isnull(Next_Pr_Pasp_Ev.FirstEv, GetDate()) AS DateOut,&#13;&#10;&#13;&#10;  T_Predm_Mat.PrintFlag PrintFlag_Mat,                                      &#13;&#10;  T_Predm_Mat.Cod_Predm Cod_Predm_Mat,&#13;&#10;  T_Predm_Mat.Name_Predm Name_Predm_Mat,&#13;&#10;  T_Predm_Mat.Sortam Sortam_Mat,&#13;&#10;  T_Predm_Mat.Type_NTD_Sortam Type_NTD_Sortam_Mat,&#13;&#10;  T_Predm_Mat.Name_NTD_Sortam Name_NTD_Sortam_Mat,&#13;&#10;  T_Predm_Mat.Marka  Marka_Mat,&#13;&#10;  T_Predm_Mat.Type_NTD_Marka Type_NTD_Marka_Mat,&#13;&#10;  T_Predm_Mat.Name_NTD_Marka Name_NTD_Marka_Mat,&#13;&#10;  A_ID_Mat.VidSert,&#13;&#10;  A_ID_Mat.N_Sert,&#13;&#10;  A_ID_Mat.Date_Sert,                            &#13;&#10;&#13;&#10;  Next_Pr_Pasp_Ev.FirstEv DateOut00,                              &#13;&#10;  Pr_Pasp_Ev.FirstEv DateIn00,                            &#13;&#10;&#13;&#10;    convert(float, Isnull(Next_Pr_Pasp_Ev.FirstEv, GetDate())) - convert(float, Pr_Pasp_Ev.FirstEv) D&#13;&#10;&#13;&#10;      &#13;&#10;FROM         &#13;&#10;	Pr_Pasp&#13;&#10; INNER JOIN Pr_Pasp_Status&#13;&#10;   ON Pr_Pasp_Status.Key_Pasp_Status =  Pr_Pasp.Key_Pasp_Status&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;  LEFT JOIN&#13;&#10;  (&#13;&#10;    SELECT     Pr_Pasp.Key_Pasport, MIN(Pr_SP.Key_ID_Mat) AS Key_ID_Mat&#13;&#10;    FROM         Pr_SP INNER JOIN&#13;&#10;                          Pr_Pasp ON Pr_SP.Key_Pasport = Pr_Pasp.Key_Pasport&#13;&#10;    GROUP BY Pr_Pasp.Key_Pasport&#13;&#10;   ) TM&#13;&#10;   ON TM.Key_Pasport =  Pr_Pasp.Key_Pasport&#13;&#10;&#13;&#10;   LEFT JOIN A_VID_Mat   A_ID_Mat&#13;&#10;   ON A_ID_Mat.Key_ID_Mat = TM.Key_ID_Mat&#13;&#10;&#13;&#10;  LEFT JOIN T_VPredm T_Predm_Mat&#13;&#10;    ON  T_Predm_Mat.Key_Predm = A_ID_Mat.Key_Predm&#13;&#10;      &#13;&#10;&#13;&#10;     &#13;&#10;  &#13;&#10;	INNER JOIN Pr_Pasp_Ev &#13;&#10;		ON Pr_Pasp_Ev.Key_Pasport = Pr_Pasp.Key_Pasport&#13;&#10;	INNER JOIN S_Subjects &#13;&#10;		ON Pr_Pasp_Ev.UserName = S_Subjects.cod_sub &#13;&#10;	LEFT OUTER JOIN Pr_Pasp_Ev  AS Next_Pr_Pasp_Ev &#13;&#10;		ON Pr_Pasp_Ev.Next_Pasp_Ev = Next_Pr_Pasp_Ev.Key_Pasp_Ev&#13;&#10;	INNER JOIN T_VPredm&#13;&#10;		ON T_VPredm.Key_Predm = Pr_Pasp.Key_Predm&#13;&#10;WHERE     &#13;&#10;--	Pr_Pasp.Key_Pasport =  66018 AND &#13;&#10;	Pr_Pasp_Ev.FirstEv      &#60; @DTTo&#13;&#10;	AND Isnull(Next_Pr_Pasp_Ev.FirstEv, GetDate()) &#62; @DtFrom&#13;&#10;	AND convert(float, Isnull(Next_Pr_Pasp_Ev.FirstEv, GetDate())) - convert(float, Pr_Pasp_Ev.FirstEv) &#62;= :Days           &#13;&#10;	AND S_Subjects.Name_Sub like :NameSub&#13;&#10; AND (( :NoprintReady = 0) OR(Pr_Pasp_Status.Key_Pasp_Status &#60; 6 ))                               &#13;&#10;ORDER BY &#13;&#10;  S_Subjects.Name_Sub,   D Desc                          " PropData="05704C656674024C0470546F70021C0A506172616D657465727301010C41000000204E616D653D224461746546726F6D222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746546726F6D2E446174652200010C3D000000204E616D653D2244617465546F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D2244617465546F2E446174652200010C38000000204E616D653D2244617973222044617461547970653D226674496E7465676572222045787072657373696F6E3D22446179732E546578742200010C39000000204E616D653D224E616D65537562222044617461547970653D226674537472696E67222045787072657373696F6E3D2246494F2E546578742200010C4B000000204E616D653D224E6F7072696E745265616479222044617461547970653D226674496E7465676572222045787072657373696F6E3D224E6F7072696E7452656164792E436865636B6564220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="ParamPage" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Height="256" ClientHeight="218" Left="354" Top="140" Width="300" ClientWidth="284" OnActivate="ParamPageOnActivate" OnDeactivate="ParamPageOnDeactivate">
    <TfrxEditControl Name="FIO" Left="140" Top="116" Width="129" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="Новичк%"/>
    <TfrxButtonControl Name="Button1" Left="196" Top="180" Width="75" Height="25" ShowHint="True" Caption="OK" ModalResult="1"/>
    <TfrxLabelControl Name="Label1" Left="72" Top="120" Width="44" Height="16" ShowHint="True" Caption="Мастер" Color="-16777201"/>
    <TfrxEditControl Name="Days" Left="140" Top="148" Width="129" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="3" OnClick="EditDayOnClick"/>
    <TfrxDateEditControl Name="DateFrom" Left="140" Top="12" Width="129" Height="21" ShowHint="True" Color="-16777211" Date="42213" Time="42213" WeekNumbers="False"/>
    <TfrxDateEditControl Name="DateTo" Left="140" Top="44" Width="129" Height="21" ShowHint="True" Color="-16777211" Date="42213,9999884259" Time="42213,9999884259" WeekNumbers="False"/>
    <TfrxCheckBoxControl Name="NoprintReady" Left="104" Top="80" Width="165" Height="17" ShowHint="True" Caption="Скрыть изготовленные" Color="-16777201" OnClick="CheckBox1OnClick"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" Height="22,67718" Left="0" Top="16" Width="1046,92981"/>
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="104" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="Pasp" DataSetName="Паспорта" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="147,40167" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="Cod_Pasp" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Cod_Pasp&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="147,40167" Top="0" Width="257,00804" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Cod_Predm&#34;] [РџР°СЃРїРѕСЂС‚Р°.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="967,55968" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="D" DataSet="Pasp" DataSetName="Паспорта" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;D&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="404,40971" Top="0" Width="181,41744" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="Name_Pasp_Status" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Name_Pasp_Status&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="585,82715" Top="0" Width="207,87415" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Name_Predm_Mat&#34;] [РџР°СЃРїРѕСЂС‚Р°.&#34;Sortam_Mat&#34;] [РџР°СЃРїРѕСЂС‚Р°.&#34;Marka_Mat&#34;] [РџР°СЃРїРѕСЂС‚Р°.&#34;VidSert&#34;] [РџР°СЃРїРѕСЂС‚Р°.&#34;N_Sert&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="793,7013" Top="0" Width="173,85838" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="Pasp" DataSetName="Паспорта" DisplayFormat.FormatStr="dd.mm.yy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;DateIn00&#34;] - [РџР°СЃРїРѕСЂС‚Р°.&#34;DateOut00&#34;]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" Height="22,67718" Left="0" Top="144" Width="1046,92981">
      <TfrxMemoView Name="Memo1" Left="971,33921" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" Height="22,67718" Left="0" Top="60" Width="1046,92981" Condition="Паспорта.&#34;Name_Sub&#34;" OutlineText="Паспорта.&#34;Name_Sub&#34;" StartNewPage="True">
      <TfrxMemoView Name="Memo3" Left="0" Top="3,77952999999999" Width="1046,92981" Height="18,89765" ShowHint="False" Color="10218495" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Name_Sub&#34;]"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
</TfrxReport>
