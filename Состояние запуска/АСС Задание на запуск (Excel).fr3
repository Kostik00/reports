<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="6.8.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42215,0909024074" ReportOptions.Description.Text="" ReportOptions.Name="АСС Задание на запуск (Excel, ver. 09 - 08).fr3 Состояние запуска" ReportOptions.LastChange="44180,6966492477" ScriptLanguage="PascalScript" ScriptText.Text="Uses 'CommonRU.pas';&#13;&#10;&#13;&#10;var&#13;&#10;  iMD1Height: Integer;&#13;&#10;  iMD1Width: Integer;&#13;&#10;  iMD1Thickness: Integer;&#13;&#10;  iFactor: Integer;&#13;&#10;&#13;&#10;  sMD1Height: String;&#13;&#10;  sMD1Width: String;&#13;&#10;  sMD1Thickness: String;&#13;&#10;&#13;&#10;const&#13;&#10;  sShortStringCase = '^(\d+)([\±\-\+]((\d+,\d+)|\d+))?\s*[xх]\s*(\d+)([\±\-\+]((\d+,\d+)|\d+))?$';&#13;&#10;    //  '457±1,5 x 553+2,5' '457±1,5 x 553' '457 x 553+2,5' '457 x 553' '457x553'&#13;&#10;  sMiddleStringCase = '^\((\d+)([\±\-\+]((\d+,\d+)|\d+))?\s*[xх]\s*(\d+)([\±\-\+]((\d+,\d+)|\d+))?\)\s*[xх]\s*(\d+)$';&#13;&#10;    //  '(457-1x553±1,5)x5'&#13;&#10;  sMiddleStringCaseAndGoOn = '^\(\d+([\±\-\+]((\d+,\d+)|\d+))?\s*[xх]\s*\d+([\±\-\+]((\d+,\d+)|\d+))?\)\s*[xх]\s*\d+\s*\+';&#13;&#10;    //  '(457-1x553±1,5)x5+' '(457±1,5x553+2,5) x  5  +'&#13;&#10;  sLongStringCase = '^\(\d+([\±\-\+]((\d+,\d+)|\d+))?\s*[xх]\s*\d+([\±\-\+]((\d+,\d+)|\d+))?\)\s*[xх]\s*\d+\s*[+]\s*\(\d+([\±\-\+]((\d+,\d+)|\d+))?\s*[xх]\s*\d+([\±\-\+]((\d+,\d+)|\d+))?\)\s*[xх]\s*\d+';&#13;&#10;    //  '(457-1x553±1,5)x5 +  (457+1,5x553±3,5)x1'  '(457-1x553±1,5)x5+(457+1,5x553±3,5)x1'&#13;&#10;    //  '[+]\s*\(\d+([\±\-\+]((\d+,\d+)|\d+))?\s*[xх]\s*\d+([\±\-\+]((\d+,\d+)|\d+))?\)\s*[xх]\s*\d+'   '+(457+1,5x553±3,5)x1'  ' +  (457+1,5x553±3,5)x1'&#13;&#10;    //  '^[+]\s*\(\d+([\±\-\+]((\d+,\d+)|\d+))?\s*[xх]\s*\d+([\±\-\+]((\d+,\d+)|\d+))?\)\s*[xх]\s*\d+'  '+(457+1,5x553±3,5)x1'  '+   (457+1,5x553±3,5)x1'&#13;&#10;&#13;&#10;procedure DialogPage1OnDeactivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if DialogPage1.ModalResult = mrOk&#13;&#10;    then Header1.Visible:=cbHeaders.Checked;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  sTemp: String;&#13;&#10;  sFirstNumber: String;&#13;&#10;  sBlankSymbols: String;&#13;&#10;  sSecondNumber: String;&#13;&#10;begin&#13;&#10;&#13;&#10;  iMD1Height:=0;&#13;&#10;  iMD1Width:=0;&#13;&#10;  iMD1Thickness:=0;&#13;&#10;  iFactor:=1;&#13;&#10;&#13;&#10;  sTemp:=Trim(SumQRY.FieldByName('Prof_Razm').AsString);&#13;&#10;&#13;&#10;  sTemp:=StringReplace(sTemp, 'х', 'x', 1);&#13;&#10;  sTemp:=StringReplace(sTemp, 'Х', 'x', 1);&#13;&#10;  sTemp:=StringReplace(sTemp, '.', ',', 1);&#13;&#10;  sTemp:=StringReplace(sTemp, '*', 'x', 3);&#13;&#10;&#13;&#10;  if FindRegExpr('\d+$', Trim(SumQRY.FieldByName('Sortam_Mat').AsString)) = ''&#13;&#10;    then iMD1Thickness:=0&#13;&#10;    else iMD1Thickness:=StrToInt(FindRegExpr('\d+$', Trim(SumQRY.FieldByName('Sortam_Mat').AsString)));&#13;&#10;&#13;&#10;  if FindRegExpr(sMiddleStringCase, sTemp) &#60;&#62; '' then&#13;&#10;    begin&#13;&#10;      iMD1Height:=StrToInt(FindRegExprMatch(sMiddleStringCase, sTemp, 1));&#13;&#10;      iMD1Width:= StrToInt(FindRegExprMatch(sMiddleStringCase, sTemp, 5));&#13;&#10;      iFactor:=   StrToInt(FindRegExprMatch(sMiddleStringCase, sTemp, 9));&#13;&#10;//      iFactor:=   5;&#13;&#10;      Exit;&#13;&#10;    end;&#13;&#10;&#13;&#10;  if FindRegExpr(sShortStringCase, sTemp) &#60;&#62; '' then&#13;&#10;    begin&#13;&#10;      iMD1Height:=StrToInt(FindRegExprMatch(sShortStringCase, sTemp, 1));&#13;&#10;      iMD1Width:= StrToInt(FindRegExprMatch(sShortStringCase, sTemp, 5));&#13;&#10;      iFactor:=   1;&#13;&#10;      Exit;&#13;&#10;    end;&#13;&#10;&#13;&#10;{  if FindRegExpr(sLongStringCase, sTemp) then  ;&#13;&#10;  if FindRegExpr(sLongStringCase, sTemp) then  ;  }&#13;&#10;&#13;&#10;{  sFirstNumber:=FindRegExpr('^\d+', sTemp);&#13;&#10;  if sFirstNumber = ''&#13;&#10;    then iMD1Height:=0&#13;&#10;    else iMD1Height:=StrToInt(sFirstNumber);&#13;&#10;  sTemp:=Copy(sTemp, length(sFirstNumber)+1, length(sTemp));&#13;&#10;  sBlankSymbols:=FindRegExpr('^[\±\-\+]\d+,?[0-9]*\s+[xх]\s+', sTemp);&#13;&#10;  sTemp:=Copy(sTemp, length(sBlankSymbols)+1, length(sTemp));&#13;&#10;  sSecondNumber:=FindRegExpr('^\d+', sTemp);&#13;&#10;  if sSecondNumber = ''&#13;&#10;    then iMD1Width:=0&#13;&#10;    else iMD1Width:=StrToInt(sSecondNumber);  }&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  iMD1Height:=0;&#13;&#10;  iMD1Width:=0;&#13;&#10;  iMD1Thickness:=0;&#13;&#10;  iFactor:=1;&#13;&#10;&#13;&#10;  sMD1Height:='';&#13;&#10;  sMD1Width:='';&#13;&#10;  sMD1Thickness:='';&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="MainFrxDS" DataSetName="MainDS"/>
    <item DataSet="SumQRY" DataSetName="dsSum"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="SumQRY" UserName="dsSum" CloseDataSource="False" FieldAliases.Text="Key_GrZap=Key_GrZap&#13;&#10;DateGrZap=DateGrZap&#13;&#10;Cod_Predm=Cod_Predm&#13;&#10;Name_Predm=Name_Predm&#13;&#10;Sortam_Mat=Sortam_Mat&#13;&#10;Marka_Mat=Marka_Mat&#13;&#10;Kolvo=Kolvo&#13;&#10;Prof_Razm=Prof_Razm" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;    P_VKZ.Key_GrZap                 AS  Key_GrZap,&#13;&#10;    P_VKZ_GrZap.DateGrZap           AS  DateGrZap,          &#13;&#10;    T_VPredm.Cod_Predm              AS  Cod_Predm,&#13;&#10;    T_VPredm.Name_Predm             AS  Name_Predm,&#13;&#10;    T_Predm_Mat.Sortam              AS  Sortam_Mat,&#13;&#10;    T_Predm_Mat.Marka               AS  Marka_Mat,&#13;&#10;    SUM(P_VKZ.Kolvo)                AS  Kolvo,          &#13;&#10;    ISNULL(T_SPRows.Prof_Razm, '')  AS  Prof_Razm                &#13;&#10;  FROM&#13;&#10;    P_VKZ&#13;&#10;      INNER JOIN D_Zakaz&#13;&#10;              ON D_Zakaz.Cod_Zak = P_VKZ.Cod_Zak&#13;&#10;      INNER JOIN T_VPredm&#13;&#10;              ON P_VKZ.Key_Predm = T_VPredm.Key_Predm&#13;&#10;      INNER JOIN P_VKZ AS P_VKZ_Izdel&#13;&#10;              ON P_VKZ.Key_VKZ_Izdel = P_VKZ_Izdel.Key_VKZ&#13;&#10;      LEFT  JOIN P_VKZ_GrZap&#13;&#10;              ON P_VKZ.Key_GrZap = P_VKZ_GrZap.Key_GrZap  &#13;&#10;      INNER JOIN T_VPredm AS T_VPredm_Izdel&#13;&#10;              ON P_VKZ_Izdel.Key_Predm = T_VPredm_Izdel.Key_Predm&#13;&#10;      LEFT  JOIN P_VKZ AS P_VKZ_SB&#13;&#10;              ON P_VKZ.Key_VKZ_Master = P_VKZ_SB.Key_VKZ&#13;&#10;      LEFT  JOIN T_VPredm AS T_VPredm_SB&#13;&#10;              ON P_VKZ_SB.Key_Predm = T_VPredm_SB.Key_Predm&#13;&#10;      LEFT  JOIN T_SP&#13;&#10;              ON T_SP.Key_Predm = T_VPredm.Key_Predm&#13;&#10;             AND T_SP.Sp_Version = T_VPredm.Sp_Version&#13;&#10;      LEFT  JOIN T_SPRows&#13;&#10;              ON T_SPRows.Key_SP = T_SP.Key_SP&#13;&#10;             AND T_SPRows.SP_position = 0&#13;&#10;      LEFT  JOIN T_VPredm T_Predm_Mat&#13;&#10;              ON T_Predm_Mat.Key_Predm = T_SPRows.Key_Predm&#13;&#10;  WHERE&#13;&#10;    P_VKZ.Key_GrZap = :Key_GrZap&#13;&#10;  GROUP BY      &#13;&#10;    P_VKZ.Key_GrZap,&#13;&#10;    P_VKZ_GrZap.DateGrZap,        &#13;&#10;    T_VPredm.Cod_Predm,&#13;&#10;    T_VPredm.Name_Predm,&#13;&#10;    T_Predm_Mat.Sortam,&#13;&#10;    T_Predm_Mat.Marka,      &#13;&#10;    T_SPRows.Prof_Razm    &#13;&#10;  ORDER BY  &#13;&#10;    T_VPredm.Cod_Predm,&#13;&#10;    T_VPredm.Name_Predm;    " PropData="05704C65667402340470546F7002340A506172616D657465727301010C58000000204E616D653D224B65795F47725A6170222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4D61696E44532E262333343B4B65795F47725A6170262333343B262336323B220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" DoubleBuffered="False" Height="131" ClientHeight="104" Left="645" Top="157" Width="321" Scaled="True" ClientWidth="313" OnDeactivate="DialogPage1OnDeactivate">
    <TfrxLabelControl Name="lblMain" Anchors="7" Left="8" Top="8" Width="297" Height="23" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Tahoma" Font.Style="1" ParentFont="False" ShowHint="True" Alignment="taCenter" Caption="АСС задание на запуск (Excel)" Color="-16777201"/>
    <TfrxCheckBoxControl Name="cbHeaders" Left="8" Top="38" Width="141" Height="17" ShowHint="True" Caption="Показывать заголовки" Checked="True" State="cbChecked" Color="-16777201"/>
    <TfrxButtonControl Name="btCancel" Anchors="9" Left="8" Top="73" Width="75" Height="25" ShowHint="True" Caption="Отмена" ModalResult="2"/>
    <TfrxButtonControl Name="btOk" Anchors="12" Left="229" Top="73" Width="75" Height="25" ShowHint="True" Caption="Ok" ModalResult="1"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" Frame.Typ="0" MirrorMode="0" HGuides.Text="" VGuides.Text="">
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="56,69291339" Left="0" Top="18,89765" Width="1046,92981">
      <TfrxMemoView Name="Memo37" AllowVectorExport="True" Left="37,7953" Top="0" Width="264,5671" Height="56,69291339" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”РЎР•"/>
      <TfrxMemoView Name="Memo38" AllowVectorExport="True" Left="831,4966" Top="0" Width="75,59049992" Height="56,69291339" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="['РџСЂРѕС„. СЂР°Р·Рј.,'+#10+'РІС‹СЃРѕС‚Р° H РјРј.']"/>
      <TfrxMemoView Name="Memo39" AllowVectorExport="True" Left="982,6778" Top="0" Width="64,25201" Height="56,69291339" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»-РІРѕ"/>
      <TfrxMemoView Name="Memo40" AllowVectorExport="True" Left="411,96877" Top="0" Width="109,60637" Height="56,69291339" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎРѕСЂС‚Р°РјРµРЅС‚"/>
      <TfrxMemoView Name="Memo41" AllowVectorExport="True" Left="302,3624" Top="0" Width="109,60637" Height="56,69291339" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РњР°СЂРєР°"/>
      <TfrxMemoView Name="Memo43" AllowVectorExport="True" Left="907,0872" Top="0" Width="75,59049992" Height="56,69291339" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="['РџСЂРѕС„. СЂР°Р·Рј.,'+#10+'С€РёСЂРёРЅР° W РјРј.']"/>
      <TfrxMemoView Name="Memo18" AllowVectorExport="True" Left="585,82715" Top="0" Width="245,66934992" Height="56,69291339" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="['РџСЂРѕС„. СЂР°Р·Рј.,'+#10+'(orig)']"/>
      <TfrxMemoView Name="Memo42" AllowVectorExport="True" Left="521,57514" Top="0" Width="64,25197339" Height="56,69291339" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="['РўРѕР»С‰РёРЅР°,'+#10+'S, РјРј']"/>
      <TfrxMemoView Name="Memo20" AllowVectorExport="True" Left="0" Top="0" Width="37,7953" Height="56,69291339" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„–"/>
    </TfrxHeader>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="18,89765" Left="0" Top="103,937075" Width="1046,92981" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="SumQRY" DataSetName="dsSum" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo4" AllowVectorExport="True" Left="37,7953" Top="0" Width="264,5671" Height="18,89765" StretchMode="smMaxHeight" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" ParentFont="False" WordWrap="False" Text="[&#60;dsSum.&#34;Cod_Predm&#34;&#62;][' '][&#60;dsSum.&#34;Name_Predm&#34;&#62;]"/>
      <TfrxMemoView Name="Memo15" AllowVectorExport="True" Left="982,6778" Top="0" Width="64,25201" Height="18,89765" StretchMode="smMaxHeight" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" WordWrap="False" Text="[&#60;dsSum.&#34;Kolvo&#34;&#62;*iFactor]">
        <Formats>
          <item FormatStr="%2.0n" Kind="fkNumeric"/>
          <item/>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo16" AllowVectorExport="True" Left="411,96877" Top="0" Width="109,60637" Height="18,89765" StretchMode="smMaxHeight" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haCenter" ParentFont="False" WordWrap="False" Text="[dsSum.&#34;Sortam_Mat&#34;]"/>
      <TfrxMemoView Name="Memo17" AllowVectorExport="True" Left="302,3624" Top="0" Width="109,60637" Height="18,89765" StretchMode="smMaxHeight" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haCenter" ParentFont="False" WordWrap="False" Text="[dsSum.&#34;Marka_Mat&#34;]"/>
      <TfrxMemoView Name="Memo33" AllowVectorExport="True" Left="831,4966" Top="0" Width="75,59049992" Height="18,89765" StretchMode="smMaxHeight" DataSetName="Задание" DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" WordWrap="False" Text="[iMD1Height]"/>
      <TfrxMemoView Name="Memo35" AllowVectorExport="True" Left="521,57514" Top="0" Width="64,25197339" Height="18,89765" StretchMode="smMaxHeight" DataSetName="Задание" DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" WordWrap="False" Text="[iMD1Thickness]"/>
      <TfrxMemoView Name="Memo5" AllowVectorExport="True" Left="585,82715" Top="0" Width="245,66934992" Height="18,89765" StretchMode="smMaxHeight" DataSetName="Задание" DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" ParentFont="False" WordWrap="False" Text="[dsSum.&#34;Prof_Razm&#34;]"/>
      <TfrxMemoView Name="Memo19" AllowVectorExport="True" Left="0" Top="0" Width="37,7953" Height="18,89765" StretchMode="smMaxHeight" DataSetName="Задание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" WordWrap="False" Text="[Line]"/>
      <TfrxMemoView Name="Memo34" AllowVectorExport="True" Left="907,0872" Top="0" Width="75,59049992" Height="18,89765" StretchMode="smMaxHeight" DataSetName="Задание" DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" WordWrap="False" Text="[iMD1Width]"/>
    </TfrxMasterData>
  </TfrxReportPage>
</TfrxReport>
