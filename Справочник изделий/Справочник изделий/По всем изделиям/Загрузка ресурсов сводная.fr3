<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.5.2" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42264,6930036574" ReportOptions.Description.Text="" ReportOptions.Name="Загрузка ресурсов сводная.fr3 Справочник изделий" ReportOptions.LastChange="42983,4936151157" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;procedure Label1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DetailQRYTrudOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  DetailQRYTrud.Color := clNone;&#13;&#10;  if (&#13;&#10;         (&#60;Изделия.&#34;WorkTime&#34;&#62;*&#60;DetailQRY.&#34;CntWD&#34;&#62; - &#60;DetailQRY.&#34;Trud&#34;&#62;)&#13;&#10;       &#60; (&#60;Изделия.&#34;WorkTime&#34;&#62;*&#60;DetailQRY.&#34;CntWD&#34;&#62;)*0.05&#13;&#10;     ) then&#13;&#10;   DetailQRYTrud.Color := $008080FF&#13;&#10;   else&#13;&#10;  if (&#13;&#10;         (&#60;Изделия.&#34;WorkTime&#34;&#62;*&#60;DetailQRY.&#34;CntWD&#34;&#62; - &#60;DetailQRY.&#34;Trud&#34;&#62;)&#13;&#10;       &#62; (&#60;Изделия.&#34;WorkTime&#34;&#62;*&#60;DetailQRY.&#34;CntWD&#34;&#62;)*0.5&#13;&#10;     ) then&#13;&#10;   DetailQRYTrud.Color := $0077FFFF;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="IzdelQRY" DataSetName="Изделия"/>
    <item DataSet="DetailQRY" DataSetName="DetailQRY"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="IzdelQRY" UserName="Изделия" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT &#13;&#10;	   Pr_Pln_Res.*,                                     &#13;&#10;    Usr_PlnStr.ReportNum           &#13;&#10;                                                 &#13;&#10;         &#13;&#10;FROM         &#13;&#10;                 &#13;&#10;	    Pr_Pln_Res&#13;&#10;&#13;&#10;    INNER JOIN ( &#13;&#10;       SELECT     ReportNum, MIN(DateFrom) AS DateFrom, MAX(DateTo) AS DateTo&#13;&#10;       FROM         Usr_PlnStr&#13;&#10;       WHERE Usr_PlnStr.Usr = User           &#13;&#10;       GROUP BY ReportNum&#13;&#10;       )  Usr_PlnStr&#13;&#10;    ON     Usr_PlnStr.ReportNum = :ReportNum       &#13;&#10;                                                                                &#13;&#10;      &#13;&#10;                 &#13;&#10;WHERE     &#13;&#10;       Pr_Pln_Res.Name_Pln_Res like :Name_Pln_Res&#13;&#10;                                        &#13;&#10;&#13;&#10;ORDER BY Pr_Pln_Res.PriorPln, Pr_Pln_Res.Name_Pln_Res  " PropData="05704C65667402600470546F7002340A506172616D657465727301010C4C000000204E616D653D225265706F72744E756D222044617461547970653D226674496E7465676572222045787072657373696F6E3D22537472546F496E74285265706F72744E756D2E54657874292200010C43000000204E616D653D224E616D655F506C6E5F526573222044617461547970653D226674556E6B6E6F776E222045787072657373696F6E3D224E616D655265732E54657874220000"/>
    <TfrxERQuery Name="DetailQRY" UserName="DetailQRY" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="IzdelQRY" IgnoreDupParams="False" SQL.Text="DECLARE @Key_VKZ_Izdel int&#13;&#10;DECLARE @ReportNum int &#13;&#10;DECLARE @Key_Pln_Res int&#13;&#10;&#13;&#10;&#13;&#10;SET @Key_VKZ_Izdel= :Key_VKZ_Izdel     &#13;&#10;SET @ReportNum = :ReportNum  &#13;&#10;SET @Key_Pln_Res = :Key_Pln_Res&#13;&#10;&#13;&#10;&#13;&#10;SELECT T1.N_Str, T1.StrName, T1.Trud, T2.Trud PlnTrud, T1.CntWD                   &#13;&#10;&#13;&#10;FROM &#13;&#10;(&#13;&#10;SELECT     &#13;&#10;	Usr_PlnStr.N_Str,&#13;&#10;	Usr_PlnStr.StrName,&#13;&#10; Usr_PlnStr.CntWD,        &#13;&#10;&#13;&#10;	SUM(T00.TZap ) Trud&#13;&#10;	&#13;&#10;FROM&#13;&#10;&#13;&#10;(&#13;&#10;  SELECT        &#13;&#10;  	Usr_PlnStr.Usr, &#13;&#10;  	Usr_PlnStr.ReportNum, &#13;&#10;  	Usr_PlnStr.N_Str, &#13;&#10;  	Usr_PlnStr.StrName, &#13;&#10;  	Usr_PlnStr.DateFrom, &#13;&#10;  	Usr_PlnStr.DateTo,&#13;&#10;  	COUNT(SYS_Days.DayDate) AS CntWD&#13;&#10;  &#13;&#10;  FROM            Usr_PlnStr LEFT OUTER JOIN&#13;&#10;                           SYS_Days ON SYS_Days.DayDate BETWEEN Usr_PlnStr.DateFrom AND Usr_PlnStr.DateTo AND SYS_Days.WorkFlag = 1&#13;&#10;  GROUP BY Usr_PlnStr.Usr, Usr_PlnStr.ReportNum, Usr_PlnStr.N_Str, Usr_PlnStr.StrName, Usr_PlnStr.DateFrom, Usr_PlnStr.DateTo&#13;&#10;) 	Usr_PlnStr&#13;&#10;&#13;&#10;	LEFT JOIN &#13;&#10;	(&#13;&#10;&#13;&#10;  SELECT     &#13;&#10;       P_VKZ_Oper.Key_VKZ_Zap, &#13;&#10;       Pr_Pln_Oper_Res.TZap  TZap,&#13;&#10;       Pr_Pln_Oper_Res.DayDate&#13;&#10;       &#13;&#10;  FROM         &#13;&#10;         P_VKZ_Oper  &#13;&#10;         INNER JOIN  Pr_Pln_Oper_Res &#13;&#10;                 ON  Pr_Pln_Oper_Res.Key_Vkz_Oper = P_VKZ_Oper.Key_Vkz_Oper &#13;&#10;&#13;&#10;  WHERE P_VKZ_Oper.Key_Pln_Res = @Key_Pln_Res&#13;&#10;&#13;&#10;	) T00    &#13;&#10;		ON  T00.DayDate &#60;= Usr_PlnStr.DateTo&#13;&#10;		AND T00.DayDate &#62;= Usr_PlnStr.DateFrom&#13;&#10;&#13;&#10;&#13;&#10;WHERE &#13;&#10;       Usr_PlnStr.ReportNum = @ReportNum&#13;&#10;       AND Usr_PlnStr.Usr = User                                            &#13;&#10;                     &#13;&#10;GROUP BY 	&#13;&#10;	Usr_PlnStr.N_Str,&#13;&#10;	Usr_PlnStr.StrName,&#13;&#10; Usr_PlnStr.CntWD       &#13;&#10;) T1    &#13;&#10;&#13;&#10;&#13;&#10;INNER JOIN &#13;&#10;&#13;&#10;(&#13;&#10;    SELECT     &#13;&#10;      	Usr_PlnStr.N_Str,&#13;&#10;      	Usr_PlnStr.StrName,&#13;&#10;      	SUM(&#13;&#10;      	        (Isnull(P_VKZ_Oper.TSmSm,0))  *    &#13;&#10;               (dbo.DtFn_CntWDIn2P (P_VKZ_Oper.DateZap, P_VKZ_Oper.DateVip, Usr_PlnStr.DateFrom, Usr_PlnStr.DateTo)*1.0 &#13;&#10;               /  dbo.DtFn_CntWDInP(P_VKZ_Oper.DateZap, P_VKZ_Oper.DateVip)                            &#13;&#10;               -- P_VKZ_Oper.SmDaySm&#13;&#10;                )&#13;&#10;      		) Trud&#13;&#10;      	&#13;&#10;    FROM         &#13;&#10;    	Usr_PlnStr&#13;&#10;    &#13;&#10;    	LEFT JOIN &#13;&#10;    	(&#13;&#10;      	SELECT P_VKZ_Oper.* FROM P_VKZ_Oper&#13;&#10;       WHERE           &#13;&#10;      	P_VKZ_Oper.IsActive = 1&#13;&#10;      	AND P_VKZ_Oper.Key_Pln_Res = @Key_Pln_Res&#13;&#10;    	) P_VKZ_Oper&#13;&#10;    		ON  P_VKZ_Oper.DateZap &#60;= Usr_PlnStr.DateTo&#13;&#10;    		AND P_VKZ_Oper.DateVip &#62;= Usr_PlnStr.DateFrom&#13;&#10;      AND  dbo.DtFn_CntWDInP(P_VKZ_Oper.DateZap, P_VKZ_Oper.DateVip) &#62; 0                                                         &#13;&#10;    	--	AND P_VKZ_Oper.TSmSm &#62; 0&#13;&#10;    &#13;&#10;    WHERE &#13;&#10;           Usr_PlnStr.ReportNum = @ReportNum         &#13;&#10;           AND Usr_PlnStr.Usr = User                                            &#13;&#10;                         &#13;&#10;    GROUP BY 	&#13;&#10;    	Usr_PlnStr.N_Str,&#13;&#10;    	Usr_PlnStr.StrName&#13;&#10;) T2&#13;&#10;ON &#13;&#10;	T1.N_Str = T2.N_Str&#13;&#10;AND T1.StrName = T2.StrName&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;ORDER BY N_Str&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;  " PropData="05704C65667403CC000470546F7002340A506172616D657465727301010C2A000000204E616D653D224B65795F564B5A5F497A64656C222044617461547970653D226674556E6B6E6F776E2200010C26000000204E616D653D225265706F72744E756D222044617461547970653D226674556E6B6E6F776E2200010C28000000204E616D653D224B65795F506C6E5F526573222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="179" ClientHeight="140" Left="365" Top="134" Width="300" ClientWidth="284">
    <TfrxEditControl Name="ReportNum" Left="148" Top="20" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="1"/>
    <TfrxButtonControl Name="Button1" Left="196" Top="100" Width="75" Height="25" ShowHint="True" Caption="Button1" ModalResult="1"/>
    <TfrxLabelControl Name="Label1" Left="16" Top="24" Width="110" Height="13" ShowHint="True" Caption="№ наборки периодов" Color="-16777201" OnClick="Label1OnClick"/>
    <TfrxEditControl Name="NameRes" Left="148" Top="60" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="%"/>
    <TfrxLabelControl Name="Label3" Left="16" Top="64" Width="116" Height="13" ShowHint="True" Caption="Наименование ресурса" Color="-16777201" OnClick="Label1OnClick"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Orientation="poLandscape" PaperWidth="420" PaperHeight="297" PaperSize="8" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="18,89765" Width="1511,812"/>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="38,89765" Left="0" Top="139,84261" Width="1511,812" ColumnWidth="0" ColumnGap="0" DataSet="IzdelQRY" DataSetName="Изделия" OutlineText="&#60;Изделия.&#34;Name_Pln_Res&#34;&#62;" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo3" Left="22,67718" Top="0" Width="279,68522" Height="37,7953" StretchMode="smMaxHeight" DataSet="IzdelQRY" DataSetName="Изделия" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[РР·РґРµР»РёСЏ.&#34;Name_Pln_Res&#34;]">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="DetailQRYTrud" Left="381,73253" Top="18,89765" Width="60,47248" Height="18,89765" OnBeforePrint="DetailQRYTrudOnBeforePrint" StretchMode="smMaxHeight" DataSet="DetailQRY" DataSetName="DetailQRY" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="7864319" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[DetailQRY.&#34;Trud&#34;]"/>
      <TfrxMemoView Name="Memo2" Left="381,73253" Top="0" Width="60,47248" Height="18,89765" DataSet="DetailQRY" DataSetName="DetailQRY" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[DetailQRY.&#34;PlnTrud&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="340,1577" Top="0" Width="22,67718" Height="18,89765" DataSet="DetailQRY" DataSetName="DetailQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Рљ"/>
      <TfrxMemoView Name="Memo5" Left="340,1577" Top="18,89765" Width="22,67718" Height="18,89765" StretchMode="smMaxHeight" DataSet="DetailQRY" DataSetName="DetailQRY" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Рђ">
        <Formats>
          <item FormatStr="%2.2n" Kind="fkNumeric"/>
          <item FormatStr="%2.2n" Kind="fkNumeric"/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo11" Left="302,3624" Top="18,89765" Width="37,7953" Height="18,89765" StretchMode="smMaxHeight" DataSet="DetailQRY" DataSetName="DetailQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[РР·РґРµР»РёСЏ.&#34;WorkTime&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="302,3624" Top="0" Width="37,7953" Height="18,89765" StretchMode="smMaxHeight" DataSet="DetailQRY" DataSetName="DetailQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="313,70099" Width="1511,812">
      <TfrxMemoView Name="Memo1" Align="baRight" Left="1436,2214" Top="0" Width="75,5906" Height="18,89765" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="1046,92981" Left="381,73253" Top="0" Vertical="True" Width="60,47248" ColumnWidth="0" ColumnGap="0" DataSet="DetailQRY" DataSetName="DetailQRY" RowCount="0"/>
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="1046,92981" Left="22,67718" Top="0" Vertical="True" Width="340,1577"/>
    <TfrxHeader Name="Header2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="98,26778" Width="1511,812" Stretched="True">
      <TfrxMemoView Name="DetailQRYStrName" Left="381,73253" Top="0" Width="60,47248" Height="18,89765" StretchMode="smMaxHeight" DataSet="DetailQRY" DataSetName="DetailQRY" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[DetailQRY.&#34;StrName&#34;]&#13;&#10;([DetailQRY.&#34;CntWD&#34;])"/>
      <TfrxMemoView Name="Memo13" Left="22,67718" Top="0" Width="279,68522" Height="18,89765" StretchMode="smMaxHeight" DataSet="IzdelQRY" DataSetName="Изделия" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="Р РµСЃСѓСЂСЃ"/>
      <TfrxMemoView Name="Memo14" Left="302,3624" Top="0" Width="60,47248" Height="18,89765" StretchMode="smMaxHeight" DataSet="DetailQRY" DataSetName="DetailQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р§Р°СЃРѕРІ РІ РґРµРЅСЊ"/>
    </TfrxHeader>
    <TfrxFooter Name="Footer1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="52,91342" Left="0" Top="200,31509" Width="1511,812" Stretched="True">
      <TfrxMemoView Name="Memo6" Left="381,73253" Top="0" Width="60,47248" Height="18,89765" DataSet="DetailQRY" DataSetName="DetailQRY" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Sum(&#60;DetailQRY.&#34;PlnTrud&#34;&#62;,MasterData1)]">
        <Formats>
          <item FormatStr="%2.2f" Kind="fkNumeric"/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo8" Left="22,67718" Top="0" Width="317,48042236" Height="37,7953" StretchMode="smMaxHeight" DataSet="IzdelQRY" DataSetName="Изделия" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="РС‚РѕРіРѕ РїРѕ РІСЃРµРј РіСЂСѓРїРїР°Рј"/>
      <TfrxMemoView Name="Memo7" Left="381,73253" Top="18,89765" Width="60,47248" Height="18,89765" DataSet="DetailQRY" DataSetName="DetailQRY" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Sum(&#60;DetailQRY.&#34;Trud&#34;&#62;,MasterData1)]">
        <Formats>
          <item FormatStr="%2.2f" Kind="fkNumeric"/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo9" Left="340,1577" Top="0" Width="22,67718" Height="18,89765" DataSet="DetailQRY" DataSetName="DetailQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Рљ"/>
      <TfrxMemoView Name="Memo10" Left="340,1577" Top="18,89765" Width="22,67718" Height="18,89765" StretchMode="smMaxHeight" DataSet="DetailQRY" DataSetName="DetailQRY" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Рђ">
        <Formats>
          <item FormatStr="%2.2n" Kind="fkNumeric"/>
          <item FormatStr="%2.2n" Kind="fkNumeric"/>
        </Formats>
      </TfrxMemoView>
    </TfrxFooter>
  </TfrxReportPage>
</TfrxReport>
