<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.4" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38513,0822621875" ReportOptions.Description.Text="" ReportOptions.Name="Выбранные остатки.fr3 Справочник остатков" ReportOptions.LastChange="42458,6842231713" ScriptLanguage="PascalScript" ScriptText.Text="Uses 'CommonRU.pas';&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;function FnPredm:string;&#13;&#10;begin&#13;&#10;  Result:=PrintPredm  (&#60;MainDS.&#34;PrintFlag&#34;&#62;,&#60;MainDS.&#34;Cod_Predm&#34;&#62;, &#60;MainDS.&#34;Name_Predm&#34;&#62;,&#13;&#10;                       &#60;MainDS.&#34;Sortam&#34;&#62;, &#60;MainDS.&#34;Type_NTD_Sortam&#34;&#62;, &#60;MainDS.&#34;Name_NTD_Sortam&#34;&#62;,&#13;&#10;                       &#60;MainDS.&#34;Marka&#34;&#62;,  &#60;MainDS.&#34;Type_NTD_Marka&#34;&#62;,  &#60;MainDS.&#34;Name_NTD_Marka&#34;&#62;);&#13;&#10;&#13;&#10;//  Result:=Result+'('+VarToStr(&#60;ВСИ.&#34;PrintFlag&#34;&#62;)+')';&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure MainDSN_SertOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  ERQuery2.Open;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="MainFrxDS" DataSetName="MainDS"/>
    <item DataSet="OstDetail" DataSetName="Остаток"/>
    <item DataSet="ERQuery1" DataSetName="ERQuery1"/>
    <item DataSet="ERQuery2" DataSetName="ERQuery2"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="OstDetail" UserName="Остаток" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="SELECT     &#13;&#10;       A_Place.Name_Place, &#13;&#10;       T_Zagotov.Name_Zagotov, &#13;&#10;       A_Nacl_Str_Sost.ProfRazm, &#13;&#10;       A_Nacl_Str_Sost.M_Zag,&#13;&#10;       A_Nacl_Str_Sost.Kolvo - A_Nacl_Str_Sost.Rashod AS Ost, &#13;&#10;       A_Nacl_Str_Sost.M_Zag * (A_Nacl_Str_Sost.Kolvo - A_Nacl_Str_Sost.Rashod) AS KolvoSm,&#13;&#10;       A_Nacl.Key_Sub_Ver_To,                      &#13;&#10;       A_Nacl_Str.Key_ID_Mat,  &#13;&#10;       A_Nacl.Num_Nacl,&#13;&#10;       A_Nacl.Data_Nacl,&#13;&#10;       A_Nacl.Osnovanie                                          &#13;&#10;FROM&#13;&#10;       A_Nacl&#13;&#10;       INNER JOIN A_Nacl_Str &#13;&#10;               ON A_Nacl_Str.Key_Nacl = A_Nacl.Key_Nacl&#13;&#10;       INNER JOIN A_Nacl_Str_Sost&#13;&#10;               ON A_Nacl_Str_Sost.Key_Nacl_Str = A_Nacl_Str.Key_Nacl_Str &#13;&#10;       INNER JOIN T_Zagotov &#13;&#10;               ON A_Nacl_Str_Sost.Cod_Zagotov = T_Zagotov.Cod_Zagotov&#13;&#10;       LEFT JOIN A_Place &#13;&#10;               ON A_Nacl_Str.Key_Place = A_Place.Key_Place &#13;&#10;         &#13;&#10;WHERE&#13;&#10;       A_Nacl.Key_Sub_Ver_To=:Key_Sub_Ver                            &#13;&#10;       AND A_Nacl_Str.Key_ID_Mat=:Key_ID_Mat                             &#13;&#10;       AND (A_Nacl_Str_Sost.Kolvo - A_Nacl_Str_Sost.Rashod &#62; 0)&#13;&#10;ORDER BY A_Place.Name_Place  " PropData="05704C65667402440470546F70023C0A506172616D657465727301010C28000000204E616D653D224B65795F5375625F566572222044617461547970653D226674556E6B6E6F776E2200010C27000000204E616D653D224B65795F49445F4D6174222044617461547970653D226674556E6B6E6F776E220000"/>
    <TfrxERQuery Name="ERQuery1" UserName="ERQuery1" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="SELECT    A_ID_Mat.Key_ID_Mat , MAX(A_Nacl.Data_Nacl) AS Data,  dbo.A_FnGetMaxPrice(:Key_ID_Mat) MaxPrice&#13;&#10;  &#13;&#10;FROM         &#13;&#10;       A_ID_Mat&#13;&#10;      LEFT JOIN  A_Nacl_Str&#13;&#10;       ON  A_Nacl_Str.Key_ID_Mat = A_ID_Mat.Key_ID_Mat&#13;&#10;      LEFT JOIN A_Nacl  &#13;&#10;       ON A_Nacl.Key_Nacl = A_Nacl_Str.Key_Nacl&#13;&#10;       AND A_Nacl.Data_Nacl &#60; :MaxDate                                 &#13;&#10;WHERE   A_ID_Mat.Key_ID_Mat=:Key_ID_Mat&#13;&#10;GROUP BY A_ID_Mat.Key_ID_Mat&#13;&#10;&#13;&#10;    " PropData="05704C65667402440470546F700388000A506172616D657465727301010C27000000204E616D653D224B65795F49445F4D6174222044617461547970653D226674556E6B6E6F776E2200010C3F000000204E616D653D224D617844617465222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224D6178446174652E44617465220000"/>
    <TfrxERQuery Name="ERQuery2" UserName="ERQuery2" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;   dbo.Pr_SertSv(A_ID_MAT.Key_Sert_Pos,'000' ,'Документ') Docum&#13;&#10;FROM A_ID_MAT&#13;&#10;WHERE A_ID_MAT.Key_ID_Mat=:Key_ID_Mat                                                           &#13;&#10;     " PropData="05704C65667402480470546F7003E0000A506172616D657465727301010C27000000204E616D653D224B65795F49445F4D6174222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Caption="Параметры" Height="200" ClientHeight="162" Left="394" Top="137" Width="346" ClientWidth="330">
    <TfrxDateEditControl Name="MaxDate" Left="176" Top="28" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="40725" Time="40725" WeekNumbers="False"/>
    <TfrxButtonControl Name="Button1" Left="244" Top="120" Width="75" Height="25" ShowHint="True" Caption="ОК" Default="True" ModalResult="1"/>
    <TfrxLabelControl Name="Label1" Left="12" Top="32" Width="149" Height="16" ShowHint="True" Caption="Последняя операция да:" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="236" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="MainFrxDS" DataSetName="MainDS" PrintIfDetailEmpty="True" RowCount="0" Stretched="True">
      <TfrxMemoView Name="MainDSName_Predm" Left="0" Top="0" Width="226,7718" Height="18,89765" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[FnPredm]"/>
      <TfrxMemoView Name="MainDSOst" Left="718,1107" Top="0" Width="75,5906" Height="18,89765" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.3n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[MainDS.&#34;Ost&#34;] [MainDS.&#34;Name_K_Ed&#34;]"/>
      <TfrxMemoView Name="MainDSN_Sert" Left="226,7718" Top="0" Width="170,07885" Height="18,89765" OnBeforePrint="MainDSN_SertOnBeforePrint" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[MainDS.&#34;VidSert&#34;]  в„– [MainDS.&#34;N_Sert&#34;]  РѕС‚ [MainDS.&#34;Date_Sert&#34;]"/>
      <TfrxMemoView Name="Memo2" Left="944,8825" Top="0" Width="102,04731" Height="18,89765" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[ERQuery1.&#34;Data&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="566,9295" Top="0" Width="151,1812" Height="18,89765" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[MainDS.&#34;Cod_Plavka&#34;] ([MainDS.&#34;Party&#34;])"/>
      <TfrxMemoView Name="Memo6" Left="396,85065" Top="0" Width="170,07885" Height="18,89765" OnBeforePrint="MainDSN_SertOnBeforePrint" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[ERQuery2.&#34;Docum&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="793,7013" Top="0" Width="75,5906" Height="18,89765" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[ERQuery1.&#34;MaxPrice&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="869,2919" Top="0" Width="75,5906" Height="18,89765" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[&#60;MainDS.&#34;Ost&#34;&#62; *  &#60;ERQuery1.&#34;MaxPrice&#34;&#62;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="37,7953" Left="0" Top="180" Width="1046,92981" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo7" Left="0" Top="0" Width="226,7718" Height="37,79527559" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РњР°С‚РµСЂРёР°Р»"/>
      <TfrxMemoView Name="Memo11" Left="718,1107" Top="0" Width="75,5906" Height="37,79527559" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.3n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћСЃС‚Р°С‚РѕРє"/>
      <TfrxMemoView Name="Memo12" Left="226,7718" Top="0" Width="170,07885" Height="37,79527559" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎРµСЂС‚РёС„РёРєР°С‚"/>
      <TfrxMemoView Name="Memo1" Left="944,8825" Top="0" Width="102,04731" Height="37,79527559" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.3n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° РїРѕСЃР»РµРґРЅ. РґРІРёР¶РµРЅРёСЏ"/>
      <TfrxMemoView Name="Memo4" Left="566,9295" Top="0" Width="151,1812" Height="37,79527559" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџР»Р°РІРєР° (РџР°СЂС‚РёСЏ)"/>
      <TfrxMemoView Name="Memo5" Left="396,85065" Top="0" Width="170,07885" Height="37,79527559" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџРѕРґС‚РІРµСЂР¶РґРµРЅРёРµ"/>
      <TfrxMemoView Name="Memo9" Left="793,7013" Top="0" Width="75,5906" Height="37,79527559" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.3n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р¦РµРЅР°&#13;&#10;Р±РµР· РќР”РЎ"/>
      <TfrxMemoView Name="Memo17" Left="869,2919" Top="0" Width="75,5906" Height="37,79527559" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.3n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎСѓРјРјР°&#13;&#10;Р±РµР· РќР”РЎ"/>
    </TfrxHeader>
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="79,37013" Left="0" Top="16" Width="1046,92981">
      <TfrxMemoView Name="Memo13" Left="0" Top="0" Width="718,1107" Height="37,7953" Clipped="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-19" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р’С‹Р±СЂР°РЅРЅС‹Рµ РѕСЃС‚Р°С‚РєРё РЅР° СЃРєР»Р°РґРµ"/>
      <TfrxMemoView Name="Memo14" Left="0" Top="56,69295" Width="381,73253" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text="РџРѕ СЃРѕСЃС‚РѕСЏРЅРёСЋ РЅР° [Now]"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="320" Width="1046,92981">
      <TfrxMemoView Name="Memo15" Left="944,8825" Top="0" Width="102,04731" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Р›РёСЃС‚: [Page]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="116" Width="1046,92981" Condition="MainDS.&#34;F_Name_Sub&#34;" ReprintOnNewPage="True" OutlineText="MainDS.&#34;F_Name_Sub&#34;" StartNewPage="True">
      <TfrxMemoView Name="Memo16" Left="0" Top="0" Width="1046,92944386" Height="22,67718" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[MainDS.&#34;F_Name_Sub&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupHeader Name="GroupHeader2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="0" Left="0" Top="160" Width="1046,92981" Condition="MainDS.&#34;Name_Predm&#34;" OutlineText="MainDS.&#34;Name_Predm&#34;"/>
    <TfrxFooter Name="Footer1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="276" Width="1046,92981">
      <TfrxMemoView Name="Memo18" Left="869,2919" Top="0" Width="75,5906" Height="18,89765" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;MainDS.&#34;Ost&#34;&#62; *  &#60;ERQuery1.&#34;MaxPrice&#34;&#62;)]"/>
    </TfrxFooter>
  </TfrxReportPage>
</TfrxReport>
