<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.5.2" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42956,6475128588" ReportOptions.Description.Text="" ReportOptions.Name="Àâòîìàòè÷åñêèé ïëàí äåòàëèçàöèÿ íà ïåðèîä.fr3 Ñïðàâî÷íèê èçäåëèé" ReportOptions.LastChange="43024,6696195949" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  DateFrom.Date := Date;&#13;&#10;  DateTo.Date := Date;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure SmMemoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  SMMemo.Color:=$00CCFFFF;&#13;&#10;  SmMemo1.Color:=$00CCFFFF;&#13;&#10;  if  (&#13;&#10;       (&#60;Ïëàí.&#34;WorkTime&#34;&#62;*&#60;Ðàáî÷èåÄíè.&#34;Cnt&#34;&#62; - SUM(&#60;Ïëàí.&#34;TZap&#34;&#62;))&#13;&#10;       &#60;&#13;&#10;       ( (&#60;Ïëàí.&#34;WorkTime&#34;&#62;*&#60;Ðàáî÷èåÄíè.&#34;Cnt&#34;&#62;) /20)&#13;&#10;      ) then&#13;&#10;      begin&#13;&#10;        SMMemo.Color:=$008080FF;&#13;&#10;        SmMemo1.Color:=$008080FF;&#13;&#10;      end;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="PlnQRY" DataSetName="Ïëàí"/>
    <item DataSet="WorkDayQRY" DataSetName="Ðàáî÷èåÄíè"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="PlnQRY" UserName="Ïëàí" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="/****** Script for SelectTopNRows command from SSMS  ******/&#13;&#10;SELECT        &#13;&#10;	Pr_Pln_Oper_Res.Key_Pln_Res, &#13;&#10;	Pr_Pln_Res.Name_Pln_Res,&#13;&#10; Pr_Pln_Res.WorkTime,          &#13;&#10;	Pr_Pln_Oper_Res.TZap, &#13;&#10;	T_Oper.Name_K_Oper, &#13;&#10;	P_VKZ_Zap.Key_Pasport, &#13;&#10;	Pr_Pasp.Cod_Pasp,&#13;&#10;	T_VPredm.Cod_Predm, &#13;&#10;	T_VPredm.Name_Predm, &#13;&#10;	S_Subjects.Name_Sub,&#13;&#10;&#13;&#10; Izdel.Cod_Zak,                       &#13;&#10; T_VPredm_Izdel.Name_Predm Name_Predm_Izdel,  &#13;&#10; T_VPredm_Izdel.Cod_Predm Cod_Predm_Izdel,&#13;&#10; P_VKZ_Oper.*   &#13;&#10;     &#13;&#10;FROM&#13;&#10;  (&#13;&#10;    SELECT&#13;&#10;    Key_Pln_Res, Key_Vkz_Oper, SUM(TZap) TZap&#13;&#10;    FROM&#13;&#10;     Pr_Pln_Oper_Res&#13;&#10;    WHERE DayDate BETWEEN   :DateFrom AND :DateTo&#13;&#10;    GROUP BY&#13;&#10;       Key_Pln_Res, Key_Vkz_Oper    &#13;&#10;  ) Pr_Pln_Oper_Res&#13;&#10;&#13;&#10;	INNER JOIN P_VKZ_Oper &#13;&#10;		ON Pr_Pln_Oper_Res.Key_Vkz_Oper = P_VKZ_Oper.Key_Vkz_Oper &#13;&#10;    &#13;&#10;	INNER JOIN Pr_Pln_Res &#13;&#10;		ON P_VKZ_Oper.Key_Pln_Res = Pr_Pln_Res.Key_Pln_Res&#13;&#10;  &#13;&#10;&#13;&#10;&#13;&#10;	INNER JOIN T_Oper&#13;&#10;		ON P_VKZ_Oper.Cod_Oper = T_Oper.Cod_Oper &#13;&#10;	INNER JOIN P_VKZ_Zap &#13;&#10;		ON P_VKZ_Oper.Key_VKZ_Zap = P_VKZ_Zap.Key_VKZ_Zap&#13;&#10;&#13;&#10; INNER JOIN P_VKZ  Izdel          &#13;&#10;  ON IZDEL.Key_VKZ=  P_VKZ_Zap.Key_VKZ_Izdel&#13;&#10;	INNER JOIN T_VPredm T_VPredm_Izdel          &#13;&#10;		ON T_VPredm_Izdel.Key_Predm = Izdel.Key_Predm&#13;&#10;  &#13;&#10;&#13;&#10;  &#13;&#10;	INNER JOIN T_VPredm &#13;&#10;		ON P_VKZ_Zap.Key_Predm = T_VPredm.Key_Predm&#13;&#10;&#13;&#10;  &#13;&#10;	LEFT JOIN Pr_Pasp &#13;&#10;		ON P_VKZ_Zap.Key_Pasport = Pr_Pasp.Key_Pasport &#13;&#10;	LEFT JOIN S_Subjects &#13;&#10;		ON Pr_Pasp.Key_Sub_Master = S_Subjects.Key_Sub&#13;&#10;WHERE&#13;&#10;  Pr_Pln_Res.Name_Pln_Res like :ResTXT&#13;&#10;  AND ((Pr_Pln_Oper_Res.TZap &#62; 0.005 ) OR ( :HiddeSmallValues = 0 ))                                              &#13;&#10;  AND ( Izdel.Cod_Zak like :Cod_Zak )                 &#13;&#10;ORDER BY &#13;&#10;       Pr_Pln_Oper_Res.Key_Pln_Res, &#13;&#10;       P_VKZ_Oper.Cod_Oper,&#13;&#10;       Cod_Zak,                         &#13;&#10;       Cod_Predm_Izdel,&#13;&#10;       T_VPredm.Cod_Predm,             &#13;&#10;       P_VKZ_Oper.N_Oper_SM                             " PropData="05704C65667402540470546F7002540A506172616D657465727301010C41000000204E616D653D224461746546726F6D222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746546726F6D2E446174652200010C3D000000204E616D653D2244617465546F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D2244617465546F2E446174652200010C3B000000204E616D653D22526573545854222044617461547970653D226674537472696E67222045787072657373696F6E3D225265735458542E546578742200010C53000000204E616D653D224869646465536D616C6C56616C756573222044617461547970653D226674496E7465676572222045787072657373696F6E3D224869646465536D616C6C56616C7565732E436865636B65642200010C3D000000204E616D653D22436F645F5A616B222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F645F5A616B2E54657874220000"/>
    <TfrxERQuery Name="WorkDayQRY" UserName="Ðàáî÷èåÄíè" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT dbo.DtFn_CntWDInP( :DateFrom ,  :DateTo ) Cnt                                                               " PropData="05704C6566740300010470546F7002540A506172616D657465727301010C41000000204E616D653D224461746546726F6D222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746546726F6D2E446174652200010C3D000000204E616D653D2244617465546F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D2244617465546F2E44617465220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="250" ClientHeight="211" Left="353" Top="143" Width="300" ClientWidth="284" OnActivate="DialogPage1OnActivate">
    <TfrxDateEditControl Name="DateFrom" Left="124" Top="20" Width="124" Height="24" ShowHint="True" Color="-16777211" Date="42956" Time="42956" WeekNumbers="False"/>
    <TfrxButtonControl Name="Button1" Left="172" Top="168" Width="75" Height="25" ShowHint="True" Caption="Button1" ModalResult="1"/>
    <TfrxDateEditControl Name="DateTo" Left="124" Top="56" Width="124" Height="24" ShowHint="True" Color="-16777211" Date="42956,9999884259" Time="42956,9999884259" WeekNumbers="False"/>
    <TfrxEditControl Name="ResTXT" Left="124" Top="88" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="%"/>
    <TfrxCheckBoxControl Name="HiddeSmallValues" Left="124" Top="144" Width="117" Height="17" ShowHint="True" Caption="Ñêðûâàòü &#60; 0.005" Color="-16777201"/>
    <TfrxEditControl Name="Cod_Zak" Left="124" Top="112" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="%"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="18,89765" Width="1046,92981"/>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="207,87415" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="PlnQRY" DataSetName="Ïëàí" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo4" Left="453,5436" Top="0" Width="264,5671" Height="18,89765" StretchMode="smMaxHeight" DataSet="PlnQRY" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½.&#34;Cod_Predm&#34;] [ÐŸÐ»Ð°Ð½.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="982,6778" Top="0" Width="64,25201" Height="18,89765" StretchMode="smMaxHeight" DataField="TZap" DataSet="PlnQRY" DataSetName="Ïëàí" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½.&#34;TZap&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="302,3624" Top="0" Width="151,1812" Height="18,89765" StretchMode="smMaxHeight" DataSet="PlnQRY" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½.&#34;Cod_Pasp&#34;]&#13;&#10;[ÐŸÐ»Ð°Ð½.&#34;Name_Sub&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="71,81107" Top="0" Width="230,55133" Height="18,89765" StretchMode="smMaxHeight" DataSet="PlnQRY" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" SuppressRepeated="True" Text="[ÐŸÐ»Ð°Ð½.&#34;Cod_Predm_Izdel&#34;] [ÐŸÐ»Ð°Ð½.&#34;Name_Predm_Izdel&#34;]"/>
      <TfrxMemoView Name="Memo11" Left="774,80365" Top="0" Width="56,69290118" Height="18,89765" StretchMode="smMaxHeight" DataSet="PlnQRY" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½.&#34;N_Oper_SM&#34;]&#13;&#10;([&#60;ÐŸÐ»Ð°Ð½.&#34;TSmSm&#34;&#62;])">
        <Formats>
          <item/>
          <item FormatStr="%2.2n" Kind="fkNumeric"/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo13" Left="831,4966" Top="0" Width="75,5906" Height="18,89765" StretchMode="smMaxHeight" DataSet="PlnQRY" DataSetName="Ïëàí" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½.&#34;DateZap&#34;]&#13;&#10;[ÐŸÐ»Ð°Ð½.&#34;DataZapA&#34;]"/>
      <TfrxMemoView Name="Memo14" Left="907,0872" Top="0" Width="75,59055118" Height="18,89765" StretchMode="smMaxHeight" DataSet="PlnQRY" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½.&#34;DateVip&#34;]&#13;&#10;[ÐŸÐ»Ð°Ð½.&#34;DataVipA&#34;]"/>
      <TfrxMemoView Name="Memo16" Left="718,1107" Top="0" Width="56,69295" Height="18,89765" StretchMode="smMaxHeight" DataSet="PlnQRY" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½.&#34;KolvoIsp&#34;]&#13;&#10;[ÐŸÐ»Ð°Ð½.&#34;TSmenaSm&#34;]">
        <Formats>
          <item FormatStr="%2.0f" Kind="fkNumeric"/>
          <item FormatStr="%2.2f" Kind="fkNumeric"/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo17" Left="0" Top="0" Width="71,81107" Height="18,89765" StretchMode="smMaxHeight" DataField="Cod_Zak" DataSet="PlnQRY" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½.&#34;Cod_Zak&#34;]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="370,39394" Width="1046,92981">
      <TfrxMemoView Name="Memo1" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="45,35436" Left="0" Top="98,26778" Width="1046,92981" Condition="Ïëàí.&#34;Key_Pln_Res&#34;" OutlineText="&#60;Ïëàí.&#34;Name_Pln_Res&#34;&#62;">
      <TfrxMemoView Name="Memo2" Left="0" Top="15,11812" Width="1046,92981" Height="30,23624" DataField="Name_Pln_Res" DataSet="PlnQRY" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[ÐŸÐ»Ð°Ð½.&#34;Name_Pln_Res&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupHeader Name="GroupHeader2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="166,29932" Width="1046,92981" Condition="Ïëàí.&#34;Cod_Oper&#34;" OutlineText="&#60;Ïëàí.&#34;Name_K_Oper&#34;&#62;">
      <TfrxMemoView Name="Memo5" Left="0" Top="0" Width="1046,92981" Height="18,89765" DataField="Name_K_Oper" DataSet="PlnQRY" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="16777180" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½.&#34;Name_K_Oper&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="249,44898" Width="1046,92981" Stretched="True">
      <TfrxMemoView Name="Memo7" Left="982,6778" Top="0" Width="64,25201" Height="18,89765" DataSet="PlnQRY" DataSetName="Ïëàí" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="16777180" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;ÐŸÐ»Ð°Ð½.&#34;TZap&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo9" Left="0" Top="0" Width="982,6778" Height="18,89765" DataSet="PlnQRY" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="16777180" HAlign="haRight" ParentFont="False" Text="Ð˜Ñ‚Ð¾Ð³Ð¾ [ÐŸÐ»Ð°Ð½.&#34;Name_K_Oper&#34;]"/>
    </TfrxGroupFooter>
    <TfrxGroupFooter Name="GroupFooter2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="291,02381" Width="1046,92981">
      <TfrxMemoView Name="SmMemo" Left="982,6778" Top="0" Width="64,25201" Height="18,89765" OnBeforePrint="SmMemoOnBeforePrint" DataSet="PlnQRY" DataSetName="Ïëàí" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="8421631" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;ÐŸÐ»Ð°Ð½.&#34;TZap&#34;&#62;)]"/>
      <TfrxMemoView Name="SmMemo1" Left="0" Top="0" Width="982,6778" Height="18,89765" DataSet="PlnQRY" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haRight" ParentFont="False" Text="Ð˜Ñ‚Ð¾Ð³Ð¾: [ÐŸÐ»Ð°Ð½.&#34;Name_Pln_Res&#34;] ([&#60;ÐŸÐ»Ð°Ð½.&#34;WorkTime&#34;&#62;*&#60;Ð Ð°Ð±Ð¾Ñ‡Ð¸ÐµÐ”Ð½Ð¸.&#34;Cnt&#34;&#62;])"/>
    </TfrxGroupFooter>
  </TfrxReportPage>
</TfrxReport>
