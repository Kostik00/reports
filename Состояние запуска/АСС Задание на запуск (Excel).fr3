<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="6.9.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="ѕо умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42215,0909024074" ReportOptions.Description.Text="" ReportOptions.Name="ј—— «адание на запуск (Excel, ver. 27 - 26).fr3 —осто€ние запуска" ReportOptions.LastChange="44593,6070826157" ScriptLanguage="PascalScript" ScriptText.Text="Uses 'CommonRU.pas';&#13;&#10;&#13;&#10;var&#13;&#10;  iMD1Height: Integer;&#13;&#10;  iMD1Width: Integer;&#13;&#10;  iMD1Thickness: Integer;&#13;&#10;  iFactor: Integer;&#13;&#10;&#13;&#10;  sMD1Height: String;&#13;&#10;  sMD1Width: String;&#13;&#10;  sMD1Thickness: String;&#13;&#10;  sProfile: String;&#13;&#10;&#13;&#10;&#13;&#10;  sTemp: String;&#13;&#10;&#13;&#10;const&#13;&#10;{Old}&#13;&#10;{&#13;&#10;  sString01 = '^\s*(\d+)\s*([\±\-\+]\s*((\d+,\d+)|\d+))?\s*[xх]\s*(\d+)\s*([\±\-\+]\s*((\d+,\d+)|\d+))?(\s*[\,\;\-\Ц\Ч]+(.*))?$';  //  &#34;123±1,5 x 456+2,5 ; dlmcledkvcwefc;edmfc&#34;&#13;&#10;  sString02 = '^\(\s*(\d+)\s*([\±\-\+]\s*((\d+,\d+)|\d+))?\s*[xх]\s*(\d+)\s*([\±\-\+]\s*((\d+,\d+)|\d+))?\s*\)\s*[xх]\s*(\d+)(\s*[\,\;\-\Ц\Ч]+(.*))?$';  //  &#34;(123±1,5 x 456+2,5) x 15; dlmcledkvcwefc;edmfc&#34;&#13;&#10;&#13;&#10;  sString04 = '^\s*(\d+)\s*\(\s*[\-\+]\s*((\d+,\d+)|\d+)\s*\;\s*[\-\+]\s*((\d+,\d+)|(\d+))\s*\)\s*[xх]\s*(\d+)\s*\(\s*[\-\+]\s*((\d+,\d+)|\d+)\s*\;\s*[\-\+]\s*((\d+,\d+)|(\d+))\s*\)(\s*[\,\;\-\Ц\Ч]+(.*))?$';  //  &#34;273(-0,5;+0,7)x145(-1,0;+1,5),; hdcbscjksqnbdj&#34;&#13;&#10;  sString05 = '^\s*(\d+)\s*[\±]\s*((\d+,\d+)|\d+)\s*[xх]\s*(\d+)\s*\(\s*[\-\+]\s*((\d+,\d+)|\d+)\s*\;\s*[\-\+]\s*((\d+,\d+)|(\d+))\s*\)(\s*[\,\;\-\Ц\Ч]+(.*))?$';  //  &#34;273±1,0x145(+1,0;-1,5),; hdcbscjksqnbdj&#34;&#13;&#10;  sString06 = '^\s*(\d+)\s*\(\s*[\-\+]\s*((\d+,\d+)|\d+)\s*\;\s*[\-\+]\s*((\d+,\d+)|(\d+))\s*\)\s*[xх]\s*(\d+)\s*[\±]\s*((\d+,\d+)|\d+)(\s*[\,\;\-\Ц\Ч]+(.*))?$';  //  &#34;145(+1,0;-1,5)x273±1,0,; hdcbscjksqnbdj&#34;&#13;&#10;}&#13;&#10;&#13;&#10;  sString01 = '^\s*(\d+)\s*([\±\-\+]\s*((\d+,\d+)|\d+))?\s*[xх]\s*(\d+)\s*([\±\-\+]\s*((\d+,\d+)|\d+))?([\s*\,\;\-\Ц\Ч]+.*)?$';  //  &#34;123±1,5 x 456+2,5 ; dlmcledkvcwefc;edmfc&#34;&#13;&#10;  sString02 = '^\(\s*(\d+)\s*([\±\-\+]\s*((\d+,\d+)|\d+))?\s*[xх]\s*(\d+)\s*([\±\-\+]\s*((\d+,\d+)|\d+))?\s*\)\s*[xх]\s*(\d+)([\s*\,\;\-\Ц\Ч]+.*)?$';  //  &#34;(123±1,5 x 456+2,5) x 15; dlmcledkvcwefc;edmfc&#34;&#13;&#10;  sString03 = '^\s*\(\s*((\d+)\s*[\+\-\±]\s*(\d+,\d+|\d+))\s*[xх]\s*(\d+)\s*[\+\-\±]\s*(\d+,\d+|\d+)\s*\)\s*[xх]\s*(\d+)\s*\+\s*\(\s*((\d+)\s*[\+\-\±]\s*(\d+,\d+|\d+))\s*[xх]\s*(\d+)\s*[\+\-\±]\s*(\d+,\d+|\d+)\s*\)\s*[xх]\s*(\d+)$';  //  &#34;(457±1,5 x 553+2,5) x 12 + (457±1,5 x 553+2,5) x 15&#34;   &#34;(153 + 1 x 553+2) x 12 + (457±1 x 553+2) x 15&#34;&#13;&#10;  sString04 = '^\s*(\d+)\s*\(\s*[\-\+]\s*((\d+,\d+)|\d+)\s*\;\s*[\-\+]\s*((\d+,\d+)|(\d+))\s*\)\s*[xх]\s*(\d+)\s*\(\s*[\-\+]\s*((\d+,\d+)|\d+)\s*\;\s*[\-\+]\s*((\d+,\d+)|(\d+))\s*\)([\s*\,\;\-\Ц\Ч]+.*)?$';  //  &#34;273(-0,5;+0,7)x145(-1,0;+1,5),; hdcbscjksqnbdj&#34;&#13;&#10;  sString05 = '^\s*(\d+)\s*[\±]\s*((\d+,\d+)|\d+)\s*[xх]\s*(\d+)\s*\(\s*[\-\+]\s*((\d+,\d+)|\d+)\s*\;\s*[\-\+]\s*((\d+,\d+)|(\d+))\s*\)([\s*\,\;\-\Ц\Ч]+.*)?$';  //  &#34;273±1,0x145(+1,0;-1,5),; hdcbscjksqnbdj&#34;&#13;&#10;  sString06 = '^\s*(\d+)\s*\(\s*[\-\+]\s*((\d+,\d+)|\d+)\s*\;\s*[\-\+]\s*((\d+,\d+)|(\d+))\s*\)\s*[xх]\s*(\d+)\s*[\±]\s*((\d+,\d+)|\d+)([\s*\,\;\-\Ц\Ч]+.*)?$';  //  &#34;145(+1,0;-1,5)x273±1,0,; hdcbscjksqnbdj&#34;&#13;&#10;&#13;&#10;procedure DialogPage1OnDeactivate(Sender: TfrxComponent);&#13;&#10;var i: Integer = 1;&#13;&#10;  procedure InsertIntoProd(AProfilePostFix: String = '');&#13;&#10;  begin&#13;&#10;    qInsertPROD.ParamByName('iNum').Value:=i;  //  номер строки результата&#13;&#10;    qInsertPROD.ParamByName('Height').Value:=iMD1Height;&#13;&#10;    qInsertPROD.ParamByName('Width').Value:=iMD1Width;&#13;&#10;    qInsertPROD.ParamByName('Thickness').Value:=iMD1Thickness;&#13;&#10;    qInsertPROD.ParamByName('sProfile').Value:=sProfile+AProfilePostFix;&#13;&#10;    qInsertPROD.ParamByName('Quantity').Value:=SumQRY.FieldByName('Kolvo').AsInteger;&#13;&#10;    qInsertPROD.ExecSQL;&#13;&#10;  end;&#13;&#10;  function MsgFindRegExprMatch(ARegExpr: String; AStr: String; AI: Integer; ACodePos: Integer): String;&#13;&#10;  begin&#13;&#10;    try&#13;&#10;      Result:=FindRegExprMatch(ARegExpr, AStr, AI);&#13;&#10;    except&#13;&#10;      ShowMessage(&#13;&#10;        'CodePos: '+IntToStr(ACodePos)+#10+&#13;&#10;        'ExceptionClassName: '+ExceptionClassName+#10+&#13;&#10;        'ExceptionMessage: '  +ExceptionMessage+#10+&#13;&#10;        sTemp);&#13;&#10;      {&#13;&#10;      if MessageDlg(&#13;&#10;        'CodePos: '+IntToStr(ACodePos)+#10+&#13;&#10;        'ExceptionClassName: '+ExceptionClassName+#10+&#13;&#10;        'ExceptionMessage: '  +ExceptionMessage+#10+&#13;&#10;        sTemp, mtError, [mbOk, mbCancel], 0) in [mrCancel]&#13;&#10;        then Exit&#13;&#10;        else Break;&#13;&#10;      }&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;begin&#13;&#10;  if DialogPage1.ModalResult = mrOk&#13;&#10;    then begin&#13;&#10;      Header1.Visible:=cbHeaders.Checked;&#13;&#10;      qCreatePROD.ExecSQL;&#13;&#10;      SumQRY.Open;&#13;&#10;      SumQRY.First;&#13;&#10;      while not SumQRY.Eof&#13;&#10;        do begin&#13;&#10;          SetParamsPROD;&#13;&#10;&#13;&#10;&#13;&#10;          if (Trim(MsgFindRegExprMatch(sString03, sTemp, 0, 1)) &#60;&#62; '') //  and (sTemp &#60;&#62; '')&#13;&#10;            then begin&#13;&#10;              iMD1Height:=StrToInt(MsgFindRegExprMatch(sString03, sTemp,  2, 2));&#13;&#10;              iMD1Width:= StrToInt(MsgFindRegExprMatch(sString03, sTemp,  4, 3));&#13;&#10;              iFactor:=   StrToInt(MsgFindRegExprMatch(sString03, sTemp,  6, 4));&#13;&#10;              InsertIntoProd('_1 часть');&#13;&#10;              Inc(i);&#13;&#10;              iMD1Height:=StrToInt(MsgFindRegExprMatch(sString03, sTemp,  8, 5));&#13;&#10;              iMD1Width:= StrToInt(MsgFindRegExprMatch(sString03, sTemp, 10, 6));&#13;&#10;              iFactor:=   StrToInt(MsgFindRegExprMatch(sString03, sTemp, 12, 7));&#13;&#10;              InsertIntoProd('_2 часть');&#13;&#10;              Inc(i);&#13;&#10;              SumQRY.Next;&#13;&#10;              Continue // ≈сли совпало, то перейти к следующей записи и итерации&#13;&#10;            end;&#13;&#10;&#13;&#10;&#13;&#10;          if Trim(MsgFindRegExprMatch(sString02, sTemp, 0, 8)) &#60;&#62; ''&#13;&#10;            then begin&#13;&#10;              iMD1Height:=StrToInt(MsgFindRegExprMatch(sString02, sTemp,  1, 9));&#13;&#10;              iMD1Width:= StrToInt(MsgFindRegExprMatch(sString02, sTemp,  5, 10));&#13;&#10;              iFactor:=   StrToInt(MsgFindRegExprMatch(sString02, sTemp,  9, 11));&#13;&#10;              InsertIntoProd;&#13;&#10;              Inc(i);&#13;&#10;              SumQRY.Next;&#13;&#10;              Continue // ≈сли совпало, то перейти к следующей записи и итерации&#13;&#10;            end;&#13;&#10;&#13;&#10;          if Trim(MsgFindRegExprMatch(sString01, sTemp, 0, 12)) &#60;&#62; ''&#13;&#10;            then begin&#13;&#10;              iMD1Height:=StrToInt(MsgFindRegExprMatch(sString01, sTemp,  1, 13));&#13;&#10;              iMD1Width:= StrToInt(MsgFindRegExprMatch(sString01, sTemp,  5, 14));&#13;&#10;              iFactor:=   1;&#13;&#10;              InsertIntoProd;&#13;&#10;              Inc(i);&#13;&#10;              SumQRY.Next;&#13;&#10;              Continue // ≈сли совпало, то перейти к следующей записи и итерации&#13;&#10;            end;&#13;&#10;&#13;&#10;          if Trim(MsgFindRegExprMatch(sString04, sTemp, 0, 15)) &#60;&#62; ''&#13;&#10;            then begin&#13;&#10;              iMD1Height:=StrToInt(IIF(Trim(MsgFindRegExprMatch(sString04, sTemp,  1, 16)) = '', 0, MsgFindRegExprMatch(sString04, sTemp,  1, 16)));&#13;&#10;              iMD1Width:= StrToInt(IIF(Trim(MsgFindRegExprMatch(sString04, sTemp,  7, 17)) = '', 0, MsgFindRegExprMatch(sString04, sTemp,  7, 17)));&#13;&#10;              iFactor:=   1;&#13;&#10;              InsertIntoProd;&#13;&#10;              Inc(i);&#13;&#10;              SumQRY.Next;&#13;&#10;              Continue // ≈сли совпало, то перейти к следующей записи и итерации&#13;&#10;            end;&#13;&#10;          if Trim(MsgFindRegExprMatch(sString05, sTemp, 0, 18)) &#60;&#62; ''&#13;&#10;            then begin&#13;&#10;              iMD1Height:=StrToInt(MsgFindRegExprMatch(sString05, sTemp,  1, 19));&#13;&#10;              iMD1Width:= StrToInt(MsgFindRegExprMatch(sString05, sTemp,  4, 20));&#13;&#10;              iFactor:=   1;&#13;&#10;              InsertIntoProd;&#13;&#10;              Inc(i);&#13;&#10;              SumQRY.Next;&#13;&#10;              Continue // ≈сли совпало, то перейти к следующей записи и итерации&#13;&#10;            end;&#13;&#10;          if Trim(MsgFindRegExprMatch(sString06, sTemp, 0, 21)) &#60;&#62; ''&#13;&#10;            then begin&#13;&#10;              iMD1Height:=StrToInt(MsgFindRegExprMatch(sString06, sTemp,  1, 21));&#13;&#10;              iMD1Width:= StrToInt(MsgFindRegExprMatch(sString06, sTemp,  7, 22));&#13;&#10;              iFactor:=   1;&#13;&#10;              InsertIntoProd;&#13;&#10;              Inc(i);&#13;&#10;              SumQRY.Next;&#13;&#10;              Continue // ≈сли совпало, то перейти к следующей записи и итерации&#13;&#10;            end;&#13;&#10;          iMD1Height:=0;&#13;&#10;          iMD1Width:= 0;&#13;&#10;          iFactor:=   1;&#13;&#10;          InsertIntoProd('_профиль ?');&#13;&#10;          Inc(i);&#13;&#10;          SumQRY.Next; // ≈сли нет совпадений, то перейти к следующей записи и итерации&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure  SetParamsPROD;&#13;&#10;begin&#13;&#10;&#13;&#10;  iMD1Height:=0;&#13;&#10;  iMD1Width:=0;&#13;&#10;  iMD1Thickness:=0;&#13;&#10;  iFactor:=1;&#13;&#10;&#13;&#10;  sTemp:=Trim(SumQRY.FieldByName('Prof_Razm').AsString);&#13;&#10;  sTemp:=StringReplace(sTemp, 'х', 'x', 1);&#13;&#10;  sTemp:=StringReplace(sTemp, '’', 'x', 1);&#13;&#10;  sTemp:=StringReplace(sTemp, '.', ',', 1);&#13;&#10;  sTemp:=StringReplace(sTemp, '*', 'x', 3);&#13;&#10;&#13;&#10;  if FindRegExpr('\d+$', Trim(SumQRY.FieldByName('Sortam_Mat').AsString)) = ''&#13;&#10;    then iMD1Thickness:=0&#13;&#10;    else iMD1Thickness:=StrToInt(FindRegExpr('\d+$', Trim(SumQRY.FieldByName('Sortam_Mat').AsString)));&#13;&#10;&#13;&#10;  if ((&#60;dsSum.&#34;EdNorm&#34;&#62; &#62; 1) or (&#60;dsSum.&#34;KolZag&#34;&#62; &#62; 1))&#13;&#10;    then begin&#13;&#10;      if Trim(FindRegExpr('^.*(\(.*[0-9]\s*заг\.\s+на\s+[0-9]+\s*дет\.\s*\)).*$', Trim(&#60;dsSum.&#34;Prof_Razm&#34;&#62;))) = ''&#13;&#10;        then sProfile:=Trim(&#60;dsSum.&#34;Prof_Razm&#34;&#62;)+' ('+IntToStr(&#60;dsSum.&#34;KolZag&#34;&#62;)+' заг. на '+IntToStr(&#60;dsSum.&#34;EdNorm&#34;&#62;)+' дет.)'&#13;&#10;        else sProfile:=Trim(&#60;dsSum.&#34;Prof_Razm&#34;&#62;);&#13;&#10;    end&#13;&#10;    else sProfile:=Trim(&#60;dsSum.&#34;Prof_Razm&#34;&#62;);&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure SetFontSize(Sender: TfrxMemoView);&#13;&#10;begin&#13;&#10;  if TfrxComponent(Sender).ClassName = 'TfrxMemoView'&#13;&#10;    then while TfrxMemoView(Sender).CalcWidth &#62; TfrxMemoView(Sender).Width do TfrxMemoView(Sender).Font.Size:= TfrxMemoView(Sender).Font.Size-1;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo22OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  SetFontSize(TfrxMemoView(Sender));&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo23OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  SetFontSize(TfrxMemoView(Sender));&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;  iMD1Height:=0;&#13;&#10;  iMD1Width:=0;&#13;&#10;  iMD1Thickness:=0;&#13;&#10;  iFactor:=1;&#13;&#10;&#13;&#10;  sMD1Height:='';&#13;&#10;  sMD1Width:='';&#13;&#10;  sMD1Thickness:='';&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="MainFrxDS" DataSetName="MainDS"/>
    <item DataSet="SumQRY" DataSetName="dsSum"/>
    <item DataSet="qCreatePROD" DataSetName="dsCreatePROD"/>
    <item DataSet="qInsertPROD" DataSetName="dsInsertPROD"/>
    <item DataSet="qSelectPROD" DataSetName="dsSelectPROD"/>
    <item DataSet="qBKInsertPROD" DataSetName="dsBKInsertPROD"/>
  </Datasets>
  <TfrxDataPage Name="Data" HGuides.Text="" VGuides.Text="" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="SumQRY" UserName="dsSum" CloseDataSource="False" FieldAliases.Text="Key_GrZap=Key_GrZap&#13;&#10;DateGrZap=DateGrZap&#13;&#10;Cod_Predm=Cod_Predm&#13;&#10;Name_Predm=Name_Predm&#13;&#10;Sortam_Mat=Sortam_Mat&#13;&#10;Marka_Mat=Marka_Mat&#13;&#10;Kolvo=Kolvo&#13;&#10;Prof_Razm=Prof_Razm&#13;&#10;KolZag=KolZag&#13;&#10;EdNorm=EdNorm" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;    P_VKZ.Key_GrZap                 AS  Key_GrZap,&#13;&#10;    P_VKZ_GrZap.DateGrZap           AS  DateGrZap,          &#13;&#10;    T_VPredm.Cod_Predm              AS  Cod_Predm,&#13;&#10;    T_VPredm.Name_Predm             AS  Name_Predm,&#13;&#10;    T_Predm_Mat.Sortam              AS  Sortam_Mat,&#13;&#10;    T_Predm_Mat.Marka               AS  Marka_Mat,&#13;&#10;    SUM(P_VKZ.Kolvo)                AS  Kolvo,          &#13;&#10;    ISNULL(T_SPRows.Prof_Razm, '')  AS  Prof_Razm,&#13;&#10;    ISNULL(T_SPRows.KolZag, 0)      AS KolZag,&#13;&#10;    ISNULL(T_SPRows.EdNorm, 0)      AS EdNorm              &#13;&#10;  FROM&#13;&#10;    P_VKZ&#13;&#10;      INNER JOIN D_Zakaz&#13;&#10;              ON D_Zakaz.Cod_Zak = P_VKZ.Cod_Zak&#13;&#10;      INNER JOIN T_VPredm&#13;&#10;              ON P_VKZ.Key_Predm = T_VPredm.Key_Predm&#13;&#10;      INNER JOIN P_VKZ AS P_VKZ_Izdel&#13;&#10;              ON P_VKZ.Key_VKZ_Izdel = P_VKZ_Izdel.Key_VKZ&#13;&#10;      LEFT  JOIN P_VKZ_GrZap&#13;&#10;              ON P_VKZ.Key_GrZap = P_VKZ_GrZap.Key_GrZap  &#13;&#10;      INNER JOIN T_VPredm AS T_VPredm_Izdel&#13;&#10;              ON P_VKZ_Izdel.Key_Predm = T_VPredm_Izdel.Key_Predm&#13;&#10;      LEFT  JOIN P_VKZ AS P_VKZ_SB&#13;&#10;              ON P_VKZ.Key_VKZ_Master = P_VKZ_SB.Key_VKZ&#13;&#10;      LEFT  JOIN T_VPredm AS T_VPredm_SB&#13;&#10;              ON P_VKZ_SB.Key_Predm = T_VPredm_SB.Key_Predm&#13;&#10;      LEFT  JOIN T_SP&#13;&#10;              ON T_SP.Key_Predm = T_VPredm.Key_Predm&#13;&#10;             AND T_SP.Sp_Version = T_VPredm.Sp_Version&#13;&#10;      LEFT  JOIN T_SPRows&#13;&#10;              ON T_SPRows.Key_SP = T_SP.Key_SP&#13;&#10;             AND T_SPRows.SP_position = 0&#13;&#10;      LEFT  JOIN T_VPredm T_Predm_Mat&#13;&#10;              ON T_Predm_Mat.Key_Predm = T_SPRows.Key_Predm&#13;&#10;  WHERE&#13;&#10;    P_VKZ.Key_GrZap = :Key_GrZap&#13;&#10;  GROUP BY      &#13;&#10;    P_VKZ.Key_GrZap,&#13;&#10;    P_VKZ_GrZap.DateGrZap,        &#13;&#10;    T_VPredm.Cod_Predm,&#13;&#10;    T_VPredm.Name_Predm,&#13;&#10;    T_Predm_Mat.Sortam,&#13;&#10;    T_Predm_Mat.Marka,      &#13;&#10;    T_SPRows.Prof_Razm,&#13;&#10;    KolZag,&#13;&#10;    EdNorm        &#13;&#10;  ORDER BY  &#13;&#10;    T_VPredm.Cod_Predm,&#13;&#10;    T_VPredm.Name_Predm;    " PropData="05704C65667402300470546F7002300A506172616D657465727301010C58000000204E616D653D224B65795F47725A6170222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4D61696E44532E262333343B4B65795F47725A6170262333343B262336323B220000"/>
    <TfrxERQuery Name="qCreatePROD" UserName="dsCreatePROD" CloseDataSource="False" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="IF object_id('tempdb..#PRODUCTION') IS NOT NULL DROP TABLE #PRODUCTION;&#13;&#10;&#13;&#10;CREATE TABLE #PRODUCTION(&#13;&#10;iNum       Int          NOT NULL,&#13;&#10;Cod_Predm  varchar(255) NOT NULL,&#13;&#10;Name_Predm varchar(255),&#13;&#10;Marka_Mat  varchar(255),&#13;&#10;Sortam_Mat varchar(255),&#13;&#10;sProfile   varchar(255),&#13;&#10;Thickness  Int          NOT NULL,&#13;&#10;Height     Int          NOT NULL,&#13;&#10;Width      Int          NOT NULL,&#13;&#10;Quantity   Int          NOT NULL);  " PropData="05704C6566740394000470546F7002300A506172616D65746572730100"/>
    <TfrxERQuery Name="qInsertPROD" UserName="dsInsertPROD" CloseDataSource="False" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="INSERT INTO #PRODUCTION(&#13;&#10;    iNum,&#13;&#10;    Cod_Predm,&#13;&#10;    Name_Predm,&#13;&#10;    Marka_Mat,&#13;&#10;    Sortam_Mat,&#13;&#10;    sProfile,&#13;&#10;    Thickness,&#13;&#10;    Height,&#13;&#10;    Width,&#13;&#10;    Quantity)&#13;&#10;VALUES (&#13;&#10;    :iNum,&#13;&#10;    :Cod_Predm,&#13;&#10;    :Name_Predm,&#13;&#10;    :Marka_Mat,&#13;&#10;    :Sortam_Mat,&#13;&#10;    :sProfile,&#13;&#10;    :Thickness,&#13;&#10;    :Height,&#13;&#10;    :Width,&#13;&#10;    :Quantity);    " PropData="05704C65667403FC000470546F7002300A506172616D657465727301010C21000000204E616D653D22694E756D222044617461547970653D226674496E74656765722200010C56000000204E616D653D22436F645F507265646D222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B647353756D2E262333343B436F645F507265646D262333343B262336323B2200010C58000000204E616D653D224E616D655F507265646D222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B647353756D2E262333343B4E616D655F507265646D262333343B262336323B2200010C56000000204E616D653D224D61726B615F4D6174222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B647353756D2E262333343B4D61726B615F4D6174262333343B262336323B2200010C58000000204E616D653D22536F7274616D5F4D6174222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B647353756D2E262333343B536F7274616D5F4D6174262333343B262336323B2200010C24000000204E616D653D227350726F66696C65222044617461547970653D226674537472696E672200010C26000000204E616D653D22546869636B6E657373222044617461547970653D226674496E74656765722200010C23000000204E616D653D22486569676874222044617461547970653D226674496E74656765722200010C22000000204E616D653D225769647468222044617461547970653D226674496E74656765722200010C25000000204E616D653D225175616E74697479222044617461547970653D226674496E7465676572220000"/>
    <TfrxERQuery Name="qSelectPROD" UserName="dsSelectPROD" CloseDataSource="False" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="&#13;&#10;&#13;&#10;SELECT&#13;&#10;  iNum,&#13;&#10;  Cod_Predm,&#13;&#10;  Name_Predm,&#13;&#10;  Marka_Mat,&#13;&#10;  Sortam_Mat,&#13;&#10;  sProfile,&#13;&#10;  Thickness,&#13;&#10;  Height,&#13;&#10;  Width,&#13;&#10;  Quantity  &#13;&#10;FROM #PRODUCTION&#13;&#10;ORDER BY iNum;      &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;SELECT&#13;&#10;    P_VKZ.Key_GrZap                 AS  Key_GrZap,&#13;&#10;    P_VKZ_GrZap.DateGrZap           AS  DateGrZap,          &#13;&#10;    T_VPredm.Cod_Predm              AS  Cod_Predm,&#13;&#10;    T_VPredm.Name_Predm             AS  Name_Predm,&#13;&#10;    T_Predm_Mat.Sortam              AS  Sortam_Mat,&#13;&#10;    T_Predm_Mat.Marka               AS  Marka_Mat,&#13;&#10;    SUM(P_VKZ.Kolvo)                AS  Kolvo,          &#13;&#10;    ISNULL(T_SPRows.Prof_Razm, '')  AS  Prof_Razm,&#13;&#10;    ISNULL(T_SPRows.KolZag, 0)      AS KolZag,&#13;&#10;    ISNULL(T_SPRows.EdNorm, 0)      AS EdNorm              &#13;&#10;  FROM&#13;&#10;    P_VKZ&#13;&#10;      INNER JOIN D_Zakaz&#13;&#10;              ON D_Zakaz.Cod_Zak = P_VKZ.Cod_Zak&#13;&#10;      INNER JOIN T_VPredm&#13;&#10;              ON P_VKZ.Key_Predm = T_VPredm.Key_Predm&#13;&#10;      INNER JOIN P_VKZ AS P_VKZ_Izdel&#13;&#10;              ON P_VKZ.Key_VKZ_Izdel = P_VKZ_Izdel.Key_VKZ&#13;&#10;      LEFT  JOIN P_VKZ_GrZap&#13;&#10;              ON P_VKZ.Key_GrZap = P_VKZ_GrZap.Key_GrZap  &#13;&#10;      INNER JOIN T_VPredm AS T_VPredm_Izdel&#13;&#10;              ON P_VKZ_Izdel.Key_Predm = T_VPredm_Izdel.Key_Predm&#13;&#10;      LEFT  JOIN P_VKZ AS P_VKZ_SB&#13;&#10;              ON P_VKZ.Key_VKZ_Master = P_VKZ_SB.Key_VKZ&#13;&#10;      LEFT  JOIN T_VPredm AS T_VPredm_SB&#13;&#10;              ON P_VKZ_SB.Key_Predm = T_VPredm_SB.Key_Predm&#13;&#10;      LEFT  JOIN T_SP&#13;&#10;              ON T_SP.Key_Predm = T_VPredm.Key_Predm&#13;&#10;             AND T_SP.Sp_Version = T_VPredm.Sp_Version&#13;&#10;      LEFT  JOIN T_SPRows&#13;&#10;              ON T_SPRows.Key_SP = T_SP.Key_SP&#13;&#10;             AND T_SPRows.SP_position = 0&#13;&#10;      LEFT  JOIN T_VPredm T_Predm_Mat&#13;&#10;              ON T_Predm_Mat.Key_Predm = T_SPRows.Key_Predm&#13;&#10;  WHERE&#13;&#10;    P_VKZ.Key_GrZap = :Key_GrZap&#13;&#10;  GROUP BY      &#13;&#10;    P_VKZ.Key_GrZap,&#13;&#10;    P_VKZ_GrZap.DateGrZap,        &#13;&#10;    T_VPredm.Cod_Predm,&#13;&#10;    T_VPredm.Name_Predm,&#13;&#10;    T_Predm_Mat.Sortam,&#13;&#10;    T_Predm_Mat.Marka,      &#13;&#10;    T_SPRows.Prof_Razm,&#13;&#10;    KolZag,&#13;&#10;    EdNorm        &#13;&#10;  ORDER BY  &#13;&#10;    T_VPredm.Cod_Predm,&#13;&#10;    T_VPredm.Name_Predm;  " PropData="05704C656674035C010470546F7002300A506172616D657465727301010C26000000204E616D653D224B65795F47725A6170222044617461547970653D226674556E6B6E6F776E220000"/>
    <TfrxERQuery Name="qBKInsertPROD" UserName="dsBKInsertPROD" CloseDataSource="False" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="INSERT INTO #PRODUCTION(&#13;&#10;    iNum,&#13;&#10;    Cod_Predm,&#13;&#10;    Name_Predm,&#13;&#10;    Marka_Mat,&#13;&#10;    Sortam_Mat,&#13;&#10;    sProfile,&#13;&#10;    Thickness,&#13;&#10;    Height,&#13;&#10;    Width,&#13;&#10;    Quantity)&#13;&#10;  SELECT&#13;&#10;      ROW_NUMBER() OVER (ORDER BY T_VPredm.Cod_Predm, T_VPredm.Name_Predm),&#13;&#10;      T_VPredm.Cod_Predm,&#13;&#10;      T_VPredm.Name_Predm,&#13;&#10;      T_Predm_Mat.Marka,        &#13;&#10;      T_Predm_Mat.Sortam,&#13;&#10;      ISNULL(T_SPRows.Prof_Razm, ''),                            &#13;&#10;      1,&#13;&#10;      1,&#13;&#10;      1,      &#13;&#10;      P_VKZ.Kolvo              &#13;&#10;    FROM&#13;&#10;      P_VKZ&#13;&#10;        INNER JOIN T_VPredm&#13;&#10;                ON T_VPredm.Key_Predm = P_VKZ.Key_Predm&#13;&#10;        LEFT  JOIN P_VKZ_GrZap&#13;&#10;                ON P_VKZ_GrZap.Key_GrZap = P_VKZ.Key_GrZap  &#13;&#10;        LEFT  JOIN T_SP&#13;&#10;                ON T_SP.Key_Predm = T_VPredm.Key_Predm&#13;&#10;               AND T_SP.Sp_Version = T_VPredm.Sp_Version&#13;&#10;        LEFT  JOIN T_SPRows&#13;&#10;                ON T_SPRows.Key_SP = T_SP.Key_SP&#13;&#10;               AND T_SPRows.SP_position = 0&#13;&#10;        LEFT  JOIN T_VPredm T_Predm_Mat&#13;&#10;                ON T_Predm_Mat.Key_Predm = T_SPRows.Key_Predm&#13;&#10;    WHERE&#13;&#10;      P_VKZ.Key_GrZap = :Key_GrZap        &#13;&#10;    ORDER BY  &#13;&#10;      T_VPredm.Cod_Predm,&#13;&#10;      T_VPredm.Name_Predm;  " PropData="05704C656674039C020470546F7003C4000A506172616D657465727301010C26000000204E616D653D224B65795F47725A6170222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" HGuides.Text="" VGuides.Text="" BorderStyle="bsDialog" DoubleBuffered="False" Height="148" ClientHeight="109" Left="361" Top="138" Width="330" Scaled="True" ClientWidth="314" OnDeactivate="DialogPage1OnDeactivate">
    <TfrxLabelControl Name="lblMain" Anchors="7" Left="8" Top="8" Width="298" Height="23" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Tahoma" Font.Style="1" ParentFont="False" ShowHint="True" Alignment="taCenter" Caption="ј—— задание на запуск (Excel)" Color="-16777201"/>
    <TfrxCheckBoxControl Name="cbHeaders" Left="8" Top="38" Width="141" Height="17" ShowHint="True" Caption="ѕоказывать заголовки" Checked="True" State="cbChecked" Color="-16777201"/>
    <TfrxButtonControl Name="btCancel" Anchors="9" Left="8" Top="78" Width="75" Height="25" ShowHint="True" Caption="ќтмена" ModalResult="2"/>
    <TfrxButtonControl Name="btOk" Anchors="12" Left="231" Top="78" Width="75" Height="25" ShowHint="True" Caption="Ok" ModalResult="1"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" HGuides.Text="" VGuides.Text="" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" Frame.Typ="0" MirrorMode="0">
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="105,82680339" Left="0" Top="136,06308" Width="1046,92981">
      <TfrxMemoView Name="Memo1" AllowVectorExport="True" Left="37,7953" Top="0" Width="264,5671" Height="105,82680339" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="–Ф–°–Х"/>
      <TfrxMemoView Name="Memo19" AllowVectorExport="True" Left="933,54391" Top="0" Width="37,79527559" Height="75,59056339" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="['–Я—А–Њ—Д. —А–∞–Ј–Љ.']"/>
      <TfrxMemoView Name="Memo29" AllowVectorExport="True" Left="1009,13451" Top="0" Width="37,79527559" Height="105,82680339" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="–Ъ–Њ–ї-–≤–Њ"/>
      <TfrxMemoView Name="Memo30" AllowVectorExport="True" Left="396,85065" Top="0" Width="75,59055118" Height="105,82680339" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="–°–Њ—А—В–∞–Љ–µ–љ—В"/>
      <TfrxMemoView Name="Memo31" AllowVectorExport="True" Left="302,3624" Top="0" Width="94,48818898" Height="105,82680339" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="–Ь–∞—А–Ї–∞"/>
      <TfrxMemoView Name="Memo32" AllowVectorExport="True" Left="971,33921" Top="0" Width="37,79527559" Height="75,59056339" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="['–Я—А–Њ—Д. —А–∞–Ј–Љ., —И–Є—А–Є–љ–∞']"/>
      <TfrxMemoView Name="Memo33" AllowVectorExport="True" Left="472,44125" Top="0" Width="423,30725992" Height="105,82680339" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="['–Я—А–Њ—Д. —А–∞–Ј–Љ.,'+#10+'(orig)']"/>
      <TfrxMemoView Name="Memo34" AllowVectorExport="True" Left="895,74861" Top="0" Width="37,79527559" Height="75,59056339" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="['–Ґ–Њ–ї—Й–Є–љ–∞']"/>
      <TfrxMemoView Name="Memo35" AllowVectorExport="True" Left="0" Top="0" Width="37,7953" Height="105,82680339" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="вДЦ"/>
      <TfrxMemoView Name="Memo36" AllowVectorExport="True" Left="895,74861" Top="75,5906" Width="37,79527559" Height="30,23622047" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="['S,'+#10+'–Љ–Љ']"/>
      <TfrxMemoView Name="Memo44" AllowVectorExport="True" Left="933,54391" Top="75,5906" Width="37,79527559" Height="30,23622047" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="['H,'+#10+'–Љ–Љ.']"/>
      <TfrxMemoView Name="Memo45" AllowVectorExport="True" Left="971,33921" Top="75,5906" Width="37,79527559" Height="30,23622047" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="['W,'+#10+'–Љ–Љ.']"/>
    </TfrxHeader>
    <TfrxMasterData Name="mdSelectPROD" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Height="18,89765" Left="0" ParentFont="False" Top="264,5671" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="qSelectPROD" DataSetName="dsSelectPROD" RowCount="0" Stretched="True">
      <TfrxMemoView Name="dsSelectPRODiNum" IndexTag="1" AllowVectorExport="True" Left="0" Top="0" Width="37,7953" Height="18,89765" StretchMode="smMaxHeight" DataSet="qSelectPROD" DataSetName="dsSelectPROD" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[dsSelectPROD.&#34;iNum&#34;]"/>
      <TfrxMemoView Name="Memo21" AllowVectorExport="True" Left="37,7953" Top="0" Width="264,5671" Height="18,89765" StretchMode="smMaxHeight" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="5" ParentFont="False" WordWrap="False" Text="[dsSelectPROD.&#34;Cod_Predm&#34;][' '][dsSelectPROD.&#34;Name_Predm&#34;]">
        <Formats>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo22" AllowVectorExport="True" Left="302,3624" Top="0" Width="94,48818898" Height="18,89765" OnAfterData="Memo22OnAfterData" StretchMode="smMaxHeight" DataSetName="«адание" Frame.Typ="15" GapX="5" HAlign="haCenter" WordWrap="False" Text="[dsSelectPROD.&#34;Marka_Mat&#34;]"/>
      <TfrxMemoView Name="Memo23" AllowVectorExport="True" Left="396,85065" Top="0" Width="75,59055118" Height="18,89765" OnAfterData="Memo23OnAfterData" StretchMode="smMaxHeight" DataSetName="«адание" Frame.Typ="15" GapX="5" HAlign="haCenter" WordWrap="False" Text="[dsSelectPROD.&#34;Sortam_Mat&#34;]"/>
      <TfrxMemoView Name="Memo24" AllowVectorExport="True" Left="895,74861" Top="0" Width="37,79527559" Height="18,89765" StretchMode="smMaxHeight" DataSetName="«адание" DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" GapX="5" HAlign="haRight" WordWrap="False" Text="[dsSelectPROD.&#34;Thickness&#34;]"/>
      <TfrxMemoView Name="Memo25" AllowVectorExport="True" Left="472,44125" Top="0" Width="423,30725992" Height="18,89765" StretchMode="smMaxHeight" DataSetName="«адание" Frame.Typ="15" GapX="5" Text="[dsSelectPROD.&#34;sProfile&#34;]"/>
      <TfrxMemoView Name="Memo26" AllowVectorExport="True" Left="1009,13451" Top="0" Width="37,79527559" Height="18,89765" StretchMode="smMaxHeight" DataSetName="«адание" DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" GapX="5" HAlign="haRight" WordWrap="False" Text="[&#60;dsSelectPROD.&#34;Quantity&#34;&#62;*iFactor]"/>
      <TfrxMemoView Name="Memo27" AllowVectorExport="True" Left="933,54391" Top="0" Width="37,79527559" Height="18,89765" StretchMode="smMaxHeight" DataSetName="«адание" DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" GapX="5" HAlign="haRight" WordWrap="False" Text="[dsSelectPROD.&#34;Height&#34;]"/>
      <TfrxMemoView Name="Memo28" AllowVectorExport="True" Left="971,33921" Top="0" Width="37,79527559" Height="18,89765" StretchMode="smMaxHeight" DataSetName="«адание" DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" GapX="5" HAlign="haRight" WordWrap="False" Text="[dsSelectPROD.&#34;Width&#34;]"/>
    </TfrxMasterData>
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="56,69291339" Left="0" Top="18,89765" Width="1046,92981">
      <TfrxMemoView Name="Memo20" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="37,79527559" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-21" Font.Name="Arial" Font.Style="1" Frame.Typ="0" HAlign="haCenter" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[lblMain.Caption]"/>
      <TfrxMemoView Name="Memo37" AllowVectorExport="True" Left="0" Top="37,7953" Width="1046,92981" Height="18,89765" StretchMode="smMaxHeight" DataSetName="«адание" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="0" GapX="5" ParentFont="False" Text=""/>
    </TfrxReportTitle>
  </TfrxReportPage>
</TfrxReport>
