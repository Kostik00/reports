<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.6.18" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38513,0822621875" ReportOptions.Description.Text="" ReportOptions.Name="Время на работе.fr3 Журнал табельного учета" ReportOptions.LastChange="43634,7053588889" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  PgSize:extended;&#13;&#10;  X:integer;&#13;&#10;&#13;&#10;&#13;&#10;procedure DateFromOnChange(Sender: TfrxComponent);&#13;&#10;var&#13;&#10; Y,M,D:word ;&#13;&#10;begin&#13;&#10;  DecodeDate(DateFrom.Date,Y,M,D);&#13;&#10;//  DateFrom.Date:=EncodeDate(Y,M,1);&#13;&#10;  DateTo.Date:=EncodeDate(Y,M,DaysInMonth(Y,M));&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; Child1.Visible :=PrintDetailInfo.Checked;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  PgSize:=Engine.FreeSpace;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupHeader2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if Engine.FreeSpace &#60; (PgSize/3) then&#13;&#10;    Engine.NewPage;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupHeader3OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  X:=0;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupFooter1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  X:=X+1;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Header1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if Engine.FreeSpace&#60;(Header1.height*3) then  Engine.NewPage;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Dialog1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;function ObedInT(T1,T2:TDateTime) :double;&#13;&#10;var&#13;&#10;  Y1,M1,D1:word;&#13;&#10;  Y2,M2,D2:word;&#13;&#10;&#13;&#10;  Hour1,Min1,Sec1,MSec1:word;&#13;&#10;  Hour2,Min2,Sec2,MSec2:word;&#13;&#10;&#13;&#10;  x:word;&#13;&#10;  DayCnt:Word;&#13;&#10;&#13;&#10;  OStart:TDateTime;&#13;&#10;  OFinish:TDateTime;&#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10;  DecodeDate(T1,Y1,M1,D1);&#13;&#10;  DecodeDate(T2,Y2,M2,D2);&#13;&#10;&#13;&#10;  DecodeTime(T1,Hour1,Min1,Sec1,MSec1);&#13;&#10;  DecodeTime(T2,Hour2,Min2,Sec2,MSec2);&#13;&#10;&#13;&#10;&#13;&#10;  DayCnt:=Round(T2-T1);&#13;&#10;&#13;&#10;  for X:= 0 to DayCnt do&#13;&#10;  begin&#13;&#10;    OStart:=EncodeDate(Y1,M1,D1) + EncodeTime(13,0,0,0) + X;&#13;&#10;    OFinish:=EncodeDate(Y2,M2,D2) + EncodeTime(13,45,0,0) + X;&#13;&#10;&#13;&#10;&#13;&#10;    if OStart &#60; T1  then OStart := T1;&#13;&#10;    if OFinish &#62; T2 then OFinish := T2;&#13;&#10;&#13;&#10;    if OStart &#60; OFinish then   Result:= Result + OFinish-OStart;&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;function FnT:double;&#13;&#10;begin&#13;&#10;&#13;&#10;  Result:=&#60;ERQuery1.&#34;DT_EXIT&#34;&#62; - &#60;ERQuery1.&#34;DT_ENTER&#34;&#62;;&#13;&#10;  Result:=(Result - ObedInT(&#60;ERQuery1.&#34;DT_ENTER&#34;&#62;, &#60;ERQuery1.&#34;DT_EXIT&#34;&#62;))*24;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10; x:=0;&#13;&#10; DateFrom.Date:=Date-1;&#13;&#10; DateTo.Date:=Date;&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="MainFrxDS" DataSetName="MainDS"/>
    <item DataSet="ERQuery1" DataSetName="ERQuery1"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="ERQuery1" UserName="ERQuery1" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="SELECT     &#13;&#10;	S.TABEL_ID, &#13;&#10;	S.DT_ENTER, &#13;&#10;	S.DT_EXIT, &#13;&#10;	CONVERT(float, S.DT_EXIT - S.DT_ENTER) * 24 AS T, &#13;&#10;	SYS_Days.DayDate,&#13;&#10;	SYS_Days.*&#13;&#10;	&#13;&#10;FROM         SKUD_InOut AS S &#13;&#10;		INNER JOIN SYS_Days&#13;&#10;	ON SYS_Days.DayDate = FLOOR(Convert(float,S.DT_ENTER))&#13;&#10;&#13;&#10;  &#13;&#10;WHERE&#13;&#10;    S.TABEL_ID =:Cod_Sub&#13;&#10;    AND S.DT_ENTER &#62;:Date_From&#13;&#10;    AND S.DT_ENTER &#60;=:Date_To                                          &#13;&#10;ORDER BY S.DT_ENTER" SQLSchema="eAGLdkksSXRKLE6N5eUKDvSxNTQwMjc1sbQwNuXlig5JTMpJLQbJ2AZ7h7rEe+b5l5boGJqCkJGBAZAyAKpyL8pMAaoxsA1xdHL1ifd00UFSHKxjqGMAhrZWzvkp8cGlSbxchrYuIfGufiGuQehKIYp5uYzAKiI8Q9AVQMwC2uqTmZcNchoAmSczOw==" PropData="05704C65667402280470546F70023C0A506172616D657465727301010C24000000204E616D653D22436F645F537562222044617461547970653D226674556E6B6E6F776E2200010C42000000204E616D653D22446174655F46726F6D222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746546726F6D2E446174652200010C3E000000204E616D653D22446174655F546F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D2244617465546F2E44617465220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="Dialog1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="266" ClientHeight="227" Left="356" Top="108" Width="369" ClientWidth="353" OnActivate="Dialog1OnActivate">
    <TfrxDateEditControl Name="DateFrom" Left="164" Top="40" Width="137" Height="21" ShowHint="True" Color="-16777211" Date="39845" Time="39845" WeekNumbers="False" OnChange="DateFromOnChange"/>
    <TfrxLabelControl Name="Label1" Left="80" Top="40" Width="41" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Дата:" Color="-16777201"/>
    <TfrxButtonControl Name="Button1" Left="232" Top="172" Width="75" Height="25" ShowHint="True" Caption="ОК" Default="True" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxDateEditControl Name="DateTo" Left="164" Top="80" Width="137" Height="21" ShowHint="True" Color="-16777211" Date="39872,9999884259" Time="39872,9999884259" WeekNumbers="False" OnChange="DateFromOnChange"/>
    <TfrxCheckBoxControl Name="PrintDetailInfo" Left="80" Top="132" Width="221" Height="17" ShowHint="True" Caption="Печатать детальную информацию" Checked="True" State="cbChecked" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="5" RightMargin="5" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="30,23624" Left="0" Top="16" Width="755,906" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="MainFrxDS" DataSetName="MainDS" RowCount="0">
      <TfrxMemoView Name="Memo6" Left="37,7953" Top="0" Width="634,96104" Height="30,23624" Font.Charset="1" Font.Color="-16777208" Font.Height="-19" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="Р”Р°РЅРЅС‹Рµ РЎРљРЈР”"/>
    </TfrxMasterData>
    <TfrxDetailData Name="DetailData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="0" Left="0" Top="168" Width="755,906" Child="Child1" ColumnWidth="0" ColumnGap="0" DataSet="ERQuery1" DataSetName="ERQuery1" RowCount="0"/>
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="37,7953" Left="0" Top="68" Width="755,906" OnBeforePrint="Header1OnBeforePrint" ReprintOnNewPage="True">
      <TfrxMemoView Name="MainDSName_Sub" Left="37,7953" Top="0" Width="634,96104" Height="18,89765" DataField="F_Name_Sub" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[MainDS.&#34;F_Name_Sub&#34;]"/>
      <TfrxMemoView Name="Memo2" Left="196,53556" Top="18,89765" Width="158,74026" Height="18,89765" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="hh:mm" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="Р’С…РѕРґ"/>
      <TfrxMemoView Name="Memo3" Left="355,27582" Top="18,89765" Width="158,74026" Height="18,89765" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="hh:mm" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="Р’С‹С…РѕРґ"/>
      <TfrxMemoView Name="Memo4" Left="514,01608" Top="18,89765" Width="158,74026" Height="18,89765" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="hh:mm" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="Р’СЂРµРјСЏ"/>
      <TfrxMemoView Name="Memo5" Left="37,7953" Top="18,89765" Width="158,74026" Height="18,89765" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="Р”Р°С‚Р°"/>
    </TfrxHeader>
    <TfrxFooter Name="Footer1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="268" Width="755,906">
      <TfrxMemoView Name="Memo7" Left="514,01608" Top="0" Width="158,74026" Height="18,89765" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;ERQuery1.&#34;T&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo9" Left="672,75634" Top="0" Width="83,14966" Height="18,89765" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[SUM(FnT)]"/>
    </TfrxFooter>
    <TfrxGroupHeader Name="GroupHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="124" Visible="False" Width="755,906" Condition="YearOf(&#60;ERQuery1.&#34;DT_ENTER&#34;&#62;)*100+MonthOf(&#60;ERQuery1.&#34;DT_ENTER&#34;&#62;)"/>
    <TfrxGroupFooter Name="GroupFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="228" Width="755,906">
      <TfrxMemoView Name="Memo10" Left="514,01608" Top="0" Width="158,74026" Height="18,89765" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;ERQuery1.&#34;T&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo11" Left="672,75634" Top="0" Width="83,14966" Height="18,89765" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[SUM(FnT)]"/>
      <TfrxMemoView Name="Memo12" Left="37,7953" Top="0" Width="476,22078" Height="18,89765" DisplayFormat.FormatStr=" yyyy mmm " DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[ERQuery1.&#34;DT_ENTER&#34;]"/>
    </TfrxGroupFooter>
    <TfrxChild Name="Child1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="188" Width="755,906">
      <TfrxMemoView Name="ERQuery1DT_ENTER" Left="196,53556" Top="1,38777878078145E-17" Width="158,74026" Height="18,89765" DataField="DT_ENTER" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="hh:mm" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[ERQuery1.&#34;DT_ENTER&#34;]"/>
      <TfrxMemoView Name="ERQuery1DT_EXIT" Left="355,27582" Top="1,38777878078145E-17" Width="158,74026" Height="18,89765" DataField="DT_EXIT" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="hh:mm" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[ERQuery1.&#34;DT_EXIT&#34;]"/>
      <TfrxMemoView Name="ERQuery1T" Left="514,01608" Top="1,38777878078145E-17" Width="158,74026" Height="18,89765" DataField="T" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[ERQuery1.&#34;T&#34;]"/>
      <TfrxMemoView Name="Memo1" Left="37,7953" Top="1,38777878078145E-17" Width="143,62214" Height="18,89765" DataField="DT_ENTER" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="13" ParentFont="False" SuppressRepeated="True" Text="[ERQuery1.&#34;DT_ENTER&#34;]"/>
      <TfrxMemoView Name="ERQuery1WorkFlag" Left="181,41744" Top="1,38777878078145E-17" Width="15,11812" Height="18,89765" DataField="WorkFlag" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="14" ParentFont="False" Text="[ERQuery1.&#34;WorkFlag&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="672,75634" Top="1,38777878078145E-17" Width="83,14966" Height="18,89765" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[FnT]"/>
    </TfrxChild>
  </TfrxReportPage>
</TfrxReport>
