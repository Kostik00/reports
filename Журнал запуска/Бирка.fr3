<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.6.18" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="TSC TA310" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42458,6101259722" ReportOptions.Description.Text="" ReportOptions.Name="Бирка.fr3 Журнал запуска" ReportOptions.LastChange="43959,6534877546" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;function IsAssemblyUnit: Boolean;&#13;&#10;begin&#13;&#10;  Result:=False;&#13;&#10;  if &#60;MainDS.&#34;Name_K_Prin&#34;&#62; = 'СБ'&#13;&#10;    then Result:=True&#13;&#10;    else Result:=False;&#13;&#10;end;&#13;&#10;&#13;&#10;function MyFnCod_Predm0101(InStr:String):string;&#13;&#10;var&#13;&#10;  i:integer;&#13;&#10;  P:integer;&#13;&#10;begin&#13;&#10;  P:=0;&#13;&#10;  Result:=InStr;&#13;&#10;&#13;&#10;  if Length( InStr) &#60; 17 then exit;&#13;&#10;&#13;&#10;  For I:=1 to Length(InStr) do&#13;&#10;  begin&#13;&#10;&#13;&#10;    if InStr[i] in ['0','1','2','3','4','5','6','7','8','9',' '] then&#13;&#10;    begin&#13;&#10;      P:=i;&#13;&#10;      break;&#13;&#10;    end;&#13;&#10;&#13;&#10;  end;&#13;&#10;&#13;&#10;  if P&#62;0 then&#13;&#10;  begin&#13;&#10;    Result:=Copy(InStr,1,P-1) + #13#10+  Copy(InStr,P,Length(InStr));;&#13;&#10;&#13;&#10;  end&#13;&#10;  else&#13;&#10;    Result:='';&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;function MyFnCod_Predm0102(InStr:String):string;&#13;&#10;var&#13;&#10;  i:integer;&#13;&#10;  P:integer;&#13;&#10;begin&#13;&#10;  P:=0;&#13;&#10;  Result:=InStr;&#13;&#10;&#13;&#10;  if Length( InStr) &#60; 17 then exit;&#13;&#10;&#13;&#10;  For I:=1 to Length(InStr) do&#13;&#10;  begin&#13;&#10;&#13;&#10;    if InStr[i] in ['0','1','2','3','4','5','6','7','8','9',' '] then&#13;&#10;    begin&#13;&#10;      P:=i;&#13;&#10;      break;&#13;&#10;    end;&#13;&#10;&#13;&#10;  end;&#13;&#10;&#13;&#10;  if P&#62;0 then&#13;&#10;  begin&#13;&#10;    Result:= Copy(InStr,P,Length(InStr));&#13;&#10;  end&#13;&#10;  else&#13;&#10;    Result:=InStr;&#13;&#10;// Result:=InStr;&#13;&#10;end;&#13;&#10;&#13;&#10;function FnSert:String;&#13;&#10;begin&#13;&#10;  Result:='';&#13;&#10;  if &#60;dsAU.&#34;N_Sert&#34;&#62; &#60;&#62; '' then&#13;&#10;  begin&#13;&#10;    Result:='(Серт.№:'+&#60;dsAU.&#34;N_Sert&#34;&#62;+')' + &#60;dsAU.&#34;RegN_Sert&#34;&#62;;&#13;&#10;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;{ 'Original Text'&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  S1, S2, MaxS: Integer;&#13;&#10;begin&#13;&#10;  MaxS:=36;&#13;&#10;  S1:= Round((CodPredmMEMO.Width / Length(&#60;MainDS.&#34;Cod_Predm&#34;&#62;))*1.2);&#13;&#10;  S2:= Round((Memo2.Width / Length(&#60;MainDS.&#34;Name_Predm&#34;&#62;))*0.8);&#13;&#10;  if S1 &#62; MaxS then S1:=MaxS;&#13;&#10;  if S2 &#62; MaxS then S2:=MaxS;&#13;&#10;  CodPredmMEMO.Font.Size:=Round(S1);&#13;&#10;  Memo2.Font.Size:=Round(S2);&#13;&#10;end;&#13;&#10;}&#13;&#10;&#13;&#10;procedure SetFonts(AMemo1, AMemo2: TfrxMemoView);&#13;&#10;var&#13;&#10;  Size1, Size2, MaxSize: Integer;&#13;&#10;begin&#13;&#10;  MaxSize:=36;&#13;&#10;  Size1:= Round((AMemo1.Width/Length(Trim(&#60;MainDS.&#34;Cod_Predm&#34;&#62;)))*1.2);&#13;&#10;  Size2:= Round((AMemo2.Width/Length(Trim(&#60;MainDS.&#34;Name_Predm&#34;&#62;)))*1.0);&#13;&#10;  if Size1 &#62; MaxSize then Size1:=MaxSize;&#13;&#10;  if Size2 &#62; MaxSize then Size2:=MaxSize;&#13;&#10;  AMemo1.Font.Size:=Size1;&#13;&#10;  AMemo2.Font.Size:=Size2;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  SetFonts(CodPredmMEMO, Memo2);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  SetFonts(Memo5, Memo4);&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;if IsAssemblyUnit&#13;&#10;  then begin&#13;&#10;    pgAssemblyUnit.Visible:=True;&#13;&#10;    pgDetail.Visible:=False&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    pgAssemblyUnit.Visible:=False;&#13;&#10;    pgDetail.Visible:=True&#13;&#10;  end;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="MainFrxDS" DataSetName="MainDS"/>
    <item DataSet="qAU" DataSetName="dsAU"/>
    <item DataSet="qDet" DataSetName="dsDet"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="qAU" UserName="dsAU" CloseDataSource="False" FieldAliases.Text="Key_Pasport=Key_Pasport&#13;&#10;Cod_Predm=Cod_Predm&#13;&#10;Name_Predm=Name_Predm&#13;&#10;Sortam=Sortam&#13;&#10;Type_NTD_Sortam=Type_NTD_Sortam&#13;&#10;Name_NTD_Sortam=Name_NTD_Sortam&#13;&#10;Marka=Marka&#13;&#10;Type_NTD_Marka=Type_NTD_Marka&#13;&#10;Name_NTD_Marka=Name_NTD_Marka&#13;&#10;PrintFlag=PrintFlag&#13;&#10;VidSert=VidSert&#13;&#10;N_Sert=N_Sert&#13;&#10;Date_Sert=Date_Sert&#13;&#10;Cod_Plavka=Cod_Plavka&#13;&#10;Party=Party&#13;&#10;RegN_Sert=RegN_Sert&#13;&#10;RegN=RegN" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="SELECT DISTINCT&#13;&#10;    Pr_Pasp.Key_Pasport,  &#13;&#10;    T_VPredm.Cod_Predm, &#13;&#10;    T_VPredm.Name_Predm, &#13;&#10;    T_VPredm.Sortam, &#13;&#10;    T_VPredm.Type_NTD_Sortam, &#13;&#10;    T_VPredm.Name_NTD_Sortam,  &#13;&#10;    T_VPredm.Marka, &#13;&#10;    T_VPredm.Type_NTD_Marka, &#13;&#10;    T_VPredm.Name_NTD_Marka, &#13;&#10;    T_VPredm.PrintFlag, &#13;&#10;    A_VID_Mat.VidSert, &#13;&#10;    A_VID_Mat.N_Sert, &#13;&#10;    A_VID_Mat.Date_Sert, &#13;&#10;    A_VID_Mat.Cod_Plavka, &#13;&#10;    A_VID_Mat.Party, &#13;&#10;    A_VID_Mat.RegN_Sert, &#13;&#10;    A_VID_Mat.RegN&#13;&#10;  FROM            &#13;&#10;    Pr_Pasp &#13;&#10;      INNER JOIN Pr_SP &#13;&#10;              ON Pr_SP.Key_Pasport = Pr_Pasp.Key_Pasport AND Pr_SP.Key_SP = Pr_Pasp.Key_SP AND&#13;&#10;                 EXISTS (SELECT 1 FROM T_SPRows WHERE T_SPRows.Key_SPRow = Pr_SP.Key_SPRow AND T_SPRows.SP_position &#62;= 0 AND T_SPRows.SP_position &#60;= 1000)&#13;&#10;      INNER JOIN A_VID_Mat &#13;&#10;              ON A_VID_Mat.Key_ID_Mat = Pr_SP.Key_ID_Mat       &#13;&#10;      INNER JOIN T_VPredm &#13;&#10;              ON T_VPredm.Key_Predm = A_VID_Mat.Key_Predm      &#13;&#10;  WHERE &#13;&#10;    Pr_Pasp.Key_Pasport = :Key_Pasport;    " PropData="05704C65667402300470546F7002300A506172616D657465727301010C5C000000204E616D653D224B65795F506173706F7274222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4D61696E44532E262333343B4B65795F506173706F7274262333343B262336323B220000"/>
    <TfrxERQuery Name="qDet" UserName="dsDet" CloseDataSource="False" FieldAliases.Text="Key_Pasport=Key_Pasport&#13;&#10;Cod_Predm=Cod_Predm&#13;&#10;Name_Predm=Name_Predm&#13;&#10;Sortam=Sortam&#13;&#10;Type_NTD_Sortam=Type_NTD_Sortam&#13;&#10;Name_NTD_Sortam=Name_NTD_Sortam&#13;&#10;Marka=Marka&#13;&#10;Type_NTD_Marka=Type_NTD_Marka&#13;&#10;Name_NTD_Marka=Name_NTD_Marka&#13;&#10;PrintFlag=PrintFlag&#13;&#10;VidSert=VidSert&#13;&#10;N_Sert=N_Sert&#13;&#10;Date_Sert=Date_Sert&#13;&#10;Cod_Plavka=Cod_Plavka&#13;&#10;Party=Party&#13;&#10;RegN_Sert=RegN_Sert&#13;&#10;RegN=RegN" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="SELECT DISTINCT&#13;&#10;    Pr_Pasp.Key_Pasport, &#13;&#10;    T_VPredm.Cod_Predm, &#13;&#10;    T_VPredm.Name_Predm, &#13;&#10;    T_VPredm.Sortam, &#13;&#10;    T_VPredm.Type_NTD_Sortam, &#13;&#10;    T_VPredm.Name_NTD_Sortam,&#13;&#10;      &#13;&#10;    T_VPredm.Marka, &#13;&#10;    T_VPredm.Type_NTD_Marka, &#13;&#10;    T_VPredm.Name_NTD_Marka, &#13;&#10;    T_VPredm.PrintFlag, &#13;&#10;    A_VID_Mat.VidSert, &#13;&#10;    A_VID_Mat.N_Sert, &#13;&#10;    A_VID_Mat.Date_Sert, &#13;&#10;    A_VID_Mat.Cod_Plavka, &#13;&#10;    A_VID_Mat.Party, &#13;&#10;    A_VID_Mat.RegN_Sert, &#13;&#10;    A_VID_Mat.RegN&#13;&#10;  FROM            &#13;&#10;    Pr_Pasp &#13;&#10;      INNER JOIN Pr_SP &#13;&#10;              ON Pr_Pasp.Key_Pasport = Pr_SP.Key_Pasport AND Pr_Pasp.Key_SP = Pr_SP.Key_SP &#13;&#10;      INNER JOIN A_VID_Mat &#13;&#10;              ON Pr_SP.Key_ID_Mat = A_VID_Mat.Key_ID_Mat &#13;&#10;      INNER JOIN T_VPredm &#13;&#10;              ON A_VID_Mat.Key_Predm = T_VPredm.Key_Predm&#13;&#10;  WHERE &#13;&#10;    Pr_Pasp.Key_Pasport = :Key_Pasport;        " PropData="05704C65667403C4000470546F7002300A506172616D657465727301010C5C000000204E616D653D224B65795F506173706F7274222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4D61696E44532E262333343B4B65795F506173706F7274262333343B262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="pgAssemblyUnit" PaperWidth="100" PaperHeight="68" PaperSize="256" LeftMargin="2" RightMargin="2" TopMargin="2" BottomMargin="2" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="245,66929134" Left="0" Top="18,89765" Width="362,83488" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" RowCount="1">
      <TfrxMemoView Name="Memo2" Align="baWidth" Left="0" Top="94,48825" Width="362,83488" Height="41,57483" Clipped="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" WordWrap="False" Wysiwyg="False" Text="[MainDS.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="CodPredmMEMO" Left="0" Top="41,57483" Width="362,83488" Height="41,57483" StretchMode="smActualHeight" AllowHTMLTags="True" Clipped="False" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Trim(&#60;MainDS.&#34;Cod_Predm&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo1" Align="baWidth" Left="0" Top="0" Width="362,83488" Height="41,57483" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[MyReadProp('РќР°РёРјРµРЅРѕРІР°РЅРёРµ РѕСЂРіР°РЅРёР·Р°С†РёРё')] Рі. [ MyReadProp('Р“РѕСЂРѕРґ')] [Date]">
        <Formats>
          <item/>
          <item/>
          <item FormatStr="yyyy" Kind="fkDateTime"/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="MainDSCod_Pasp" ShiftMode="smDontShift" Left="113,3859" Top="196,53556" Width="151,1812" Height="15,11812" DataField="Cod_Pasp" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" VAlign="vaBottom" Text="[MainDS.&#34;Cod_Pasp&#34;]"/>
      <TfrxBarCodeView Name="BarCode2" Align="baCenter" ShiftMode="smDontShift" Left="110,41744" Top="219,21274" Width="142" Height="20" BarType="bcCode39" CalcCheckSum="True" Expression="'0 02 '+IntToStr(&#60;MainDS.&#34;Key_Pasport&#34;&#62;)" HAlign="haRight" Rotation="0" ShowText="False" TestLine="False" Text="12345678" WideBarRatio="2" Zoom="1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0"/>
      <TfrxMemoView Name="MainDSSortam_Mat" Align="baWidth" ShiftMode="smDontShift" Left="0" Top="158,74026" Width="362,83488" Height="18,89765" Clipped="False" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[dsAU.&#34;Name_Predm&#34;] [dsAU.&#34;Sortam&#34;] [dsAU.&#34;Marka&#34;] [FnSert]">
        <Formats>
          <item/>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo3" ShiftMode="smDontShift" Left="113,3859" Top="177,63791" Width="151,1812" Height="18,89765" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" VAlign="vaBottom" Text="Р—Р°РєР°Р·: [MainDS.&#34;Cod_Zak&#34;]"/>
      <TfrxMemoView Name="MainDSPaspKolvo" ShiftMode="smDontShift" Left="0" Top="177,63791" Width="113,3859" Height="34,01577" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-24" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[MainDS.&#34;PaspKolvo&#34;] С€С‚."/>
    </TfrxMasterData>
  </TfrxReportPage>
  <TfrxReportPage Name="pgDetail" PaperWidth="100" PaperHeight="68" PaperSize="256" LeftMargin="2" RightMargin="2" TopMargin="2" BottomMargin="2" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="245,66929134" Left="0" Top="18,89765" Width="362,83488" OnBeforePrint="MasterData2OnBeforePrint" ColumnWidth="0" ColumnGap="0" RowCount="1">
      <TfrxMemoView Name="Memo4" Align="baWidth" Left="0" Top="94,48825" Width="362,83488" Height="41,57483" Clipped="False" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[MainDS.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="0" Top="41,57483" Width="362,83488" Height="41,57483" StretchMode="smActualHeight" AllowHTMLTags="True" Clipped="False" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Trim(&#60;MainDS.&#34;Cod_Predm&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo6" Align="baWidth" Left="0" Top="0" Width="362,83488" Height="41,57483" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[MyReadProp('РќР°РёРјРµРЅРѕРІР°РЅРёРµ РѕСЂРіР°РЅРёР·Р°С†РёРё')] Рі. [ MyReadProp('Р“РѕСЂРѕРґ')] [Date]">
        <Formats>
          <item/>
          <item/>
          <item FormatStr="yyyy" Kind="fkDateTime"/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo7" ShiftMode="smDontShift" Left="113,3859" Top="196,53556" Width="151,1812" Height="15,11812" DataField="Cod_Pasp" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" VAlign="vaBottom" Text="[MainDS.&#34;Cod_Pasp&#34;]"/>
      <TfrxBarCodeView Name="BarCode1" Align="baCenter" ShiftMode="smDontShift" Left="110,41744" Top="219,21274" Width="142" Height="20" BarType="bcCode39" CalcCheckSum="True" Expression="'0 02 '+IntToStr(&#60;MainDS.&#34;Key_Pasport&#34;&#62;)" HAlign="haRight" Rotation="0" ShowText="False" TestLine="False" Text="12345678" WideBarRatio="2" Zoom="1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0"/>
      <TfrxMemoView Name="Memo8" Align="baWidth" ShiftMode="smDontShift" Left="0" Top="158,74026" Width="362,83488" Height="18,89765" Clipped="False" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[dsDet.&#34;Name_Predm&#34;] [dsDet.&#34;Sortam&#34;] [dsDet.&#34;Marka&#34;] [FnSert]">
        <Formats>
          <item/>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo9" ShiftMode="smDontShift" Left="113,3859" Top="177,63791" Width="151,1812" Height="18,89765" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" VAlign="vaBottom" Text="Р—Р°РєР°Р·: [MainDS.&#34;Cod_Zak&#34;]"/>
      <TfrxMemoView Name="Memo10" ShiftMode="smDontShift" Left="0" Top="177,63791" Width="113,3859" Height="34,01577" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-24" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[MainDS.&#34;PaspKolvo&#34;][' С€С‚.']">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxMasterData>
  </TfrxReportPage>
</TfrxReport>
