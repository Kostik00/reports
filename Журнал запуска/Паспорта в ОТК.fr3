<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.6.18" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="41702,6873822222" ReportOptions.Description.Text="" ReportOptions.Name="Паспорта в ОТК.fr3 Журнал запуска" ReportOptions.LastChange="43581,5203949537" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;procedure DateZapMemoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if (&#60;Паспорта.&#34;DataZapUtv&#34;&#62; &#60; Date)and(&#60;Паспорта.&#34;DataZapUtv&#34;&#62; &#60;&#62; 0) then&#13;&#10;   DateZapMemo.Color:= $00AEAEFF&#13;&#10;  else&#13;&#10;   DateZapMemo.Color:=clNone;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="Pasp" DataSetName="Паспорта"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="Pasp" UserName="Паспорта" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;  Pr_Pasp.Key_Pasport,&#13;&#10;  Pr_Pasp.Cod_Pasp,&#13;&#10;  Pr_Pasp.Cod_Zak,&#13;&#10;  Pr_Pasp.Date_Sub_Master,&#13;&#10;&#13;&#10;  DTTable.DataZapUtv,        &#13;&#10;&#13;&#10;  Pr_Pasp.Key_Predm,&#13;&#10;  T_Predm.Cod_Predm Cod_Predm,&#13;&#10;  T_Predm.Name_Predm Name_Predm,&#13;&#10;&#13;&#10;  T_Predm_Mat.Name_Predm Name_PredmMat,&#13;&#10;  T_Predm_Mat.Sortam Sortam_Mat,&#13;&#10;  T_Predm_Mat.Marka  Marka_Mat,&#13;&#10;&#13;&#10;  T_Predm.Cod_Prin Cod_Prin,&#13;&#10;  T_Predm.Name_K_Prin Name_K_Prin,&#13;&#10;  Pr_Pasp.Key_Pasp_Status Key_Pasp_Status,&#13;&#10;  Pr_Pasp_Status.Name_Pasp_Status   Name_Pasp_Status,&#13;&#10;&#13;&#10;  Pr_Pasp.N_Oper_SM N_Oper_SM,&#13;&#10;  T_Oper.Name_Oper,&#13;&#10;  Pr_Pasp.PaspKolvo as PaspKolvo,&#13;&#10;  Pr_Pasp.Date_Zap  Date_Zap,&#13;&#10;  Date_Vip  Date_Vip,&#13;&#10;  S_Subjects.Name_Sub  as PaspMaster,&#13;&#10;&#13;&#10;             &#13;&#10;&#13;&#10;  Pr_VPasp_Ev.Name_Sub as PaspUser,&#13;&#10;  Pr_VPasp_Ev.FirstEv,&#13;&#10;  Pr_VPasp_Ev.LastEv&#13;&#10;&#13;&#10;FROM&#13;&#10;  Pr_Pasp  &#13;&#10;&#13;&#10; LEFT JOIN&#13;&#10; (     &#13;&#10;  SELECT     Pr_PaspDet.Key_Pasport, MIN(P_VKZ.DataZapUtv) AS DataZapUtv        &#13;&#10;  FROM         Pr_PaspDet INNER JOIN&#13;&#10;                        P_VKZ ON Pr_PaspDet.Key_VKZ = P_VKZ.Key_VKZ&#13;&#10;  GROUP BY Pr_PaspDet.Key_Pasport&#13;&#10;  ) DTTable&#13;&#10;  ON  DTTable.Key_Pasport = Pr_Pasp.Key_Pasport                               &#13;&#10;&#13;&#10;    &#13;&#10;  LEFT JOIN T_SP&#13;&#10;    ON Pr_Pasp.Key_SP = T_SP.Key_SP&#13;&#10;  LEFT JOIN T_SPRows&#13;&#10;    ON T_SPRows.Key_SP=T_SP.Key_SP&#13;&#10;    AND T_SPRows.SP_position=0&#13;&#10;&#13;&#10;  LEFT JOIN T_VPredm T_Predm_Mat&#13;&#10;    ON  T_Predm_Mat.Key_Predm = T_SPRows.Key_Predm&#13;&#10;&#13;&#10;  INNER JOIN T_VPredm T_Predm&#13;&#10;    ON  Pr_Pasp.Key_Predm = T_Predm.Key_Predm&#13;&#10;&#13;&#10;  INNER JOIN dbo.Pr_Pasp_Status   Pr_Pasp_Status&#13;&#10;    ON  Pr_Pasp.Key_Pasp_Status=Pr_Pasp_Status.Key_Pasp_Status&#13;&#10;&#13;&#10;&#13;&#10;  LEFT JOIN dbo.Pr_Pasp_Rows Pr_Pasp_Rows&#13;&#10;      ON Pr_Pasp_Rows.Key_Pasport=Pr_Pasp.Key_Pasport&#13;&#10;     AND Pr_Pasp_Rows.N_Oper_Sm=Pr_Pasp.N_Oper_Sm&#13;&#10;  LEFT JOIN dbo.T_Oper&#13;&#10;     ON T_Oper.Cod_Oper=Pr_Pasp_Rows.Cod_Oper&#13;&#10;&#13;&#10;  LEFT JOIN S_Subjects&#13;&#10;		ON S_Subjects.Key_Sub = Pr_Pasp.Key_Sub_Master&#13;&#10;&#13;&#10;  LEFT JOIN Pr_VPasp_Ev&#13;&#10;    ON Pr_VPasp_Ev.Key_Pasp_Ev = Pr_Pasp. Key_Pasp_Ev&#13;&#10;  INNER JOIN D_Zakaz&#13;&#10;    ON  D_Zakaz.Cod_Zak =   Pr_Pasp.Cod_Zak&#13;&#10;    AND D_Zakaz.Cod_SosZ = 'Д'&#13;&#10;WHERE&#13;&#10;  Pr_Pasp.Key_Pasp_Status &#60;= 5&#13;&#10;--  AND Pr_Pasp.Key_Pasport not in (&#13;&#10;--               SELECT  DISTINCT   Key_Pasport&#13;&#10;--               FROM         Pr_Pasp_Rows&#13;&#10;--               WHERE     (Status_Oper = 2) AND Cod_Oper not in ('0200','0201', '0105')&#13;&#10;--       )&#13;&#10;  AND&#13;&#10;    Pr_Pasp.Key_Sub_Master IN &#13;&#10;    (SELECT DISTINCT  S_SubVer.Key_Sub  Key_Sub_Master      &#13;&#10;       FROM         S_SubVer INNER JOIN&#13;&#10;                             S_SubAtrib ON S_SubVer.Key_Sub = S_SubAtrib.Key_Sub AND S_SubVer.Sub_Version = S_SubAtrib.Sub_Version&#13;&#10;       WHERE     (S_SubAtrib.Key_Rekv = 17) AND (S_SubAtrib.Val_Key_Sub_Ver = 1447)&#13;&#10;               AND  Isnull(S_SubVer.Fl,0)=0                                                                          &#13;&#10;       )&#13;&#10;&#13;&#10;ORDER BY PaspMaster, DTTable.DataZapUtv, Date_Sub_Master      &#13;&#10; " PropData="05704C656674024C0470546F70021C0A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="16" Width="1046,92981"/>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="140" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="Pasp" DataSetName="Паспорта" RowCount="0">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="147,40167" Height="18,89765" DataField="Cod_Pasp" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Cod_Pasp&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="827,71707" Top="0" Width="109,60637" Height="18,89765" DataSet="Pasp" DataSetName="Паспорта" DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[&#60;РџР°СЃРїРѕСЂС‚Р°.&#34;Date_Sub_Master&#34;&#62; - Date]"/>
      <TfrxMemoView Name="Memo4" Left="748,34694" Top="0" Width="79,37013" Height="18,89765" DataField="Date_Sub_Master" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Date_Sub_Master&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="147,40167" Top="0" Width="177,63791" Height="18,89765" DataField="Name_Predm" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="325,03958" Top="0" Width="207,87415" Height="18,89765" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Cod_Predm&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="532,91373" Top="0" Width="117,16543" Height="18,89765" DataField="Marka_Mat" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Marka_Mat&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="650,07916" Top="0" Width="98,26778" Height="18,89765" DataField="Sortam_Mat" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Sortam_Mat&#34;]"/>
      <TfrxMemoView Name="DateZapMemo" Left="937,32344" Top="0" Width="109,60637" Height="18,89765" OnBeforePrint="DateZapMemoOnBeforePrint" StretchMode="smMaxHeight" DataField="DataZapUtv" DataSet="Pasp" DataSetName="Паспорта" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="11448063" HAlign="haCenter" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;DataZapUtv&#34;]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="180" Width="1046,92981">
      <TfrxMemoView Name="Memo1" Left="971,33921" Top="0" Width="75,5906" Height="18,89765" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="60,47248" Left="0" Top="60" Width="1046,92981" Condition="Паспорта.&#34;PaspMaster&#34;">
      <TfrxMemoView Name="Memo3" Left="0" Top="3,77953" Width="1046,92981" Height="18,89765" DataField="PaspMaster" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="10218495" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;PaspMaster&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="0" Top="22,67718" Width="147,40167" Height="37,7953" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– РџР°СЃРїРѕСЂС‚Р°"/>
      <TfrxMemoView Name="Memo11" Left="827,71707" Top="22,67718" Width="109,60637" Height="37,7953" DataSet="Pasp" DataSetName="Паспорта" DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ РґРЅРµР№"/>
      <TfrxMemoView Name="Memo12" Left="748,34694" Top="22,67718" Width="79,37013" Height="37,7953" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° РїРµСЂРµРґР°С‡Рё"/>
      <TfrxMemoView Name="Memo13" Left="147,40167" Top="22,67718" Width="177,63791" Height="37,7953" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ"/>
      <TfrxMemoView Name="Memo14" Left="325,03958" Top="22,67718" Width="207,87415" Height="37,7953" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћР±РѕР·РЅР°С‡РµРЅРёРµ"/>
      <TfrxMemoView Name="Memo15" Left="532,91373" Top="22,67718" Width="117,16543" Height="37,7953" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РњР°СЂРєР° РјР°С‚РµСЂРёР°Р»Р°"/>
      <TfrxMemoView Name="Memo16" Left="650,07916" Top="22,67718" Width="98,26778" Height="37,7953" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎРѕСЂС‚Р°РјРµРЅС‚"/>
      <TfrxMemoView Name="Memo17" Left="937,32344" Top="22,67718" Width="109,60637" Height="37,7953" OnBeforePrint="DateZapMemoOnBeforePrint" StretchMode="smMaxHeight" DataSet="Pasp" DataSetName="Паспорта" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="11448063" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° Р·Р°РїСѓСЃРєР° РїРѕ РїР»Р°РЅСѓ"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
</TfrxReport>
