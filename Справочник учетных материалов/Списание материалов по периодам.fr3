<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="6.9.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="44419,6981787616" ReportOptions.Description.Text="" ReportOptions.Name="Списание материалов по периодам.fr3 Справочник учетных материалов" ReportOptions.LastChange="44420,3761540394" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="MainFrxDS" DataSetName="MainDS"/>
    <item DataSet="ERQuery1" DataSetName="Period"/>
  </Datasets>
  <TfrxDataPage Name="Data" HGuides.Text="" VGuides.Text="" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="ERQuery1" UserName="Period" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="DECLARE @ReportNum int&#13;&#10;SET @ReportNum = :ReportNum  &#13;&#10;&#13;&#10;DECLARE @Key_Id_Mat int&#13;&#10;SET @Key_Id_Mat = :Key_Id_Mat                              &#13;&#10;&#13;&#10;                       &#13;&#10;  &#13;&#10;&#13;&#10;&#13;&#10;;&#13;&#10;WITH TblPeriod &#13;&#10;AS &#13;&#10;(&#13;&#10;SELECT &#13;&#10;	Usr, ReportNum, N_Str, StrName, DateFrom, DateTo &#13;&#10;FROM Usr_PlnStr&#13;&#10;WHERE&#13;&#10;			Usr_PlnStr.ReportNum = @ReportNum&#13;&#10;		AND Usr_PlnStr.Usr = USER&#13;&#10;) &#13;&#10;&#13;&#10; &#13;&#10;&#13;&#10;SELECT &#13;&#10;	TblPeriod.*,&#13;&#10;	Rashod.SmKolvoRashod,&#13;&#10;	Vozvrat.SmKolvoVozvrat&#13;&#10;FROM &#13;&#10;	TblPeriod TblPeriod&#13;&#10;	LEFT JOIN &#13;&#10;	(&#13;&#10;		SELECT        &#13;&#10;			 TblPeriod.N_Str,&#13;&#10;			 SUM( A_Nacl_Str.KolvoInBaseEd) SmKolvoRashod&#13;&#10;		FROM            &#13;&#10;			TblPeriod TblPeriod&#13;&#10;			INNER JOIN  A_Nacl&#13;&#10;				ON 	A_Nacl.DateAc BETWEEN TblPeriod.DateFrom and TblPeriod.DateTo&#13;&#10;&#13;&#10;			INNER JOIN S_ALL_Sub  SubFrom&#13;&#10;				ON SubFrom.Key_Sub_Ver = A_Nacl.Key_Sub_Ver_From  &#13;&#10;				AND SubFrom.Key_Class = 6&#13;&#10;			INNER JOIN S_ALL_Sub AS SubTo&#13;&#10;				ON SubTo.Key_Sub_Ver = A_Nacl.Key_Sub_Ver_To   &#13;&#10;				AND SubTo.Key_Class = 1&#13;&#10;&#13;&#10;			INNER JOIN A_Nacl_Str &#13;&#10;				ON A_Nacl.Key_Nacl = A_Nacl_Str.Key_Nacl &#13;&#10;&#13;&#10;			INNER JOIN A_ID_Mat &#13;&#10;				ON A_Nacl_Str.Key_ID_Mat = A_ID_Mat.Key_ID_Mat  &#13;&#10;&#13;&#10;			INNER JOIN T_VPredm &#13;&#10;				ON T_VPredm.Key_Predm = A_ID_Mat.Key_Predm &#13;&#10;						 &#13;&#10;		WHERE  &#13;&#10;				T_VPredm.Sklad_Ed_Izm = '166'&#13;&#10;			AND A_Nacl_Str.Key_ID_Mat = @Key_Id_Mat&#13;&#10;                                                                                             &#13;&#10;		GROUP BY TblPeriod.N_Str&#13;&#10;	 ) Rashod&#13;&#10;	 ON Rashod.N_Str = TblPeriod.N_Str&#13;&#10;&#13;&#10;&#13;&#10;	LEFT JOIN &#13;&#10;	(&#13;&#10;		SELECT        &#13;&#10;			 TblPeriod.N_Str,&#13;&#10;			 SUM( A_Nacl_Str.KolvoInBaseEd) SmKolvoVozvrat&#13;&#10;		FROM            &#13;&#10;			TblPeriod TblPeriod&#13;&#10;			INNER JOIN  A_Nacl&#13;&#10;				ON 	A_Nacl.DateAc BETWEEN TblPeriod.DateFrom and TblPeriod.DateTo&#13;&#10;&#13;&#10;			INNER JOIN S_ALL_Sub  SubFrom&#13;&#10;				ON SubFrom.Key_Sub_Ver = A_Nacl.Key_Sub_Ver_From  &#13;&#10;				AND SubFrom.Key_Class = 1&#13;&#10;			INNER JOIN S_ALL_Sub AS SubTo&#13;&#10;				ON SubTo.Key_Sub_Ver = A_Nacl.Key_Sub_Ver_To   &#13;&#10;				AND SubTo.Key_Class = 6&#13;&#10;&#13;&#10;			INNER JOIN A_Nacl_Str &#13;&#10;				ON A_Nacl.Key_Nacl = A_Nacl_Str.Key_Nacl &#13;&#10;&#13;&#10;			INNER JOIN A_ID_Mat &#13;&#10;				ON A_Nacl_Str.Key_ID_Mat = A_ID_Mat.Key_ID_Mat  &#13;&#10;&#13;&#10;			INNER JOIN T_VPredm &#13;&#10;				ON T_VPredm.Key_Predm = A_ID_Mat.Key_Predm &#13;&#10; 						 &#13;&#10;		WHERE  &#13;&#10;			T_VPredm.Sklad_Ed_Izm = '166'&#13;&#10;			AND A_Nacl_Str.Key_ID_Mat = @Key_Id_Mat&#13;&#10;    &#13;&#10;		GROUP BY TblPeriod.N_Str&#13;&#10;	 ) Vozvrat&#13;&#10;	 ON Vozvrat.N_Str = TblPeriod.N_Str&#13;&#10;&#13;&#10;ORDER BY TblPeriod.N_Str  " PropData="05704C6566740384000470546F70026C0A506172616D657465727301010C3D000000204E616D653D225265706F72744E756D222044617461547970653D226674496E7465676572222045787072657373696F6E3D224E756D502E546578742200010C27000000204E616D653D224B65795F49645F4D6174222044617461547970653D226674496E7465676572220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" HGuides.Text="" VGuides.Text="" DoubleBuffered="False" Height="200" ClientHeight="161" Left="425" Top="149" Width="300" Scaled="True" ClientWidth="284">
    <TfrxEditControl Name="NumP" Left="132" Top="24" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="1"/>
    <TfrxButtonControl Name="Button1" Left="180" Top="116" Width="75" Height="25" ShowHint="True" Caption="Button1" ModalResult="1"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" HGuides.Text="" VGuides.Text="" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" Frame.Typ="0" EndlessHeight="True" EndlessWidth="True" MirrorMode="0">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="81,25987791" Left="0" Top="16" Width="1046,92981" Stretched="True">
      <TfrxMemoView Name="PeriodStrName" IndexTag="1" AllowVectorExport="True" Left="266,456865" Top="54,803185" Width="71,81107" Height="26,45669291" StretchMode="smMaxHeight" DataField="StrName" DataSet="ERQuery1" DataSetName="Period" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[Period.&#34;StrName&#34;]"/>
      <TfrxMemoView Name="Memo2" Align="baWidth" AllowVectorExport="True" Left="0" Top="13,228355" Width="1046,92981" Height="18,89765" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="РЎРїРёСЃР°РЅРёРµ РјР°С‚РµСЂРёР°Р»РѕРІ РїРѕ РїРµСЂРёРѕРґР°Рј"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="20" Left="0" Top="116" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="MainFrxDS" DataSetName="MainDS" RowCount="0" Stretched="True">
      <TfrxMemoView Name="MainDSName_Predm" IndexTag="1" AllowVectorExport="True" Left="22,67718" Top="0" Width="211,65368" Height="18,89765" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[MainDS.&#34;Name_Predm&#34;] ([MainDS.&#34;Key_ID_Mat&#34;])&#13;&#10;[MainDS.&#34;Sortam&#34;] [MainDS.&#34;Type_NTD_Sortam&#34;] [MainDS.&#34;Name_NTD_Sortam&#34;]&#13;&#10;[MainDS.&#34;Marka&#34;]Рј[MainDS.&#34;Type_NTD_Marka&#34;] [MainDS.&#34;Name_NTD_Marka&#34;]">
        <Formats>
          <item/>
          <item/>
          <item/>
          <item/>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="PeriodSmKolvoRashod" IndexTag="1" AllowVectorExport="True" Left="266,456865" Top="0" Width="71,81107" Height="18,89765" StretchMode="smMaxHeight" DataSet="ERQuery1" DataSetName="Period" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[&#60;Period.&#34;SmKolvoRashod&#34;&#62;-&#60;Period.&#34;SmKolvoVozvrat&#34;&#62;]">
        <Formats>
          <item FormatStr="%2.2f" Kind="fkNumeric"/>
          <item FormatStr="%2.2f" Kind="fkNumeric"/>
        </Formats>
      </TfrxMemoView>
    </TfrxMasterData>
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="718,1107" Left="22,67718" Top="0" Vertical="True" Width="211,65368"/>
    <TfrxMasterData Name="MasterData2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="718,1107" Left="266,456865" Top="0" Vertical="True" Width="71,81107" ColumnWidth="0" ColumnGap="0" DataSet="ERQuery1" DataSetName="Period" RowCount="0"/>
    <TfrxFooter Name="Footer1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="22,67718" Left="0" Top="156" Width="1046,92981" Stretched="True">
      <TfrxMemoView Name="Memo1" IndexTag="1" AllowVectorExport="True" Left="266,456865" Top="0" Width="71,81107" Height="22,67718" StretchMode="smMaxHeight" DataSet="ERQuery1" DataSetName="Period" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Period.&#34;SmKolvoRashod&#34;&#62;-&#60;Period.&#34;SmKolvoVozvrat&#34;&#62;, MasterData1)]">
        <Formats>
          <item FormatStr="%2.2f" Kind="fkNumeric"/>
          <item FormatStr="%2.2f" Kind="fkNumeric"/>
        </Formats>
      </TfrxMemoView>
    </TfrxFooter>
  </TfrxReportPage>
</TfrxReport>
