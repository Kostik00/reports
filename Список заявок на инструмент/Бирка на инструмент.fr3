<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="6.9.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="TCS TC310" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38513,0822621875" ReportOptions.Description.Text="" ReportOptions.Name="Áèðêà íà èíñòðóìåíò.fr3 Ñïèñîê çàÿâîê íà èíñòðóìåíò" ReportOptions.LastChange="44368,4889789931" ScriptLanguage="PascalScript" ScriptText.Text="USES 'CommonRU.pas';&#13;&#10;&#13;&#10;function PrintSubVerTo: String;&#13;&#10;begin&#13;&#10;  Result:='– None –';&#13;&#10;  case &#60;Ñòðîêè.&#34;Key_Sub_Ver_To&#34;&#62; of&#13;&#10;    3162: Result:='';&#13;&#10;    3163: Result:='Ç';&#13;&#10;    3164: Result:='Í';&#13;&#10;    3851: Result:='ÐÌ';&#13;&#10;    else Result:= &#60;Ñòðîêè.&#34;F_Name_Sub&#34;&#62;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;function FnGodn:string;&#13;&#10;begin&#13;&#10;  Result:='';&#13;&#10;  if &#60;Ñòðîêè.&#34;SrokGodn&#34;&#62; &#60;&#62; 0&#13;&#10;    then Result:= #13#10'Ñðîê ãîäí. '+DateToStr(&#60;Ñòðîêè.&#34;SrokGodn&#34;&#62;);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;function FnCode:string;&#13;&#10;begin&#13;&#10;  if &#60;Ñòðîêè.&#34;Key_Nacl_Str_Sost&#34;&#62; &#60;&#62; 0&#13;&#10;    then Result:='1 8 '+IntToStr(&#60;Ñòðîêè.&#34;Key_Nacl_Str_Sost&#34;&#62;)&#13;&#10;    else Result:='1 7 '+IntToStr(&#60;Ñòðîêè.&#34;Key_Nacl_Str&#34;&#62;);&#13;&#10;&#13;&#10;  Result:= Code39AddCheckCode(Result);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="MainFrxDS" DataSetName="MainDS"/>
    <item DataSet="RetFRXDS" DataSetName="ÑòðÂîçâðàòà"/>
    <item DataSet="NaclStr" DataSetName="Ñòðîêè"/>
  </Datasets>
  <TfrxDataPage Name="Data" HGuides.Text="" VGuides.Text="" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="NaclStr" UserName="Ñòðîêè" CloseDataSource="False" FieldAliases.Text="Key_Nacl_Str=Key_Nacl_Str&#13;&#10;Key_Nacl=Key_Nacl&#13;&#10;Key_ID_Mat=Key_ID_Mat&#13;&#10;Primen=Primen&#13;&#10;Key_Predm=Key_Predm&#13;&#10;PrintFlag=PrintFlag&#13;&#10;Cod_Predm=Cod_Predm&#13;&#10;Name_Predm=Name_Predm&#13;&#10;Sortam=Sortam&#13;&#10;Type_NTD_Sortam=Type_NTD_Sortam&#13;&#10;Name_NTD_Sortam=Name_NTD_Sortam&#13;&#10;Marka=Marka&#13;&#10;Type_NTD_Marka=Type_NTD_Marka&#13;&#10;Name_NTD_Marka=Name_NTD_Marka&#13;&#10;VidSert=VidSert&#13;&#10;N_Sert=N_Sert&#13;&#10;Date_Sert=Date_Sert&#13;&#10;Cod_Plavka=Cod_Plavka&#13;&#10;Party=Party&#13;&#10;SrokGodn=SrokGodn&#13;&#10;RegN_Sert=RegN_Sert&#13;&#10;RegN=RegN&#13;&#10;Kolvo=Kolvo&#13;&#10;Cod_Ed_Izm=Cod_Ed_Izm&#13;&#10;Name_K_Ed=Name_K_Ed&#13;&#10;BaseCodEd=BaseCodEd&#13;&#10;BaseEdizm=BaseEdizm&#13;&#10;KolvoInBaseEd=KolvoInBaseEd&#13;&#10;Price=Price&#13;&#10;PercNds=PercNds&#13;&#10;Sm=Sm&#13;&#10;SmNDS=SmNDS&#13;&#10;SrokKons=SrokKons&#13;&#10;NumStr_By_Docum=NumStr_By_Docum&#13;&#10;Key_Nacl_Str_Sost=Key_Nacl_Str_Sost&#13;&#10;ProfRazm=ProfRazm&#13;&#10;KolvoZag=KolvoZag&#13;&#10;Name_Zagotov=Name_Zagotov&#13;&#10;Name_Sub=Name_Sub&#13;&#10;F_Name_Sub=F_Name_Sub&#13;&#10;Key_Sub_Ver_To=Key_Sub_Ver_To&#13;&#10;Skl=Skl" BCDToCurrency="False" Master="RetFRXDS" IgnoreDupParams="False" SQL.Text="&#13;&#10;SELECT&#13;&#10;    ANaclStr.Key_Nacl_Str,&#13;&#10;    ANaclStr.Key_Nacl,&#13;&#10;    ANaclStr.Key_ID_Mat,&#13;&#10;    &#13;&#10;    dbo.A_FnGetNaclStrRezerv(ANaclStr.Key_Nacl_Str) Primen,                           &#13;&#10;    &#13;&#10;        &#13;&#10;    T_VPredm.Key_Predm,&#13;&#10;    &#13;&#10;    T_VPredm.PrintFlag,&#13;&#10;    T_VPredm.Cod_Predm,                            &#13;&#10;    T_VPredm.Name_Predm,&#13;&#10;    T_VPredm.Sortam,&#13;&#10;    T_VPredm.Type_NTD_Sortam,&#13;&#10;    T_VPredm.Name_NTD_Sortam,&#13;&#10;    T_VPredm.Marka,&#13;&#10;    T_VPredm.Type_NTD_Marka,&#13;&#10;    T_VPredm.Name_NTD_Marka,&#13;&#10;    A_VID_Mat.VidSert,&#13;&#10;    A_VID_Mat.N_Sert,&#13;&#10;    A_VID_Mat.Date_Sert,&#13;&#10;    A_VID_Mat.Cod_Plavka,&#13;&#10;    A_VID_Mat.Party,&#13;&#10;    A_VID_Mat.SrokGodn,&#13;&#10;    &#13;&#10;    A_VID_Mat.RegN_Sert, &#13;&#10;    A_VID_Mat.RegN,&#13;&#10;        &#13;&#10;          &#13;&#10;    ANaclStr.Kolvo,&#13;&#10;    ANaclStr.Cod_Ed_Izm,&#13;&#10;    T_EdIzm.Name_K_Ed,&#13;&#10;    T_VPredm.Cod_Ed_Izm AS BaseCodEd,&#13;&#10;    T_VPredm.Name_K_Ed AS BaseEdizm,&#13;&#10;    ANaclStr.KolvoInBaseEd,&#13;&#10;    ANaclStr.Price,&#13;&#10;    ANaclStr.PercNds,&#13;&#10;    ANaclStr.Sm,&#13;&#10;    ANaclStr.SmNDS,&#13;&#10;    ANaclStr.SrokKons,&#13;&#10;    ANaclStr.NumStr_By_Docum,              &#13;&#10;    A_Nacl_Str_Sost.Key_Nacl_Str_Sost,                                            &#13;&#10;    A_Nacl_Str_Sost.ProfRazm,&#13;&#10;    A_Nacl_Str_Sost.Kolvo KolvoZag,                           &#13;&#10;    T_Zagotov.Name_K_Zagotov   Name_Zagotov,&#13;&#10;	SubVerTo.Name_Sub,&#13;&#10;	SubVerTo.F_Name_Sub,&#13;&#10;	A_Nacl.Key_Sub_Ver_To,&#13;&#10;	dbo.S_GegSubVerAtrib(A_Nacl.Key_Sub_Ver_To, 39) Skl    &#13;&#10;    &#13;&#10;  FROM&#13;&#10;&#13;&#10;	Pr_IZ_Ret &#13;&#10;	INNER JOIN Pr_IZ &#13;&#10;		ON Pr_IZ_Ret.Key_Pr_Iz = Pr_IZ.Key_Pr_IZ &#13;&#10;	INNER JOIN A_Nacl &#13;&#10;		ON Pr_IZ.Key_Pr_IZ = A_Nacl.Key_Pr_IZ &#13;&#10;		AND Pr_IZ_Ret.Key_Sub_Ver_To = A_Nacl.Key_Sub_Ver_To&#13;&#10;&#13;&#10;	INNER JOIN S_ALL_Sub SubVerTo&#13;&#10;		ON SubVerTo.Key_Sub_Ver=A_Nacl.Key_Sub_Ver_To&#13;&#10;&#13;&#10;  &#13;&#10;	INNER JOIN A_Nacl_Str  ANaclStr&#13;&#10;		ON A_Nacl.Key_Nacl = ANaclStr.Key_Nacl &#13;&#10;		AND Pr_IZ_Ret.Key_Nacl_Str = ANaclStr.Key_Nacl_Str_From&#13;&#10;&#13;&#10;&#13;&#10; &#13;&#10;    INNER JOIN A_VID_Mat&#13;&#10;            ON A_VID_Mat.Key_ID_Mat = ANaclStr.Key_ID_Mat&#13;&#10;    INNER JOIN T_VPredmSkl T_VPredm&#13;&#10;            ON T_VPredm.Key_Predm = A_VID_Mat.Key_Predm&#13;&#10;    INNER JOIN T_EdIzm&#13;&#10;            ON T_EdIzm.Cod_Ed_Izm = ANaclStr.Cod_Ed_Izm   &#13;&#10;    LEFT  JOIN A_Nacl_Str_Sost&#13;&#10;            ON A_Nacl_Str_Sost.Key_Nacl_Str = ANaclStr.Key_Nacl_Str&#13;&#10;    LEFT  JOIN T_Zagotov&#13;&#10;            ON T_Zagotov.Cod_Zagotov = A_Nacl_Str_Sost.Cod_Zagotov           &#13;&#10;&#13;&#10;WHERE &#13;&#10;	Pr_IZ_Ret.Key_Pr_Iz = :Key_Pr_Iz  &#13;&#10; 	AND Pr_IZ_Ret.Key_Nacl_Str = :Key_Nacl_Str  &#13;&#10;&#13;&#10;&#13;&#10;  ORDER BY&#13;&#10;    ANaclStr.NumStr_By_Docum;        " PropData="05704C656674023C0470546F7002140A506172616D657465727301010C26000000204E616D653D224B65795F50725F497A222044617461547970653D226674556E6B6E6F776E2200010C29000000204E616D653D224B65795F4E61636C5F537472222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" HGuides.Text="" VGuides.Text="" PaperWidth="43" PaperHeight="25" PaperSize="256" LeftMargin="2" RightMargin="2" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" Frame.Typ="0" LargeDesignHeight="True" MirrorMode="0">
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="94,48824512" Left="0" Top="18,89765" Width="147,40167" OnAfterCalcHeight="MasterData1OnAfterCalcHeight" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="NaclStr" DataSetName="Ñòðîêè" RowCount="0">
      <TfrxMemoView Name="Memo1" AllowVectorExport="True" ShiftMode="smDontShift" Left="0" Top="32,126005" Width="147,40167" Height="41,57480315" StretchMode="smActualHeight" AllowHTMLTags="True" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="[PrintPredm(&#60;Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;PrintFlag&#34;&#62;, &#60;Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;Cod_Predm&#34;&#62;, &#60;Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;Name_Predm&#34;&#62;, &#60;Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;Sortam&#34;&#62;, &#60;Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;Type_NTD_Sortam&#34;&#62;,&#60;Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;Name_NTD_Sortam&#34;&#62;,&#60;Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;Marka&#34;&#62;,&#60;Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;Type_NTD_Marka&#34;&#62;,&#60;Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;Name_NTD_Marka&#34;&#62;)] [IIF(&#60;Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;Party&#34;&#62; = '','',' ÐŸÐ°Ñ€Ñ‚.')][Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;Party&#34;][' â„–Â '][Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;Key_Predm&#34;]/[Ð¡Ñ‚Ñ€Ð¾ÐºÐ¸.&#34;Skl&#34;]">
        <Formats>
          <item/>
          <item/>
          <item/>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxBarcode2DView Name="Barcode2D1" Align="baCenter" AllowVectorExport="True" Left="61,700835" Top="5,669295" Width="24" Height="24" CanShrink="True" StretchMode="smActualHeight" Expression="FnCode" BarType="bcCodeDataMatrix" BarProperties.CodePage="437" BarProperties.PixelSize="2" BarProperties.SymbolSize="AutoSize" BarProperties.Encoding="Auto" BarProperties.GS1Rule="False" Frame.Typ="0" Rotation="0" ShowText="False" HexData="31003200330034003500360037003800" Zoom="1" FontScaled="True" QuietZone="0" ColorBar="0"/>
    </TfrxMasterData>
  </TfrxReportPage>
</TfrxReport>
