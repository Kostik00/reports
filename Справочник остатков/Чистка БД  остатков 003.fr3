<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.13.1" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="41332,60087125" ReportOptions.Description.Text="" ReportOptions.Name="Чистка БД  остатков 003.fr3 Справочник остатков" ReportOptions.LastChange="41344,539101412" ScriptLanguage="PascalScript" ScriptText.Text="Uses 'CommonRU.pas';  &#13;&#10;var MySm:double;                                 &#13;&#10;&#13;&#10;&#13;&#10;  &#13;&#10;  &#13;&#10;function FnPredm:string;&#13;&#10;begin&#13;&#10;  Result:=PrintPredm  (&#60;Приход.&#34;PrintFlag&#34;&#62;,&#60;Приход.&#34;Cod_Predm&#34;&#62;, &#60;Приход.&#34;Name_Predm&#34;&#62;,&#13;&#10;                       &#60;Приход.&#34;Sortam&#34;&#62;, &#60;Приход.&#34;Type_NTD_Sortam&#34;&#62;, &#60;Приход.&#34;Name_NTD_Sortam&#34;&#62;,&#13;&#10;                       &#60;Приход.&#34;Marka&#34;&#62;,  &#60;Приход.&#34;Type_NTD_Marka&#34;&#62;,  &#60;Приход.&#34;Name_NTD_Marka&#34;&#62;);&#13;&#10;   &#13;&#10;//  Result:=Result+'('+VarToStr(&#60;ВСИ.&#34;PrintFlag&#34;&#62;)+')';                                                                         &#13;&#10;&#13;&#10;                            &#13;&#10;end;&#13;&#10;  &#13;&#10;procedure KolvoMemoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  MySm:=MySm+ &#60;Расход.&#34;KolvoInBaseEd&#34;&#62; ;                                   &#13;&#10;   if MySm  &#62; &#60;Приход.&#34;KolvoInBaseEd&#34;&#62; then           &#13;&#10;      KolvoMemo.Color := $008080FF                                         &#13;&#10;   else             &#13;&#10;       KolvoMemo.Color:=clNone;                                          &#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  MySm:=0;                &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403800203546F70022008446174617365747301010C2900000020446174615365743D224D61696E46727844532220446174615365744E616D653D224D61696E44532200010C2900000020446174615365743D22507269686F645152592220446174615365744E616D653D22CFF0E8F5EEE42200010C2900000020446174615365743D22526173686F645152592220446174615365744E616D653D22D0E0F1F5EEE42200010C2600000020446174615365743D225374725152592220446174615365744E616D653D22D1EEF1F2E0E2220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="PrihodQRY" UserName="Приход" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="SELECT     &#13;&#10;       A_Nacl.Num_Nacl, &#13;&#10;       A_Nacl.Data_Nacl, &#13;&#10;       A_Nacl.Osnovanie, &#13;&#10;       A_Nacl.Sost, &#13;&#10;       A_Nacl_Str.Key_ID_Mat, &#13;&#10;       A_Nacl_Str.Key_Nacl_Str, &#13;&#10;       A_Nacl_Str.KolvoInBaseEd,&#13;&#10;       A_Nacl.Key_Sub_Ver_To, &#13;&#10;       T_VPREDMSKL.Cod_Predm,&#13;&#10;       T_VPREDMSKL.Name_Predm, &#13;&#10;       T_VPREDMSKL.Sortam, &#13;&#10;       T_VPREDMSKL.Type_NTD_Sortam,&#13;&#10;       T_VPREDMSKL.Name_NTD_Sortam, &#13;&#10;       T_VPREDMSKL.Marka, &#13;&#10;       T_VPREDMSKL.MarkaPrn, &#13;&#10;       T_VPREDMSKL.Type_NTD_Marka, &#13;&#10;       T_VPREDMSKL.Name_NTD_Marka,&#13;&#10;       T_VPREDMSKL.Name_K_Ed, T_VPREDMSKL.PrintFlag,                           &#13;&#10;		     T1.SM&#13;&#10;FROM         &#13;&#10;       A_Nacl &#13;&#10;       INNER JOIN A_Nacl_Str &#13;&#10;               ON A_Nacl.Key_Nacl = A_Nacl_Str.Key_Nacl &#13;&#10;       INNER JOIN A_VID_Mat &#13;&#10;               ON A_Nacl_Str.Key_ID_Mat = A_VID_Mat.Key_ID_Mat &#13;&#10;       INNER JOIN T_VPREDMSKL &#13;&#10;               ON A_VID_Mat.Key_Predm = T_VPREDMSKL.Key_Predm&#13;&#10;	   INNER  JOIN ( SELECT A_Nacl_Str.Key_Nacl_Str, &#13;&#10;                            A_Nacl_Str.KolvoInBaseEd KolvoInBaseEd, SUM(A_Nacl_Str_1.KolvoInBaseEd) AS SM&#13;&#10;                     FROM   A_Nacl_Str &#13;&#10;							INNER JOIN  A_Nacl_Str AS A_Nacl_Str_1 &#13;&#10;								ON A_Nacl_Str.Key_Nacl_Str = A_Nacl_Str_1.Key_Nacl_Str_From&#13;&#10;                     GROUP BY A_Nacl_Str.Key_Nacl_Str, A_Nacl_Str.KolvoInBaseEd&#13;&#10;                    ) T1 &#13;&#10;		ON A_Nacl_Str.Key_Nacl_Str = T1.Key_Nacl_Str&#13;&#10;&#13;&#10;WHERE  &#13;&#10;        A_Nacl.Key_Sub_Ver_To   in (SELECT     S_SubVer.Key_Sub_Ver&#13;&#10;                                      FROM         S_Subjects INNER JOIN&#13;&#10;                                                            S_SubVer ON S_Subjects.Key_Sub = S_SubVer.Key_Sub&#13;&#10;                                      WHERE     (S_Subjects.Key_Class = 6))  &#13;&#10;&#13;&#10;                               &#13;&#10;		AND (T1.SM- 0.001)  &#62;  A_Nacl_Str.KolvoInBaseEd &#13;&#10;     &#13;&#10;ORDER BY  A_Nacl_Str.Key_Nacl_Str,  A_Nacl.Data_Nacl  " PropData="05704C65667402280470546F7002200A506172616D65746572730100"/>
    <TfrxERQuery Name="RashodQRY" UserName="Расход" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="PrihodQRY" IgnoreDupParams="False" SQL.Text="SELECT     &#13;&#10;       A_Nacl.Num_Nacl, &#13;&#10;       A_Nacl.Data_Nacl, &#13;&#10;       A_Nacl.Osnovanie, &#13;&#10;       A_Nacl.Sost, &#13;&#10;       A_Nacl_Str.Key_ID_Mat, &#13;&#10;       A_Nacl_Str.Key_Nacl_Str, &#13;&#10;       A_Nacl_Str.Sm, &#13;&#10;       A_Nacl_Str.KolvoInBaseEd,&#13;&#10;       A_Nacl.Key_Sub_Ver_To, &#13;&#10;       T_VPREDMSKL.Cod_Predm,&#13;&#10;       T_VPREDMSKL.Name_Predm, &#13;&#10;       T_VPREDMSKL.Sortam, &#13;&#10;       T_VPREDMSKL.Type_NTD_Sortam,&#13;&#10;       T_VPREDMSKL.Name_NTD_Sortam, &#13;&#10;       T_VPREDMSKL.Marka, &#13;&#10;       T_VPREDMSKL.MarkaPrn, &#13;&#10;       T_VPREDMSKL.Type_NTD_Marka, &#13;&#10;       T_VPREDMSKL.Name_NTD_Marka,&#13;&#10;       T_VPREDMSKL.Name_K_Ed&#13;&#10;FROM         &#13;&#10;       A_Nacl &#13;&#10;       INNER JOIN A_Nacl_Str &#13;&#10;               ON A_Nacl.Key_Nacl = A_Nacl_Str.Key_Nacl &#13;&#10;       INNER JOIN A_VID_Mat &#13;&#10;               ON A_Nacl_Str.Key_ID_Mat = A_VID_Mat.Key_ID_Mat &#13;&#10;       INNER JOIN T_VPREDMSKL &#13;&#10;               ON A_VID_Mat.Key_Predm = T_VPREDMSKL.Key_Predm&#13;&#10;WHERE  A_Nacl_Str.Key_Nacl_Str_From = :Key_Nacl_Str                          &#13;&#10;ORDER BY A_Nacl.Data_Nacl  " PropData="05704C65667402280470546F7002740A506172616D657465727301010C29000000204E616D653D224B65795F4E61636C5F537472222044617461547970653D226674556E6B6E6F776E220000"/>
    <TfrxERQuery Name="StrQRY" UserName="Состав" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="PrihodQRY" IgnoreDupParams="False" SQL.Text="SELECT     &#13;&#10;       A_Nacl_Str_Sost.Key_Nacl_Str_Sost, &#13;&#10;       T_Zagotov.Name_Zagotov, &#13;&#10;       A_Nacl_Str_Sost.ProfRazm, &#13;&#10;       A_Nacl_Str_Sost.M_Zag, &#13;&#10;       A_Nacl_Str_Sost.Kolvo,&#13;&#10;                      A_Nacl_Str_Sost.Rashod&#13;&#10;FROM         A_Nacl_Str_Sost INNER JOIN&#13;&#10;                      T_Zagotov ON A_Nacl_Str_Sost.Cod_Zagotov = T_Zagotov.Cod_Zagotov&#13;&#10;WHERE A_Nacl_Str_Sost.Key_Nacl_Str = :Key_Nacl_Str                                                               " PropData="05704C65667402740470546F7002200A506172616D657465727301010C29000000204E616D653D224B65795F4E61636C5F537472222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" Height="22,67718" Left="0" Top="18,89765" Width="1046,92981"/>
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="102,04731" Width="1046,92981" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="PrihodQRY" DataSetName="Приход" PrintChildIfInvisible="True" PrintIfDetailEmpty="True" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo2" Left="75,5906" Top="0" Width="113,3859" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" Color="13296895" DataField="Num_Nacl" DataSet="PrihodQRY" DataSetName="Приход" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџСЂРёС…РѕРґ.&#34;Num_Nacl&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="0" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" Color="13296895" DataField="Data_Nacl" DataSet="PrihodQRY" DataSetName="Приход" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџСЂРёС…РѕРґ.&#34;Data_Nacl&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="188,9765" Top="0" Width="188,9765" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" Color="13296895" DataField="Osnovanie" DataSet="PrihodQRY" DataSetName="Приход" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџСЂРёС…РѕРґ.&#34;Osnovanie&#34;]"/>
      <TfrxMemoView Name="Memo20" Left="793,7013" Top="0" Width="102,04731" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" Color="13296895" DataField="KolvoInBaseEd" DataSet="PrihodQRY" DataSetName="Приход" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[РџСЂРёС…РѕРґ.&#34;KolvoInBaseEd&#34;]"/>
      <TfrxMemoView Name="Memo21" Left="377,953" Top="0" Width="415,7483" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" Color="13296895" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[FnPredm]"/>
      <TfrxMemoView Name="Memo22" Left="895,74861" Top="0" Width="102,04731" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" Color="13296895" DataField="Sm" DataSet="PrihodQRY" DataSetName="Приход" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[РџСЂРёС…РѕРґ.&#34;Sm&#34;]"/>
      <TfrxMemoView Name="Memo23" Left="997,79592" Top="0" Width="49,13389" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" Color="13296895" DataField="Name_K_Ed" DataSet="PrihodQRY" DataSetName="Приход" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[РџСЂРёС…РѕРґ.&#34;Name_K_Ed&#34;]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" Height="22,67718" Left="0" Top="222,99227" Width="1046,92981">
      <TfrxMemoView Name="Memo1" Align="baCenter" Left="485,669605" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxDetailData Name="DetailData1" Height="18,89765" Left="0" Top="143,62214" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="RashodQRY" DataSetName="Расход" PrintIfDetailEmpty="True" RowCount="0">
      <TfrxMemoView Name="Memo7" Left="113,3859" Top="0" Width="151,1812" Height="18,89765" ShowHint="False" DataField="Num_Nacl" DataSet="RashodQRY" DataSetName="Расход" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[Р Р°СЃС…РѕРґ.&#34;Num_Nacl&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="15,11812" Top="0" Width="98,26778" Height="18,89765" ShowHint="False" DataField="Data_Nacl" DataSet="RashodQRY" DataSetName="Расход" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[Р Р°СЃС…РѕРґ.&#34;Data_Nacl&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="264,5671" Top="0" Width="264,5671" Height="18,89765" ShowHint="False" DataField="Osnovanie" DataSet="RashodQRY" DataSetName="Расход" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[Р Р°СЃС…РѕРґ.&#34;Osnovanie&#34;]"/>
      <TfrxMemoView Name="KolvoMemo" Left="529,1342" Top="0" Width="113,3859" Height="18,89765" OnBeforePrint="KolvoMemoOnBeforePrint" ShowHint="False" DataField="KolvoInBaseEd" DataSet="RashodQRY" DataSetName="Расход" DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[Р Р°СЃС…РѕРґ.&#34;KolvoInBaseEd&#34;]"/>
      <TfrxMemoView Name="Memo11" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" DataField="Name_K_Ed" DataSet="RashodQRY" DataSetName="Расход" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[Р Р°СЃС…РѕРґ.&#34;Name_K_Ed&#34;]"/>
    </TfrxDetailData>
  </TfrxReportPage>
</TfrxReport>
