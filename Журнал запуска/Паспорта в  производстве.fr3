<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.15" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="41702,6873822222" ReportOptions.Description.Text="" ReportOptions.Name="Паспорта в  производстве.fr3 Журнал запуска" ReportOptions.LastChange="42307,4541968982" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;procedure DateZapMemoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if (&#60;Паспорта.&#34;DataZapUtv&#34;&#62; &#60; Date)and(&#60;Паспорта.&#34;DataZapUtv&#34;&#62; &#60;&#62; 0) then&#13;&#10;   DateZapMemo.Color:= $00AEAEFF&#13;&#10;  else&#13;&#10;   DateZapMemo.Color:=clNone;&#13;&#10;&#13;&#10;  if (&#60;Паспорта.&#34;DataVipUtv&#34;&#62; &#60; Date)and(&#60;Паспорта.&#34;DataVipUtv&#34;&#62; &#60;&#62; 0) then&#13;&#10;   DateVipMemo.Color:= $00AEAEFF&#13;&#10;  else&#13;&#10;   DateVipMemo.Color:=clNone;       &#13;&#10;end;&#13;&#10;&#13;&#10;procedure EditDayOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403800203546F70022008446174617365747301010C2600000020446174615365743D22506173702220446174615365744E616D653D22CFE0F1EFEEF0F2E0220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="Pasp" UserName="Паспорта" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;  Pr_Pasp.Key_Pasport,&#13;&#10;  Pr_Pasp.Cod_Pasp,&#13;&#10;  Pr_Pasp.Cod_Zak,&#13;&#10;  Pr_Pasp.Date_Sub_Master,&#13;&#10;&#13;&#10;  DTTable.DataZapUtv,        &#13;&#10;  DTTable.DataVipUtv,        &#13;&#10;  &#13;&#10;  Pr_Pasp.Key_Predm,&#13;&#10;  T_Predm.Cod_Predm Cod_Predm,&#13;&#10;  T_Predm.Name_Predm Name_Predm,&#13;&#10;&#13;&#10;  T_Predm_Mat.Name_Predm Name_PredmMat,&#13;&#10;  T_Predm_Mat.Sortam Sortam_Mat,&#13;&#10;  T_Predm_Mat.Marka  Marka_Mat,&#13;&#10;&#13;&#10;  T_Predm.Cod_Prin Cod_Prin,&#13;&#10;  T_Predm.Name_K_Prin Name_K_Prin,&#13;&#10;  Pr_Pasp.Key_Pasp_Status Key_Pasp_Status,&#13;&#10;  Pr_Pasp_Status.Name_Pasp_Status   Name_Pasp_Status,&#13;&#10;&#13;&#10;  Pr_Pasp.N_Oper_SM N_Oper_SM,&#13;&#10;  T_Oper.Name_Oper,&#13;&#10;  T_Oper.Name_K_Oper,&#13;&#10;  Pr_Pasp.PaspKolvo as PaspKolvo,&#13;&#10;  Pr_Pasp.Date_Zap  Date_Zap,&#13;&#10;  Date_Vip  Date_Vip,&#13;&#10;  S_Subjects.Name_Sub  as PaspMaster,&#13;&#10;&#13;&#10;             &#13;&#10;&#13;&#10;  Pr_VPasp_Ev.Name_Sub as PaspUser,&#13;&#10;  Pr_VPasp_Ev.FirstEv,&#13;&#10;  Pr_VPasp_Ev.LastEv&#13;&#10;&#13;&#10;FROM&#13;&#10;  Pr_Pasp&#13;&#10;                                                &#13;&#10;&#13;&#10; LEFT JOIN&#13;&#10; (                                   &#13;&#10;  SELECT     Pr_PaspDet.Key_Pasport, MIN(P_VKZ.DataZapUtv) AS DataZapUtv, MIN(P_VKZ.DataVipUtv) AS DataVipUtv               &#13;&#10;  FROM         Pr_PaspDet INNER JOIN&#13;&#10;                        P_VKZ ON Pr_PaspDet.Key_VKZ = P_VKZ.Key_VKZ&#13;&#10;  GROUP BY Pr_PaspDet.Key_Pasport&#13;&#10;  ) DTTable&#13;&#10;  ON  DTTable.Key_Pasport = Pr_Pasp.Key_Pasport                               &#13;&#10;&#13;&#10;    &#13;&#10;  LEFT JOIN T_SP&#13;&#10;    ON Pr_Pasp.Key_SP = T_SP.Key_SP&#13;&#10;  LEFT JOIN T_SPRows&#13;&#10;    ON T_SPRows.Key_SP=T_SP.Key_SP&#13;&#10;    AND T_SPRows.SP_position=0&#13;&#10;&#13;&#10;  LEFT JOIN T_VPredm T_Predm_Mat&#13;&#10;    ON  T_Predm_Mat.Key_Predm = T_SPRows.Key_Predm&#13;&#10;&#13;&#10;  INNER JOIN T_VPredm T_Predm&#13;&#10;    ON  Pr_Pasp.Key_Predm = T_Predm.Key_Predm&#13;&#10;&#13;&#10;  INNER JOIN dbo.Pr_Pasp_Status   Pr_Pasp_Status&#13;&#10;    ON  Pr_Pasp.Key_Pasp_Status=Pr_Pasp_Status.Key_Pasp_Status&#13;&#10;&#13;&#10;&#13;&#10;  LEFT JOIN dbo.Pr_Pasp_Rows Pr_Pasp_Rows&#13;&#10;      ON Pr_Pasp_Rows.Key_Pasport=Pr_Pasp.Key_Pasport&#13;&#10;     AND Pr_Pasp_Rows.N_Oper_Sm=Pr_Pasp.N_Oper_Sm&#13;&#10;  LEFT JOIN dbo.T_Oper&#13;&#10;     ON T_Oper.Cod_Oper=Pr_Pasp_Rows.Cod_Oper&#13;&#10;&#13;&#10;  LEFT JOIN S_Subjects&#13;&#10;		ON S_Subjects.Key_Sub = Pr_Pasp.Key_Sub_Master&#13;&#10;&#13;&#10;  LEFT JOIN Pr_VPasp_Ev&#13;&#10;    ON Pr_VPasp_Ev.Key_Pasp_Ev = Pr_Pasp. Key_Pasp_Ev&#13;&#10;  INNER JOIN D_Zakaz&#13;&#10;    ON  D_Zakaz.Cod_Zak =   Pr_Pasp.Cod_Zak&#13;&#10;    AND D_Zakaz.Cod_SosZ = 'Д'&#13;&#10;&#13;&#10;INNER JOIN&#13;&#10;(&#13;&#10;SELECT DISTINCT Pr_Pasp.Key_Pasport, vkzizdel.Cod_SosZ&#13;&#10;FROM         Pr_Pasp INNER JOIN&#13;&#10;                      Pr_PaspDet ON Pr_Pasp.Key_Pasport = Pr_PaspDet.Key_Pasport INNER JOIN&#13;&#10;                      P_VKZ ON Pr_PaspDet.Key_VKZ = P_VKZ.Key_VKZ INNER JOIN&#13;&#10;                      P_VKZ AS vkzizdel ON P_VKZ.Key_VKZ_Izdel = vkzizdel.Key_VKZ&#13;&#10;WHERE     (vkzizdel.Cod_SosZ = 'Д')  &#13;&#10;  &#13;&#10;) T001&#13;&#10;ON T001.Key_Pasport = Pr_Pasp.Key_Pasport                                                       &#13;&#10;  &#13;&#10;&#13;&#10;      &#13;&#10;WHERE&#13;&#10;  Pr_Pasp.Key_Pasp_Status between 1 and  5&#13;&#10;--  AND Pr_Pasp.Key_Pasport not in (&#13;&#10;--               SELECT  DISTINCT   Key_Pasport&#13;&#10;--               FROM         Pr_Pasp_Rows&#13;&#10;--               WHERE     (Status_Oper = 2) AND Cod_Oper not in ('0200','0201', '0105')&#13;&#10;--       )&#13;&#10;  AND&#13;&#10;--    Pr_Pasp.Key_Sub_Master IN   ( 1957, 1028, 1835, 1339  )  AND &#13;&#10;    S_Subjects.Name_Sub Like :FIO&#13;&#10;  AND Pr_Pasp.Date_Sub_Master &#60; DateAdd(dd, :DifDay, GetDate())                               &#13;&#10;&#13;&#10;ORDER BY PaspMaster, DTTable.DataZapUtv, Date_Sub_Master      &#13;&#10; " PropData="05704C656674024C0470546F70021C0A506172616D657465727301010C39000000204E616D653D2246494F222044617461547970653D226674537472696E67222045787072657373696F6E3D2246494F2E546578742B2725272200010C3D000000204E616D653D22446966446179222044617461547970653D226674496E7465676572222045787072657373696F6E3D22456469744461792E74657874220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Height="191" ClientHeight="153" Left="263" Top="139" Width="300" ClientWidth="284">
    <TfrxEditControl Name="FIO" Left="148" Top="20" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxButtonControl Name="Button1" Left="196" Top="112" Width="75" Height="25" ShowHint="True" Caption="OK" ModalResult="1"/>
    <TfrxLabelControl Name="Label1" Left="72" Top="24" Width="44" Height="16" ShowHint="True" Caption="Мастер" Color="-16777201"/>
    <TfrxEditControl Name="EditDay" Left="148" Top="68" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="-7" OnClick="EditDayOnClick"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" Height="22,67718" Left="0" Top="16" Width="1046,92981"/>
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="104" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="Pasp" DataSetName="Паспорта" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="147,40167" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="Cod_Pasp" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Cod_Pasp&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="823,93754" Top="0" Width="41,57483" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="Pasp" DataSetName="Паспорта" DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[&#60;РџР°СЃРїРѕСЂС‚Р°.&#34;Date_Sub_Master&#34;&#62; - Date]"/>
      <TfrxMemoView Name="Memo4" Left="597,16574" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="Date_Sub_Master" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Date_Sub_Master&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="147,40167" Top="0" Width="128,50402" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="Name_Predm" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="275,90569" Top="0" Width="128,50402" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Cod_Predm&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="404,40971" Top="0" Width="94,48825" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="Marka_Mat" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Marka_Mat&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="498,89796" Top="0" Width="98,26778" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="Sortam_Mat" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Sortam_Mat&#34;]"/>
      <TfrxMemoView Name="DateZapMemo" Left="865,51237" Top="0" Width="75,5906" Height="18,89765" OnBeforePrint="DateZapMemoOnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Color="11448063" DataField="DataZapUtv" DataSet="Pasp" DataSetName="Паспорта" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;DataZapUtv&#34;]"/>
      <TfrxMemoView Name="DateVipMemo" Left="941,10297" Top="0" Width="75,5906" Height="18,89765" OnBeforePrint="DateZapMemoOnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" DataField="DataVipUtv" DataSet="Pasp" DataSetName="Паспорта" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;DataVipUtv&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="676,53587" Top="0" Width="147,40167" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;N_Oper_SM&#34;]&#13;&#10;[РџР°СЃРїРѕСЂС‚Р°.&#34;Name_K_Oper&#34;]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" Height="22,67718" Left="0" Top="144" Width="1046,92981">
      <TfrxMemoView Name="Memo1" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" Height="22,67718" Left="0" Top="60" Width="1046,92981" Condition="Паспорта.&#34;PaspMaster&#34;" OutlineText="&#60;Паспорта.&#34;PaspMaster&#34;&#62;" StartNewPage="True">
      <TfrxMemoView Name="Memo3" Left="0" Top="3,77953" Width="1016,69357" Height="18,89765" ShowHint="False" Color="10218495" DataField="PaspMaster" DataSet="Pasp" DataSetName="Паспорта" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;PaspMaster&#34;]"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
</TfrxReport>
