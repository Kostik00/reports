<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.7.192" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38513,0822621875" ReportOptions.Description.Text="" ReportOptions.Name="Остатки для бухгалтерии.fr3 Список накладных" ReportOptions.LastChange="40146,852556956" ScriptLanguage="PascalScript" ScriptText.Text="Uses 'CommonRU.pas';  &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;  &#13;&#10;function FnPredm:string;&#13;&#10;begin&#13;&#10;  Result:=PrintPredm  (&#60;Остаток.&#34;PrintFlag&#34;&#62;,&#60;Остаток.&#34;Cod_Predm&#34;&#62;,       &#60;Остаток.&#34;Name_Predm&#34;&#62;,&#13;&#10;                       &#60;Остаток.&#34;Sortam&#34;&#62;,   &#60;Остаток.&#34;Type_NTD_Sortam&#34;&#62;, &#60;Остаток.&#34;Name_NTD_Sortam&#34;&#62;,&#13;&#10;                       &#60;Остаток.&#34;Marka&#34;&#62;,    &#60;Остаток.&#34;Type_NTD_Marka&#34;&#62;,  &#60;Остаток.&#34;Name_NTD_Marka&#34;&#62;);&#13;&#10;//  Result:=Result+'('+VarToStr(&#60;ВСИ.&#34;PrintFlag&#34;&#62;)+')';                                                                         &#13;&#10;                         &#13;&#10;end;  &#13;&#10;&#13;&#10;procedure Label1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  Key_Sprav:integer;&#13;&#10;  SpravName, Caption, Ad_Filter, Cod_Sprav, Values:string;&#13;&#10;  R, Multisel:boolean;                            &#13;&#10;begin&#13;&#10;  //Выбор склада из справочника субъектов                                                                              &#13;&#10;  SpravName:='Справочник субъектов';  &#13;&#10;  Caption:='Выбор склада';&#13;&#10;  Ad_Filter:='Key_Class=6';&#13;&#10;  Multisel:=False;                      &#13;&#10;&#13;&#10;  Key_Sprav:=0;&#13;&#10;  Cod_Sprav:='';&#13;&#10;  Values:='';&#13;&#10;  R:=SelectFromSprav(SpravName ,Caption, Ad_Filter , Key_Sprav, Cod_Sprav, Values, Multisel);              &#13;&#10;  if R then&#13;&#10;  begin&#13;&#10;    Key_SubVer.Text:= IntToStr(Key_Sprav);&#13;&#10;    Name_Sub.Text:= GetValueFromValues(Values,'F_Name_Sub','');                                                                                      &#13;&#10;  end&#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Key_SubVerOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403800203546F70022008446174617365747301010C2900000020446174615365743D224D61696E46727844532220446174615365744E616D653D224D61696E44532200010C2700000020446174615365743D224F73745152592220446174615365744E616D653D22CEF1F2E0F2EEEA220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="OstQRY" UserName="Остаток" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="Declare @Key_Sub_Ver int &#13;&#10;&#13;&#10;SET @Key_Sub_Ver = :Key_SubVer                         &#13;&#10;&#13;&#10;&#13;&#10;SELECT     &#13;&#10; T_VPREDMSKL.Key_Predm,&#13;&#10; T_VPREDMSKL.Cod_Predm, &#13;&#10; T_VPREDMSKL.Name_Predm, &#13;&#10; T_VPREDMSKL.Sortam, &#13;&#10; T_VPREDMSKL.OrderSortam,  &#13;&#10; T_VPREDMSKL.Type_NTD_Sortam, &#13;&#10; T_VPREDMSKL.Name_NTD_Sortam, &#13;&#10; T_VPREDMSKL.Marka, &#13;&#10; T_VPREDMSKL.Type_NTD_Marka, &#13;&#10; T_VPREDMSKL.Name_NTD_Marka, &#13;&#10; T_VPREDMSKL.Name_K_Ed, &#13;&#10; T_VPREDMSKL.Sklad_Ed_Izm, &#13;&#10; T_VPREDMSKL.PrintFlag, &#13;&#10; SUM(     A_Nacl_Str.KolvoInBaseEd * dbo.A_PlusZero(A_Nacl.Key_Sub_Ver_To, @Key_Sub_Ver) &#13;&#10;        - A_Nacl_Str.KolvoInBaseEd * dbo.A_PlusZero(A_Nacl.Key_Sub_Ver_From, @Key_Sub_Ver)) AS Kolvo  &#13;&#10;FROM         &#13;&#10; A_Nacl &#13;&#10; INNER JOIN A_Nacl_Str ON A_Nacl.Key_Nacl = A_Nacl_Str.Key_Nacl &#13;&#10; INNER JOIN A_VID_Mat ON A_Nacl_Str.Key_ID_Mat = A_VID_Mat.Key_ID_Mat &#13;&#10; INNER JOIN T_VPREDMSKL ON A_VID_Mat.Key_Predm = T_VPREDMSKL.Key_Predm&#13;&#10;WHERE     &#13;&#10;    (A_Nacl.Data_Nacl &#60;= :DateTo)&#13;&#10; AND &#13;&#10; (A_Nacl.Key_Sub_Ver_To   = @Key_Sub_Ver &#13;&#10;   OR &#13;&#10;  A_Nacl.Key_Sub_Ver_From = @Key_Sub_Ver&#13;&#10;  )&#13;&#10; AND A_Nacl.Sost=4&#13;&#10;&#13;&#10;GROUP BY &#13;&#10; T_VPREDMSKL.Key_Predm,&#13;&#10; T_VPREDMSKL.Cod_Predm, &#13;&#10; T_VPREDMSKL.Name_Predm, &#13;&#10; T_VPREDMSKL.Sortam, &#13;&#10; T_VPREDMSKL.OrderSortam,  &#13;&#10; T_VPREDMSKL.Type_NTD_Sortam, &#13;&#10; T_VPREDMSKL.Name_NTD_Sortam, &#13;&#10; T_VPREDMSKL.Marka, &#13;&#10; T_VPREDMSKL.Type_NTD_Marka, &#13;&#10; T_VPREDMSKL.Name_NTD_Marka, &#13;&#10; T_VPREDMSKL.Name_K_Ed, &#13;&#10; T_VPREDMSKL.Sklad_Ed_Izm, &#13;&#10; T_VPREDMSKL.PrintFlag&#13;&#10;HAVING&#13;&#10;  SUM(     A_Nacl_Str.KolvoInBaseEd * dbo.A_PlusZero(A_Nacl.Key_Sub_Ver_To, @Key_Sub_Ver) &#13;&#10;        - A_Nacl_Str.KolvoInBaseEd * dbo.A_PlusZero(A_Nacl.Key_Sub_Ver_From, @Key_Sub_Ver)) &#62;0&#13;&#10;&#13;&#10;ORDER BY &#13;&#10; T_VPREDMSKL.Name_Predm, &#13;&#10; T_VPREDMSKL.OrderSortam  &#13;&#10;  " PropData="05704C65667402500470546F7002400A506172616D657465727301010C44000000204E616D653D224B65795F537562566572222044617461547970653D226674496E7465676572222045787072657373696F6E3D224B65795F5375625665722E546578742200010C3D000000204E616D653D2244617465546F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D2244617465546F2E44617465220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Caption="Параметры отчета" ClientHeight="192" Left="432" Top="234" ClientWidth="404">
    <TfrxButtonControl Name="OkButton" Description="Сформировать отчет" Left="320" Top="156" Width="75" Height="25" ShowHint="True" Caption="OK" ModalResult="1"/>
    <TfrxEditControl Name="Key_SubVer" Left="16" Top="48" Width="49" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="0" OnClick="Key_SubVerOnClick"/>
    <TfrxDateEditControl Name="DateTo" Left="72" Top="88" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="40146,9999884259" Time="40146,9999884259"/>
    <TfrxLabelControl Name="Label1" Left="16" Top="16" Width="37" Height="16" ShowHint="True" Caption="Склад" Color="-16777201" OnClick="Label1OnClick"/>
    <TfrxLabelControl Name="Label2" Left="16" Top="92" Width="28" Height="16" ShowHint="True" Caption="Дата" Color="-16777201"/>
    <TfrxEditControl Name="Name_Sub" Left="68" Top="12" Width="329" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True"/>
    <TfrxButtonControl Name="Button1" Left="72" Top="48" Width="327" Height="25" ShowHint="True" Caption="Выбрать склад" OnClick="Button1OnClick"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="156" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="OstQRY" DataSetName="Остаток" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo1" Left="113,3859" Top="0" Width="415,7483" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="OstQRY" DataSetName="Остаток" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[FnPredm]"/>
      <TfrxMemoView Name="Memo2" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="OstQRY" DataSetName="Остаток" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[РћСЃС‚Р°С‚РѕРє.&#34;Name_K_Ed&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="529,1342" Top="0" Width="113,3859" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="Kolvo" DataSet="OstQRY" DataSetName="Остаток" DisplayFormat.FormatStr="%2.4n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[РћСЃС‚Р°С‚РѕРє.&#34;Kolvo&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="37,7953" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="Key_Predm" DataSet="OstQRY" DataSetName="Остаток" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[РћСЃС‚Р°С‚РѕРє.&#34;Key_Predm&#34;]"/>
      <TfrxMemoView Name="Memo11" Left="0" Top="0" Width="37,7953" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="OstQRY" DataSetName="Остаток" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[Line]"/>
    </TfrxMasterData>
    <TfrxReportTitle Name="ReportTitle1" Height="75,5906" Left="0" Top="16" Width="718,1107">
      <TfrxMemoView Name="Memo5" Left="0" Top="7,55906" Width="718,1107" Height="52,91342" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-19" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="РћСЃС‚Р°С‚РєРё РЅР° СЃРєР»Р°РґРµ: [Name_Sub.Text]&#13;&#10;РџРѕ СЃРѕСЃС‚РѕСЏРЅРёСЋ РЅР°: [DateTo.Date #ddd.mm.yyyy]"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" Height="18,89765" Left="0" Top="196" Width="718,1107">
      <TfrxMemoView Name="Page" Left="638,74057" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[Page]"/>
    </TfrxPageFooter>
    <TfrxHeader Name="Header1" Height="22,67718" Left="0" Top="112" Width="718,1107" ReprintOnNewPage="True" Stretched="True">
      <TfrxMemoView Name="Memo6" Left="113,3859" Top="0" Width="415,7483" Height="22,67716535" ShowHint="False" StretchMode="smMaxHeight" DataSet="OstQRY" DataSetName="Остаток" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ"/>
      <TfrxMemoView Name="Memo7" Left="642,5201" Top="0" Width="75,5906" Height="22,6771653543307" ShowHint="False" StretchMode="smMaxHeight" DataSet="OstQRY" DataSetName="Остаток" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р•Рґ. РёР·Рј."/>
      <TfrxMemoView Name="Memo8" Left="529,1342" Top="0" Width="113,3859" Height="22,67716535" ShowHint="False" StretchMode="smMaxHeight" DataSet="OstQRY" DataSetName="Остаток" DisplayFormat.FormatStr="%2.4n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»-РІРѕ."/>
      <TfrxMemoView Name="Memo9" Left="37,7953" Top="0" Width="75,5906" Height="22,67716535" ShowHint="False" StretchMode="smMaxHeight" DataSet="OstQRY" DataSetName="Остаток" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎРёСЃС‚. в„–."/>
      <TfrxMemoView Name="Memo10" Left="0" Top="0" Width="37,7953" Height="22,67716535" ShowHint="False" StretchMode="smMaxHeight" DataSet="OstQRY" DataSetName="Остаток" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„–. Рї.Рї."/>
    </TfrxHeader>
  </TfrxReportPage>
</TfrxReport>
