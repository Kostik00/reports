<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="6.7" DotMatrixReport="False" EngineOptions.DoublePass="True" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="44062,6089046181" ReportOptions.Description.Text="" ReportOptions.Name="Готовые к запуску паспорта (ver. 45 – 44).fr3 Справочник изделий" ReportOptions.LastChange="44071,6724409722" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  ReportName: String;&#13;&#10;  sAttachmentCode: String;&#13;&#10;  sNonReadyStatus: String;&#13;&#10;  bSQLTextEnabled: Boolean;&#13;&#10;&#13;&#10;procedure DetailVKZOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if qDetailVKZ.FieldByName('Mst_Key_Pasport').IsNull&#13;&#10;    then dsVKZMst_Cod_Pasp.HAlign:=taCenter&#13;&#10;    else dsVKZMst_Cod_Pasp.HAlign:=taLeftJustify;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage2OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if dpSQLText.Visible&#13;&#10;    then begin&#13;&#10;      Panel2.Color:=clBackground;&#13;&#10;      Panel3.Color:=clBackground;&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      Panel2.Color:=clBtnFace;&#13;&#10;      Panel3.Color:=clBtnFace;&#13;&#10;    end;&#13;&#10;  if qAttachment.Active&#13;&#10;    then qAttachment.Close;&#13;&#10;  clbAttachment.Clear;&#13;&#10;  qAttachment.Open;&#13;&#10;  qAttachment.First;&#13;&#10;  while not qAttachment.Eof&#13;&#10;    do begin&#13;&#10;      clbAttachment.Items.Add(&#60;dsAttachment.&#34;Cod_Prin&#34;&#62;+' ('+&#60;dsAttachment.&#34;Name_K_Prin&#34;&#62;+') '+&#60;dsAttachment.&#34;Name_Prin&#34;&#62;);&#13;&#10;      qAttachment.Next;&#13;&#10;    end;&#13;&#10;  clbAttachment.Checked[0]:=True;&#13;&#10;  clbAttachment.Checked[1]:=True;&#13;&#10;  qAttachment.Close;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnDeactivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if rbAssembly.Checked then sAttachmentCode:='''00''';&#13;&#10;  if rbAssemblyAndDSE.Checked then sAttachmentCode:='''00'', ''10''';&#13;&#10;  if rbAttachmentCode.Checked then DialogPage2.Visible:=rbAttachmentCode.Checked;&#13;&#10;  DialogPage3.Visible:=cbNonReady.Checked;&#13;&#10;  if ((not DialogPage2.Visible) and (not DialogPage3.Visible)) then SetSQLTextInQuery;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage2OnDeactivate(Sender: TfrxComponent);&#13;&#10;var i: Integer;&#13;&#10;begin&#13;&#10;  for i:=0 to clbAttachment.Items.Count-1&#13;&#10;    do begin&#13;&#10;      if clbAttachment.Checked[i]&#13;&#10;        then  if sAttachmentCode = ''&#13;&#10;                then sAttachmentCode:=''''+Trim(Copy(clbAttachment.Items.Strings[i], 1, 4))+''''&#13;&#10;                else sAttachmentCode:=sAttachmentCode+', '''+Trim(Copy(clbAttachment.Items.Strings[i], 1, 4))+'''';&#13;&#10;    end;&#13;&#10;  if not DialogPage3.Visible then SetSQLTextInQuery;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure SetSQLTextInQuery;&#13;&#10;begin&#13;&#10;  if qDetailVKZ.Active then qDetailVKZ.Close;&#13;&#10;  qDetailVKZ.SQL.Clear;&#13;&#10;  qDetailVKZ.SQL.Text:=mSQLText1.Lines.Text+sAttachmentCode+mSQLText2.Lines.Text+sNonReadyStatus+mSQLText3.Lines.Text;&#13;&#10;  mSQLReady.Lines.Text:=qDetailVKZ.SQL.Text;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Panel1OnDblClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  dpSQLText.Visible:=not dpSQLText.Visible;&#13;&#10;  if dpSQLText.Visible then TfrxPanelControl(Sender).Color:=clBackground else TfrxPanelControl(Sender).Color:=clBtnFace;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Panel2OnDblClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  dpSQLText.Visible:=not dpSQLText.Visible;&#13;&#10;  if dpSQLText.Visible then TfrxPanelControl(Sender).Color:=clBackground else TfrxPanelControl(Sender).Color:=clBtnFace;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if dpSQLText.Visible&#13;&#10;    then begin&#13;&#10;      Panel1.Color:=clBackground;&#13;&#10;      Panel2.Color:=clBackground;&#13;&#10;      Panel3.Color:=clBackground;&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      Panel1.Color:=clBtnFace;&#13;&#10;      Panel2.Color:=clBtnFace;&#13;&#10;      Panel3.Color:=clBtnFace;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage3OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if dpSQLText.Visible&#13;&#10;    then Panel3.Color:=clBackground&#13;&#10;    else Panel3.Color:=clBtnFace;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Panel3OnDblClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  dpSQLText.Visible:=not dpSQLText.Visible;&#13;&#10;  if dpSQLText.Visible then TfrxPanelControl(Sender).Color:=clBackground else TfrxPanelControl(Sender).Color:=clBtnFace;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure SetDialogPage3;&#13;&#10;begin&#13;&#10;  clbNonReadyStatus.Clear;&#13;&#10;  clbNonReadyStatus.Items.Add('Приостанов (врем)');&#13;&#10;  clbNonReadyStatus.Items.Add('Передано на Вх. Контр.');&#13;&#10;  clbNonReadyStatus.Items.Add('Корректировка СП');&#13;&#10;  clbNonReadyStatus.Items.Add('Корректировка ТП');&#13;&#10;  clbNonReadyStatus.Items.Add('Редактирование (Треб.маршрут)');&#13;&#10;  clbNonReadyStatus.Items.Add('Запуск разрешен');&#13;&#10;  clbNonReadyStatus.Items.Add('Запущено');&#13;&#10;  clbNonReadyStatus.Items.Add('Изготовлено');&#13;&#10;  clbNonReadyStatus.Items.Add('Забраковано');&#13;&#10;  clbNonReadyStatus.Checked[1]:=True;&#13;&#10;  clbNonReadyStatus.Checked[4]:=True;&#13;&#10;  clbNonReadyStatus.Checked[5]:=True;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GetDialogPage3;&#13;&#10;var i: Integer;&#13;&#10;  procedure AddTosNonReadyStatus(AString: String);&#13;&#10;  begin&#13;&#10;    if sNonReadyStatus = ''&#13;&#10;      then sNonReadyStatus:=AString&#13;&#10;      else sNonReadyStatus:=sNonReadyStatus+', '+AString;&#13;&#10;  end;&#13;&#10;begin&#13;&#10;  sNonReadyStatus:='';&#13;&#10;  for i:=0 to 8&#13;&#10;    do begin&#13;&#10;      if clbNonReadyStatus.Checked[i]&#13;&#10;        then begin&#13;&#10;          case i of&#13;&#10;            0: AddTosNonReadyStatus('-4');&#13;&#10;            1: AddTosNonReadyStatus('-3');&#13;&#10;            2: AddTosNonReadyStatus('-2');&#13;&#10;            3: AddTosNonReadyStatus('-1');&#13;&#10;            4: AddTosNonReadyStatus('0');&#13;&#10;            5: AddTosNonReadyStatus('1');&#13;&#10;            6: AddTosNonReadyStatus('5');&#13;&#10;            7: AddTosNonReadyStatus('6');&#13;&#10;            8: AddTosNonReadyStatus('7');&#13;&#10;          end;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure DialogPage3OnDeactivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  GetDialogPage3;&#13;&#10;  SetSQLTextInQuery;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  ReportName:=Trim(Report.ReportOptions.Name);&#13;&#10;  sAttachmentCode:='';&#13;&#10;  sNonReadyStatus:='0, -3, 1';&#13;&#10;  bSQLTextEnabled:=False;&#13;&#10;  Panel1.Enabled:=bSQLTextEnabled;&#13;&#10;  Panel2.Enabled:=bSQLTextEnabled;&#13;&#10;  Panel3.Enabled:=bSQLTextEnabled;&#13;&#10;  dpSQLText.Visible:=False;&#13;&#10;  SetDialogPage3;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="MainFrxDS" DataSetName="MainDS"/>
    <item DataSet="qDetailVKZ" DataSetName="dsDetailVKZ"/>
    <item DataSet="qAttachment" DataSetName="dsAttachment"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="qDetailVKZ" UserName="dsDetailVKZ" CloseDataSource="False" FieldAliases.Text="Mst_Key_VKZ=Mst_Key_VKZ&#13;&#10;Mst_Key_VKZ_Izdel=Mst_Key_VKZ_Izdel&#13;&#10;Mst_Key_VKZ_Master=Mst_Key_VKZ_Master&#13;&#10;Mst_Key_Predm=Mst_Key_Predm&#13;&#10;Mst_Key_Pasport=Mst_Key_Pasport&#13;&#10;Mst_Cod_Pasp=Mst_Cod_Pasp&#13;&#10;Mst_Cod_Zak=Mst_Cod_Zak&#13;&#10;Cod_Prin=Cod_Prin&#13;&#10;Name_K_Prin=Name_K_Prin&#13;&#10;Mst_Cod_Predm=Mst_Cod_Predm&#13;&#10;Mst_Name_Predm=Mst_Name_Predm&#13;&#10;Mst_Kolvo=Mst_Kolvo&#13;&#10;Mst_Kolvo_On_Izdel=Mst_Kolvo_On_Izdel" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="SET NOCOUNT ON;&#13;&#10;  &#13;&#10;DECLARE @Key_VKZ Int;&#13;&#10;DECLARE @Cod_Zak varchar(30);  &#13;&#10;&#13;&#10;SET @Key_VKZ = :Key_VKZ;  &#13;&#10;SET @Cod_Zak = :Cod_Zak;  &#13;&#10;  &#13;&#10;SET NOCOUNT OFF;  &#13;&#10;  &#13;&#10;SELECT&#13;&#10;    [MstVKZ].[Key_VKZ]          AS [Mst_Key_VKZ],&#13;&#10;    [MstVKZ].[Key_VKZ_Izdel]    AS [Mst_Key_VKZ_Izdel],&#13;&#10;    [MstVKZ].[Key_VKZ_Master]   AS [Mst_Key_VKZ_Master],&#13;&#10;    [MstVKZ].[Key_Predm]        AS [Mst_Key_Predm],&#13;&#10;    [MstPasp].[Key_Pasport]     AS [Mst_Key_Pasport],                       &#13;&#10;    ISNULL([MstPasp].[Cod_Pasp], '– нет паспорта –')&#13;&#10;                                AS [Mst_Cod_Pasp],&#13;&#10;    ISNULL([MstPasp].[Cod_Zak], '')&#13;&#10;                                AS [Mst_Cod_Zak],&#13;&#10;    [MstPredm].[Cod_Prin]       AS [Cod_Prin],&#13;&#10;    [MstPredm].[Name_K_Prin]    AS [Name_K_Prin],        &#13;&#10;    [MstPredm].[Cod_Predm]      AS [Mst_Cod_Predm],&#13;&#10;    [MstPredm].[Name_Predm]     AS [Mst_Name_Predm],        &#13;&#10;    [MstVKZ].[Kolvo]            AS [Mst_Kolvo],&#13;&#10;    [MstVKZ].[Kolvo_On_Izdel]   AS [Mst_Kolvo_On_Izdel]&#13;&#10;  FROM&#13;&#10;    [P_VKZ] AS [MstVKZ]&#13;&#10;      INNER JOIN [T_VPredm]   AS [MstPredm]&#13;&#10;              ON [MstPredm].[Key_Predm] = [MstVKZ].[Key_Predm]  &#13;&#10;      LEFT  JOIN [Pr_Pasp]    AS [MstPasp]&#13;&#10;              ON [MstPasp].[Key_Predm] = [MstPredm].[Key_Predm] AND [MstPasp].[Cod_Zak] = @Cod_Zak&#13;&#10;  WHERE&#13;&#10;    [MstVKZ].[Key_VKZ_Izdel] = @Key_VKZ AND      &#13;&#10;    RTRIM(LTRIM([MstPredm].[Cod_Prin])) in ('00', '10') AND&#13;&#10;    [MstVKZ].[Cod_Postav] &#60;&#62; '8' AND&#13;&#10;    (NOT ((([MstVKZ].[Kolvo_On_Izdel] = 0) OR ([MstVKZ].[Kolvo] = 0))  AND ([MstPasp].[Key_Pasport] IS NULL))) AND                     &#13;&#10;   ([MstPasp].[Key_Pasp_Status] in (0, -3, 1) OR [MstPasp].[Key_Pasport] IS NULL) AND  -- &#34;Передано на Вх. Контр.&#34;, &#34;Редактирование (Треб. маршрут)&#34;, &#34;Запуск разрешён&#34; или &#34;Нет паспорта&#34;       &#13;&#10;   NOT (EXISTS (&#13;&#10;      SELECT&#13;&#10;          [VKZ].  [Key_VKZ]     AS [Key_VKZ],&#13;&#10;          [Pasp]. [Key_Pasport] AS [Key_Pasport],  &#13;&#10;          [Pasp]. [Cod_Pasp]    AS [Cod_Pasp],                             &#13;&#10;          [Pasp]. [PaspKolvo]   AS [PaspKolvo],&#13;&#10;          [Pasp]. [Key_Predm]   AS [Key_Predm],&#13;&#10;          [Predm].[Cod_Predm]   AS [Cod_Predm],&#13;&#10;          [Predm].[Name_Predm]  AS [Name_Predm],&#13;&#10;          SUM(ISNULL([PaspDet].[KolvoZap], 0))  AS [SUMKolvoZAP],&#13;&#10;          SUM(ISNULL([VKZ]    .[Kolvo],    0))  AS [SUMVKZKolvo]&#13;&#10;        FROM&#13;&#10;          [P_VKZ] AS [VKZ]&#13;&#10;            INNER JOIN [T_VPredm]    AS [Predm]&#13;&#10;                    ON [Predm].[Key_Predm] = [VKZ].[Key_Predm]  &#13;&#10;            LEFT  JOIN [Pr_Pasp]    AS [Pasp]&#13;&#10;                    ON [Pasp].[Key_Predm] = [VKZ].[Key_Predm] AND ([Pasp].[Key_Pasp_Status] in (6))                      &#13;&#10;            LEFT  JOIN [Pr_PaspDet] AS [PaspDet]&#13;&#10;                    ON [PaspDet].[Key_VKZ] = [VKZ].[Key_VKZ] AND [PaspDet].[Key_Pasport] = [Pasp].[Key_Pasport]&#13;&#10;        WHERE&#13;&#10;          [VKZ].[Key_VKZ_Master] = [MstVKZ].[Key_VKZ]              &#13;&#10;        GROUP BY&#13;&#10;          [VKZ].  [Key_VKZ],&#13;&#10;          [Pasp]. [Key_Pasport],&#13;&#10;          [Pasp]. [Cod_Pasp],&#13;&#10;          [Pasp]. [PaspKolvo],&#13;&#10;          [Pasp]. [Key_Predm],&#13;&#10;          [Predm].[Cod_Predm],&#13;&#10;          [Predm].[Name_Predm]  &#13;&#10;        HAVING&#13;&#10;          SUM([PaspDet].[KolvoZap]) &#60; SUM([VKZ].[Kolvo]))&#13;&#10;    OR&#13;&#10;  EXISTS (&#13;&#10;    SELECT&#13;&#10;      [VKZ].  [Key_VKZ]     AS [Key_VKZ],&#13;&#10;      [Pasp]. [Key_Pasport] AS [Key_Pasport],  &#13;&#10;      [Pasp]. [Cod_Pasp]    AS [Cod_Pasp],                             &#13;&#10;      [Pasp]. [PaspKolvo]   AS [PaspKolvo],&#13;&#10;      [Pasp]. [Key_Predm]   AS [Key_Predm],&#13;&#10;      [Predm].[Cod_Predm]   AS [Cod_Predm],&#13;&#10;      [Predm].[Name_Predm]  AS [Name_Predm]&#13;&#10;    FROM&#13;&#10;      [P_VKZ] AS [VKZ]&#13;&#10;        LEFT  JOIN [Pr_Pasp]    AS [Pasp]&#13;&#10;                ON [Pasp].[Key_Predm] = [VKZ].[Key_Predm]      &#13;&#10;        INNER JOIN [T_VPredm]    AS [Predm]&#13;&#10;                ON [Predm].[Key_Predm] = [VKZ].[Key_Predm]      &#13;&#10;        LEFT  JOIN [Pr_PaspDet] AS [PaspDet]&#13;&#10;                ON [PaspDet].[Key_VKZ] = [VKZ].[Key_VKZ] AND [PaspDet].[Key_Pasport] = [Pasp].[Key_Pasport]&#13;&#10;    WHERE&#13;&#10;      [VKZ].[Key_VKZ_Master] = [MstVKZ].[Key_VKZ] AND&#13;&#10;     ([Pasp].[Key_Pasp_Status] in (-4, -3, -2, -1, 0, 1, 5, 7) OR       &#13;&#10;     ([Pasp]. [Key_Pasport] IS NULL))))&#13;&#10;  ORDER BY&#13;&#10;    [MstPredm].[Cod_Prin],        &#13;&#10;    [MstVKZ].[Key_VKZ] ASC;    " PropData="05704C65667402340470546F7002340A506172616D657465727301010C54000000204E616D653D224B65795F564B5A222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4D61696E44532E262333343B4B65795F564B5A262333343B262336323B2200010C53000000204E616D653D22436F645F5A616B222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B4D61696E44532E262333343B436F645F5A616B262333343B262336323B220000"/>
    <TfrxERQuery Name="qAttachment" UserName="dsAttachment" CloseDataSource="True" FieldAliases.Text="Cod_Prin=Cod_Prin&#13;&#10;Name_Prin=Name_Prin&#13;&#10;Name_K_Prin=Name_K_Prin" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;    CAST([Cod_Prin] AS char(4)) AS [Cod_Prin],&#13;&#10;    [Name_Prin],&#13;&#10;    [Name_K_Prin]&#13;&#10;  FROM&#13;&#10;    [T_Prinadl];  " PropData="05704C656674039C000470546F7002340A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" Frame.Typ="0" MirrorMode="0" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="94,488188976378" Left="0" Top="18,89765" Width="1046,92981">
      <TfrxMemoView Name="Memo2" AllowVectorExport="True" Left="406,299475" Top="15,11811024" Width="272,12616" Height="64,25201" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Arial" Font.Style="1" Frame.Typ="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџРђРЎРџРћР РўРђ&#13;&#10;(РіРѕС‚РѕРІС‹Рµ Рє Р·Р°РїСѓСЃРєСѓ)&#13;&#10;РїРѕ СЃРїРёСЃРєСѓ РёР·РґРµР»РёР№"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterMainDS" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="15,11811024" Left="0" Top="241,88992" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="MainFrxDS" DataSetName="MainDS" KeepFooter="True" KeepHeader="True" RowCount="0">
      <TfrxMemoView Name="MainDSKey_VKZ" IndexTag="1" AllowVectorExport="True" Left="37,7953" Top="4,87999999999877E-6" Width="215,43321" Height="15,11811024" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="0" GapX="5" ParentFont="False" Text="РёР·РґРµР»РёРµ в„– [MainDS.&#34;Key_VKZ&#34;]"/>
      <TfrxMemoView Name="Memo4" IndexTag="1" AllowVectorExport="True" Left="37,7953" Top="11,33858268" Width="215,43321" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="9" Frame.Width="0,1" GapX="5" HAlign="haRight" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo8" IndexTag="1" AllowVectorExport="True" Left="0" Top="0" Width="37,7953" Height="15,11811024" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="1" GapX="5" HAlign="haRight" ParentFont="False" Text="[Line]"/>
      <TfrxMemoView Name="Memo9" IndexTag="1" AllowVectorExport="True" Left="0" Top="11,33858268" Width="37,7953" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="9" Frame.Width="0,1" GapX="5" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="MainDSCod_Zak" IndexTag="1" AllowVectorExport="True" Left="253,22851" Top="0" Width="68,03149118" Height="15,11811024" DataField="Cod_Zak" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="0" GapX="5" HAlign="haCenter" ParentFont="False" Text="[MainDS.&#34;Cod_Zak&#34;]"/>
      <TfrxMemoView Name="MainDSCod_Predm" IndexTag="1" AllowVectorExport="True" Left="321,26005" Top="0" Width="113,38582677" Height="15,11811024" DataField="Cod_Predm" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="0" GapX="5" ParentFont="False" Text="[MainDS.&#34;Cod_Predm&#34;]"/>
      <TfrxMemoView Name="MainDSName_Predm" IndexTag="1" AllowVectorExport="True" Left="434,64595" Top="0" Width="612,28386" Height="15,11811024" DataField="Name_Predm" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="2" GapX="5" ParentFont="False" WordWrap="False" Text="[MainDS.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="Memo10" IndexTag="1" AllowVectorExport="True" Left="321,26005" Top="11,33858268" Width="113,38582677" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="9" Frame.Width="0,1" GapX="5" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo11" IndexTag="1" AllowVectorExport="True" Left="434,64595" Top="11,33858268" Width="612,28386" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="11" Frame.Width="0,1" GapX="5" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo12" IndexTag="1" AllowVectorExport="True" Left="253,22851" Top="11,33858268" Width="68,03149118" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="9" Frame.Width="0,1" GapX="5" HAlign="haCenter" ParentFont="False" Text=""/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="15,11811024" Left="0" Top="430,86642" Width="1046,92981">
      <TfrxMemoView Name="Memo1" AllowVectorExport="True" Left="944,8825" Top="0" Width="102,04731" Height="15,11811024" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" HAlign="haRight" ParentFont="False" WordBreak="True" WordWrap="False" Text="РЎС‚СЂ. [Page#] РёР· [TotalPages#]"/>
      <TfrxMemoView Name="Memo19" AllowVectorExport="True" Left="0" Top="0" Width="188,9765" Height="15,11811024" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" ParentFont="False" Text="РћС‚С‡С‘С‚ СЃРѕР·РґР°РЅ: [Date] [Time]">
        <Formats>
          <item FormatStr="dd.mm.yyyy" Kind="fkDateTime"/>
          <item FormatStr="hh:mm" Kind="fkDateTime"/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo32" AllowVectorExport="True" Left="240,00033807" Top="0" Width="566,92913386" Height="15,11811024" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[ReportName]"/>
    </TfrxPageFooter>
    <TfrxHeader Name="MasterHeader" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="30,23622047" Left="0" Top="181,41744" Width="1046,92981" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo6" IndexTag="1" AllowVectorExport="True" Left="177,63791" Top="0" Width="75,5906" Height="30,23622047" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="14" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– Р’РљР—"/>
      <TfrxMemoView Name="Memo7" IndexTag="1" AllowVectorExport="True" Left="0" Top="0" Width="37,7953" Height="30,23622047" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„–"/>
      <TfrxMemoView Name="Memo13" IndexTag="1" AllowVectorExport="True" Left="253,22851" Top="0" Width="68,03149118" Height="30,23622047" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕРґ Р·Р°РєР°Р·"/>
      <TfrxMemoView Name="Memo14" IndexTag="1" AllowVectorExport="True" Left="321,26005" Top="0" Width="113,38582677" Height="30,23622047" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕРґ Р”РЎР•"/>
      <TfrxMemoView Name="Memo15" IndexTag="1" AllowVectorExport="True" Left="434,64595" Top="0" Width="612,28386" Height="30,23622047" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ Р”РЎР•"/>
      <TfrxMemoView Name="Memo26" IndexTag="1" AllowVectorExport="True" Left="37,7953" Top="0" Width="139,84261" Height="30,23622047" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="13" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
    </TfrxHeader>
    <TfrxDetailData Name="DetailVKZ" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="15,11811024" Left="0" Top="317,48052" Width="1046,92981" OnBeforePrint="DetailVKZOnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="qDetailVKZ" DataSetName="dsDetailVKZ" KeepFooter="True" RowCount="0">
      <TfrxMemoView Name="dsVKZMst_Cod_Pasp" IndexTag="1" AllowVectorExport="True" Left="124,72449" Top="0" Width="128,50402" Height="15,11811024" DataSet="qDetailVKZ" DataSetName="dsDetailVKZ" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" GapX="5" ParentFont="False" WordBreak="True" WordWrap="False" Text="[dsDetailVKZ.&#34;Mst_Cod_Pasp&#34;]"/>
      <TfrxMemoView Name="dsVKZMst_Cod_Predm" IndexTag="1" AllowVectorExport="True" Left="321,26005" Top="0" Width="113,38582677" Height="15,11811024" DataField="Mst_Cod_Predm" DataSet="qDetailVKZ" DataSetName="dsDetailVKZ" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" GapX="5" ParentFont="False" Text="[dsDetailVKZ.&#34;Mst_Cod_Predm&#34;]"/>
      <TfrxMemoView Name="dsVKZMst_Name_Predm" IndexTag="1" AllowVectorExport="True" Left="453,5436" Top="0" Width="593,38621" Height="15,11811024" DataField="Mst_Name_Predm" DataSet="qDetailVKZ" DataSetName="dsDetailVKZ" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="2" GapX="5" ParentFont="False" Text="[dsDetailVKZ.&#34;Mst_Name_Predm&#34;]"/>
      <TfrxMemoView Name="Memo16" IndexTag="1" AllowVectorExport="True" Left="321,26005" Top="11,33858268" Width="113,38582677" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="9" Frame.Width="0,1" GapX="5" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo23" IndexTag="1" AllowVectorExport="True" Left="453,5436" Top="11,33858268" Width="593,38621" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="11" Frame.Width="0,1" GapX="5" ParentFont="False" Text=""/>
      <TfrxMemoView Name="dsDetailVKZ1Cod_Zak" IndexTag="1" AllowVectorExport="True" Left="253,22851" Top="0" Width="68,03149118" Height="15,11811024" DataSetName="dsSubDetailVKZ1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="[dsDetailVKZ.&#34;Mst_Cod_Zak&#34;]"/>
      <TfrxMemoView Name="Memo20" IndexTag="1" AllowVectorExport="True" Left="253,22851" Top="11,33858268" Width="68,03149118" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="9" Frame.Width="0,1" GapX="5" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo21" IndexTag="1" AllowVectorExport="True" Left="37,7953" Top="0" Width="37,7953" Height="15,11811024" DataSet="MainFrxDS" DataSetName="MainDS" DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" GapX="5" HAlign="haRight" ParentFont="False" Text="[Line]"/>
      <TfrxMemoView Name="Memo27" IndexTag="1" AllowVectorExport="True" Left="0" Top="0" Width="37,7953" Height="15,11811024" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="1" GapX="5" HAlign="haRight" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo24" IndexTag="1" AllowVectorExport="True" Left="37,7953" Top="11,33858268" Width="37,7953" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="9" Frame.Width="0,1" GapX="5" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo28" IndexTag="1" AllowVectorExport="True" Left="0" Top="11,33858268" Width="37,7953" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="9" Frame.Width="0,1" GapX="5" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo25" IndexTag="1" AllowVectorExport="True" Left="75,5906" Top="0" Width="49,13389" Height="15,11811024" DataSet="qDetailVKZ" DataSetName="dsDetailVKZ" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" HAlign="haRight" ParentFont="False" WordBreak="True" WordWrap="False" Text="РїР°СЃРї. в„–"/>
      <TfrxMemoView Name="Memo29" IndexTag="1" AllowVectorExport="True" Left="75,5906" Top="11,33858268" Width="49,13389" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="9" Frame.Width="0,1" GapX="5" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo34" IndexTag="1" AllowVectorExport="True" Left="434,64595" Top="0" Width="18,89757677" Height="15,11811024" DataSet="qDetailVKZ" DataSetName="dsDetailVKZ" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" GapX="5" HAlign="haCenter" ParentFont="False" Text="[dsDetailVKZ.&#34;Name_K_Prin&#34;]"/>
      <TfrxMemoView Name="Memo35" IndexTag="1" AllowVectorExport="True" Left="434,64595" Top="11,33858268" Width="18,89757677" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="9" Frame.Width="0,1" GapX="5" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo22" IndexTag="1" AllowVectorExport="True" Left="124,72449" Top="11,33858268" Width="128,50402" Height="3,77952756" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="9" Frame.Width="0,1" GapX="5" HAlign="haCenter" ParentFont="False" Text=""/>
    </TfrxDetailData>
    <TfrxFooter Name="DetailFooter" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="0" Left="0" Top="362,83488" Width="1046,92981">
      <TfrxMemoView Name="Memo30" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="0" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="4" Frame.Width="0,1" ParentFont="False" Text=""/>
    </TfrxFooter>
    <TfrxFooter Name="MasterFooter" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="0" Left="0" Top="287,24428" Width="1046,92981">
      <TfrxMemoView Name="Memo31" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="0" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="4" ParentFont="False" Text=""/>
    </TfrxFooter>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" DoubleBuffered="False" Height="223" ClientHeight="196" Left="596" Top="196" Width="287" Scaled="True" ClientWidth="279" OnActivate="DialogPage1OnActivate" OnDeactivate="DialogPage1OnDeactivate">
    <TfrxButtonControl Name="btCancel1" Anchors="9" Left="8" Top="163" Width="75" Height="25" ShowHint="True" Caption="Отмена" ModalResult="2"/>
    <TfrxLabelControl Name="Label1" Left="8" Top="8" Width="193" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" ShowHint="True" Caption="Готовые к запуску паспорта" Color="-16777201"/>
    <TfrxGroupBoxControl Name="gbDSE" Anchors="7" Left="8" Top="32" Width="261" Height="94" ShowHint="True" Caption="Сборки и Детали" Color="-16777201">
      <TfrxRadioButtonControl Name="rbAssemblyAndDSE" Left="16" Top="20" Width="113" Height="17" ShowHint="True" Caption="СБ и Д" TabStop="False" Color="-16777201"/>
      <TfrxRadioButtonControl Name="rbAssembly" Left="16" Top="44" Width="113" Height="17" ShowHint="True" Caption="СБ" Checked="True" Color="-16777201"/>
      <TfrxRadioButtonControl Name="rbAttachmentCode" Left="16" Top="68" Width="237" Height="17" ShowHint="True" Caption="Выбрать код принадлежности подробнее" TabStop="False" Color="-16777201"/>
    </TfrxGroupBoxControl>
    <TfrxPanelControl Name="Panel1" Anchors="13" Left="92" Top="163" Width="95" Height="25" ShowHint="True" BevelOuter="bvNone" Color="-16777201" OnDblClick="Panel1OnDblClick"/>
    <TfrxButtonControl Name="btOk1" Anchors="12" Left="194" Top="163" Width="75" Height="25" ShowHint="True" Caption="Ok" ModalResult="1"/>
    <TfrxCheckBoxControl Name="cbNonReady" Left="24" Top="136" Width="241" Height="17" ShowHint="True" Caption="Уточнить список незакрытых паспортов" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxDialogPage Name="DialogPage2" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Visible="False" Caption="Набор кодов принадлежности" DoubleBuffered="False" Height="400" ClientHeight="373" Left="664" Top="204" Width="338" Scaled="True" ClientWidth="330" OnActivate="DialogPage2OnActivate" OnDeactivate="DialogPage2OnDeactivate">
    <TfrxCheckListBoxControl Name="clbAttachment" Anchors="15" Left="8" Top="8" Width="316" Height="326" ShowHint="True" Color="-16777211" Items.Text=""/>
    <TfrxPanelControl Name="plButtons2" Anchors="13" Left="8" Top="342" Width="317" Height="25" ShowHint="True" BevelOuter="bvNone" Color="-16777201">
      <TfrxButtonControl Name="btOk2" Anchors="8" Left="242" Top="0" Width="75" Height="25" ShowHint="True" Caption="Ok" ModalResult="1"/>
      <TfrxButtonControl Name="btCancel2" Anchors="9" Left="0" Top="0" Width="75" Height="25" ShowHint="True" Caption="Отмена" ModalResult="2"/>
      <TfrxPanelControl Name="Panel2" Anchors="12" Left="80" Top="0" Width="157" Height="25" ShowHint="True" BevelOuter="bvNone" Color="-16777201" OnDblClick="Panel2OnDblClick"/>
    </TfrxPanelControl>
  </TfrxDialogPage>
  <TfrxDialogPage Name="DialogPage3" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Visible="False" DoubleBuffered="False" Height="443" ClientHeight="416" Left="503" Top="176" Width="338" Scaled="True" ClientWidth="330" OnActivate="DialogPage3OnActivate" OnDeactivate="DialogPage3OnDeactivate">
    <TfrxButtonControl Name="btOk" Anchors="12" Left="248" Top="380" Width="75" Height="25" ShowHint="True" Caption="Ok" ModalResult="1"/>
    <TfrxButtonControl Name="btCancel" Anchors="9" Left="8" Top="380" Width="75" Height="25" ShowHint="True" Caption="Отмена" ModalResult="2"/>
    <TfrxCheckListBoxControl Name="clbNonReadyStatus" Anchors="15" Left="8" Top="8" Width="316" Height="364" ShowHint="True" Color="-16777211" Items.Text=""/>
    <TfrxPanelControl Name="Panel3" Anchors="13" Left="92" Top="380" Width="145" Height="25" ShowHint="True" BevelOuter="bvNone" Color="-16777201" OnDblClick="Panel3OnDblClick"/>
  </TfrxDialogPage>
  <TfrxDialogPage Name="dpSQLText" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Visible="False" DoubleBuffered="False" Height="641" ClientHeight="614" Left="466" Top="124" Width="510" Scaled="True" ClientWidth="502">
    <TfrxMemoControl Name="mSQLText1" Anchors="7" Left="8" Top="8" Width="485" Height="89" ShowHint="True" Color="-16777211" Lines.Text="SET NOCOUNT ON;&#13;&#10;  &#13;&#10;DECLARE @Key_VKZ Int;&#13;&#10;DECLARE @Cod_Zak varchar(30);  &#13;&#10;&#13;&#10;SET @Key_VKZ = :Key_VKZ;  &#13;&#10;SET @Cod_Zak = :Cod_Zak;  &#13;&#10;  &#13;&#10;SET NOCOUNT OFF;  &#13;&#10;  &#13;&#10;SELECT&#13;&#10;    [MstVKZ].[Key_VKZ]          AS [Mst_Key_VKZ],&#13;&#10;    [MstVKZ].[Key_VKZ_Izdel]    AS [Mst_Key_VKZ_Izdel],&#13;&#10;    [MstVKZ].[Key_VKZ_Master]   AS [Mst_Key_VKZ_Master],&#13;&#10;    [MstVKZ].[Key_Predm]        AS [Mst_Key_Predm],&#13;&#10;    [MstPasp].[Key_Pasport]     AS [Mst_Key_Pasport],                       &#13;&#10;    ISNULL([MstPasp].[Cod_Pasp], '– нет паспорта –')&#13;&#10;                                AS [Mst_Cod_Pasp],&#13;&#10;    ISNULL([MstPasp].[Cod_Zak], '')&#13;&#10;                                AS [Mst_Cod_Zak],&#13;&#10;    [MstPredm].[Cod_Prin]       AS [Cod_Prin],&#13;&#10;    [MstPredm].[Name_K_Prin]    AS [Name_K_Prin],        &#13;&#10;    [MstPredm].[Cod_Predm]      AS [Mst_Cod_Predm],&#13;&#10;    [MstPredm].[Name_Predm]     AS [Mst_Name_Predm],        &#13;&#10;    [MstVKZ].[Kolvo]            AS [Mst_Kolvo],&#13;&#10;    [MstVKZ].[Kolvo_On_Izdel]   AS [Mst_Kolvo_On_Izdel]&#13;&#10;  FROM&#13;&#10;    [P_VKZ] AS [MstVKZ]&#13;&#10;      INNER JOIN [T_VPredm]   AS [MstPredm]&#13;&#10;              ON [MstPredm].[Key_Predm] = [MstVKZ].[Key_Predm]  &#13;&#10;      LEFT  JOIN [Pr_Pasp]    AS [MstPasp]&#13;&#10;              ON [MstPasp].[Key_Predm] = [MstPredm].[Key_Predm] AND [MstPasp].[Cod_Zak] = @Cod_Zak&#13;&#10;  WHERE&#13;&#10;    [MstVKZ].[Key_VKZ_Izdel] = @Key_VKZ AND      &#13;&#10;    RTRIM(LTRIM([MstPredm].[Cod_Prin])) in (" MaxLength="0" WordWrap="False"/>
    <TfrxMemoControl Name="mSQLText2" Anchors="7" Left="8" Top="108" Width="485" Height="89" ShowHint="True" Color="-16777211" Lines.Text=") AND&#13;&#10;    [MstVKZ].[Cod_Postav] &#60;&#62; '8' AND&#13;&#10;    (NOT ((([MstVKZ].[Kolvo_On_Izdel] = 0) OR ([MstVKZ].[Kolvo] = 0))  AND ([MstPasp].&#13;&#10;[Key_Pasport] IS NULL))) AND                     &#13;&#10;   ([MstPasp].[Key_Pasp_Status] in (0, -3, 1) OR [MstPasp].[Key_Pasport] IS NULL) AND  &#13;&#10;   NOT (EXISTS (&#13;&#10;      SELECT&#13;&#10;          [VKZ].  [Key_VKZ]     AS [Key_VKZ],&#13;&#10;          [Pasp]. [Key_Pasport] AS [Key_Pasport],  &#13;&#10;          [Pasp]. [Cod_Pasp]    AS [Cod_Pasp],                             &#13;&#10;          [Pasp]. [PaspKolvo]   AS [PaspKolvo],&#13;&#10;          [Pasp]. [Key_Predm]   AS [Key_Predm],&#13;&#10;          [Predm].[Cod_Predm]   AS [Cod_Predm],&#13;&#10;          [Predm].[Name_Predm]  AS [Name_Predm],&#13;&#10;          SUM(ISNULL([PaspDet].[KolvoZap], 0))  AS [SUMKolvoZAP],&#13;&#10;          SUM(ISNULL([VKZ]    .[Kolvo],    0))  AS [SUMVKZKolvo]&#13;&#10;        FROM&#13;&#10;          [P_VKZ] AS [VKZ]&#13;&#10;            INNER JOIN [T_VPredm]    AS [Predm]&#13;&#10;                    ON [Predm].[Key_Predm] = [VKZ].[Key_Predm]  &#13;&#10;            LEFT  JOIN [Pr_Pasp]    AS [Pasp]&#13;&#10;                    ON [Pasp].[Key_Predm] = [VKZ].[Key_Predm] AND ([Pasp].[Key_Pasp_Status] in (6)) &#13;&#10;                     &#13;&#10;            LEFT  JOIN [Pr_PaspDet] AS [PaspDet]&#13;&#10;                    ON [PaspDet].[Key_VKZ] = [VKZ].[Key_VKZ] AND [PaspDet].[Key_Pasport] = &#13;&#10;[Pasp].[Key_Pasport]&#13;&#10;        WHERE&#13;&#10;          [VKZ].[Key_VKZ_Master] = [MstVKZ].[Key_VKZ]              &#13;&#10;        GROUP BY&#13;&#10;          [VKZ].  [Key_VKZ],&#13;&#10;          [Pasp]. [Key_Pasport],&#13;&#10;          [Pasp]. [Cod_Pasp],&#13;&#10;          [Pasp]. [PaspKolvo],&#13;&#10;          [Pasp]. [Key_Predm],&#13;&#10;          [Predm].[Cod_Predm],&#13;&#10;          [Predm].[Name_Predm]  &#13;&#10;        HAVING&#13;&#10;          SUM([PaspDet].[KolvoZap]) &#60; SUM([VKZ].[Kolvo]))&#13;&#10;    OR&#13;&#10;  EXISTS (&#13;&#10;    SELECT&#13;&#10;      [VKZ].  [Key_VKZ]     AS [Key_VKZ],&#13;&#10;      [Pasp]. [Key_Pasport] AS [Key_Pasport],  &#13;&#10;      [Pasp]. [Cod_Pasp]    AS [Cod_Pasp],                             &#13;&#10;      [Pasp]. [PaspKolvo]   AS [PaspKolvo],&#13;&#10;      [Pasp]. [Key_Predm]   AS [Key_Predm],&#13;&#10;      [Predm].[Cod_Predm]   AS [Cod_Predm],&#13;&#10;      [Predm].[Name_Predm]  AS [Name_Predm]&#13;&#10;    FROM&#13;&#10;      [P_VKZ] AS [VKZ]&#13;&#10;        LEFT  JOIN [Pr_Pasp]    AS [Pasp]&#13;&#10;                ON [Pasp].[Key_Predm] = [VKZ].[Key_Predm]      &#13;&#10;        INNER JOIN [T_VPredm]    AS [Predm]&#13;&#10;                ON [Predm].[Key_Predm] = [VKZ].[Key_Predm]      &#13;&#10;        LEFT  JOIN [Pr_PaspDet] AS [PaspDet]&#13;&#10;                ON [PaspDet].[Key_VKZ] = [VKZ].[Key_VKZ] AND [PaspDet].[Key_Pasport] = [Pasp].&#13;&#10;[Key_Pasport]&#13;&#10;    WHERE&#13;&#10;      [VKZ].[Key_VKZ_Master] = [MstVKZ].[Key_VKZ] AND&#13;&#10;     ([Pasp].[Key_Pasp_Status] in (" MaxLength="0"/>
    <TfrxMemoControl Name="mSQLReady" Anchors="15" Left="8" Top="308" Width="485" Height="261" ShowHint="True" Color="-16777211" Lines.Text="mSQLReady" MaxLength="0"/>
    <TfrxButtonControl Name="btOk3" Anchors="12" Left="418" Top="580" Width="75" Height="25" ShowHint="True" Caption="Ok" ModalResult="1"/>
    <TfrxButtonControl Name="btCancel3" Anchors="9" Left="8" Top="580" Width="75" Height="25" ShowHint="True" Caption="Отмена" ModalResult="2"/>
    <TfrxMemoControl Name="mSQLText3" Anchors="7" Left="8" Top="208" Width="485" Height="89" ShowHint="True" Color="-16777211" Lines.Text=") OR&#13;&#10;     ([Pasp]. [Key_Pasport] IS NULL))))&#13;&#10;  ORDER BY&#13;&#10;    [MstPredm].[Cod_Prin],        &#13;&#10;    [MstVKZ].[Key_VKZ] ASC;" MaxLength="0"/>
  </TfrxDialogPage>
</TfrxReport>
