<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.4" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42062,7183215625" ReportOptions.Description.Text="" ReportOptions.Name="Ãðàôèê âûïîëíåíèÿ îïåðàöèé ïî ÔÈÎ.fr3 Æóðíàë çàïóñêà" ReportOptions.LastChange="42459,7243657292" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;var&#13;&#10; Y,M,D:word ;&#13;&#10;begin&#13;&#10;  DecodeDate(Date,Y,M,D);&#13;&#10;  DateFrom.Date:=EncodeDate(Y,M,1);&#13;&#10;  DateTo.Date:=EncodeDate(Y,M,D) + EncodeTime(23,59,59,99);&#13;&#10;end;&#13;&#10;&#13;&#10;function MyInTime:integer;&#13;&#10;begin&#13;&#10;  Result:=0;&#13;&#10;  if (&#60;ÏëàíÔàêò.&#34;AcDate&#34;&#62; &#62; 0) and  ( Trunc(&#60;ÏëàíÔàêò.&#34;AcDate&#34;&#62;) &#60;= Trunc(&#60;ÏëàíÔàêò.&#34;PlnDate&#34;&#62;)) then&#13;&#10;    Result:=1;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Memo6OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;{&#13;&#10;  if MyInTime =1 then&#13;&#10;    FMemo.Color := clNone&#13;&#10;  else&#13;&#10;    FMemo.Color := $00C6C6FF;&#13;&#10;  }&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="PlnQRY" DataSetName="ÏëàíÔàêò"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="PlnQRY" UserName="ÏëàíÔàêò" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT     &#13;&#10;       S_Subjects.Name_Sub, &#13;&#10;       Pr_Pasp.Date_Sub_Master, &#13;&#10;       Pr_Pasp.Key_Pasport, &#13;&#10;       Pr_Pasp.Cod_Pasp, &#13;&#10;       Pr_Pasp.Key_Pasp_Status, &#13;&#10;       Pr_Pasp_Status.Name_Pasp_Status,&#13;&#10;       T_VPredm.Cod_Predm, &#13;&#10;       T_VPredm.Name_Predm, &#13;&#10;       T_Oper.Name_K_Oper, &#13;&#10;       T_Oper.Name_Oper, &#13;&#10;       Pr_Pasp_Rows.PlnDate, &#13;&#10;       Pr_Pasp_Rows.AcDate,&#13;&#10;       Pr_Pasp_Rows.Status_Oper,&#13;&#10;       Pr_Pasp_Rows.TSm,                               &#13;&#10;       Pr_Status_Oper.Name_Status_Oper, &#13;&#10;       Pr_Pasp_Rows.N_Oper_Sm,&#13;&#10;       T2.MinPlnDate             &#13;&#10;FROM&#13;&#10;       Pr_Pasp           &#13;&#10;  &#13;&#10;        &#13;&#10;       INNER JOIN S_Subjects&#13;&#10;               ON S_Subjects.Key_Sub = Pr_Pasp.Key_Sub_Master  &#13;&#10;         &#13;&#10;       INNER JOIN T_VPredm &#13;&#10;               ON Pr_Pasp.Key_Predm = T_VPredm.Key_Predm &#13;&#10;                &#13;&#10;       INNER JOIN  Pr_Pasp_Rows &#13;&#10;               ON Pr_Pasp.Key_Pasport = Pr_Pasp_Rows.Key_Pasport &#13;&#10;               AND Pr_Pasp.Key_Sub_Master = Pr_Pasp_Rows.Key_Sub_Otv &#13;&#10;       INNER JOIN  T_Oper &#13;&#10;               ON Pr_Pasp_Rows.Cod_Oper = T_Oper.Cod_Oper &#13;&#10;       INNER JOIN Pr_Status_Oper &#13;&#10;               ON Pr_Pasp_Rows.Status_Oper = Pr_Status_Oper.Status_Oper &#13;&#10;       INNER JOIN Pr_Pasp_Status &#13;&#10;               ON Pr_Pasp.Key_Pasp_Status = Pr_Pasp_Status.Key_Pasp_Status&#13;&#10;&#13;&#10;       INNER JOIN&#13;&#10;       (&#13;&#10;SELECT DISTINCT Pr_PaspDet.Key_Pasport, P_VKZ_1.Cod_SosZ&#13;&#10;FROM         Pr_PaspDet INNER JOIN&#13;&#10;                      P_VKZ ON Pr_PaspDet.Key_VKZ = P_VKZ.Key_VKZ INNER JOIN&#13;&#10;                      P_VKZ AS P_VKZ_1 ON P_VKZ.Key_VKZ_Izdel = P_VKZ_1.Key_VKZ&#13;&#10;WHERE     (P_VKZ_1.Cod_SosZ = 'Ä')&#13;&#10;       ) T1&#13;&#10;       ON T1.Key_Pasport =  Pr_Pasp.Key_Pasport                                      &#13;&#10;&#13;&#10;&#13;&#10;       INNER JOIN&#13;&#10;       (&#13;&#10;SELECT     Pr_Pasp.Key_Pasport, MIN(Pr_Pasp_Rows.PlnDate) AS MinPlnDate&#13;&#10;FROM         Pr_Pasp INNER JOIN&#13;&#10;                      Pr_Pasp_Rows ON Pr_Pasp.Key_Pasport = Pr_Pasp_Rows.Key_Pasport AND Pr_Pasp.Key_Sub_Master = Pr_Pasp_Rows.Key_Sub_Otv&#13;&#10;WHERE     (Pr_Pasp.Key_Pasp_Status &#60; 6) AND (Pr_Pasp_Rows.Status_Oper &#60; 2)&#13;&#10;GROUP BY Pr_Pasp.Key_Pasport  &#13;&#10;       ) T2&#13;&#10;       ON T2.Key_Pasport =  Pr_Pasp.Key_Pasport&#13;&#10;         &#13;&#10;&#13;&#10;  &#13;&#10;WHERE     (Pr_Pasp.Key_Pasp_Status &#60; 6)&#13;&#10;       AND Pr_Pasp_Rows.Status_Oper &#60;2&#13;&#10;       AND Pr_Pasp_Rows.TSm &#62; 0&#13;&#10;       AND S_Subjects.Name_Sub like :FIO                                              &#13;&#10;ORDER BY &#13;&#10;       S_Subjects.Name_Sub, T2.MinPlnDate, T_VPredm.OrderCod_Predm, Pr_Pasp_Rows.PlnDate, Pr_Pasp_Rows.N_Oper_Sm              " PropData="05704C656674024C0470546F7002340A506172616D657465727301010C35000000204E616D653D2246494F222044617461547970653D226674537472696E67222045787072657373696F6E3D2246494F2E54455854220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Height="224" ClientHeight="186" Left="360" Top="126" Width="296" ClientWidth="280" OnActivate="DialogPage1OnActivate">
    <TfrxDateEditControl Name="DateFrom" Left="112" Top="64" Width="145" Height="21" ShowHint="True" Visible="False" Color="-16777211" Date="42062,7647512384" Time="42062,7647512384" WeekNumbers="False"/>
    <TfrxDateEditControl Name="DateTo" Left="112" Top="104" Width="145" Height="21" ShowHint="True" Visible="False" Color="-16777211" Date="42062,7648124421" Time="42062,7648124421" WeekNumbers="False"/>
    <TfrxButtonControl Name="OK" Left="180" Top="148" Width="75" Height="25" ShowHint="True" Caption="OK" ModalResult="1"/>
    <TfrxEditControl Name="FIO" Left="112" Top="20" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="%"/>
    <TfrxLabelControl Name="Label1" Left="20" Top="24" Width="30" Height="16" ShowHint="True" Caption="ÔÈÎ" Color="-16777201"/>
    <TfrxLabelControl Name="Label2" Left="77" Top="68" Width="9" Height="16" ShowHint="True" Visible="False" Caption="Ñ" Color="-16777201"/>
    <TfrxLabelControl Name="Label3" Left="76" Top="108" Width="14" Height="16" ShowHint="True" Visible="False" Caption="ïî" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="18,89765" Width="1046,92981"/>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="139,84261" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="PlnQRY" DataSetName="ÏëàíÔàêò" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo3" Left="37,7953" Top="0" Width="151,1812" Height="18,89765" StretchMode="smMaxHeight" DataSet="PlnQRY" DataSetName="ÏëàíÔàêò" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" SuppressRepeated="True" Text="[ÐŸÐ»Ð°Ð½Ð¤Ð°ÐºÑ‚.&#34;Cod_Pasp&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="744,56741" Top="0" Width="94,48825" Height="18,89765" StretchMode="smMaxHeight" DataField="PlnDate" DataSet="PlnQRY" DataSetName="ÏëàíÔàêò" DisplayFormat.FormatStr="dd.mm.yy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½Ð¤Ð°ÐºÑ‚.&#34;PlnDate&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="188,9765" Top="0" Width="332,59864" Height="18,89765" StretchMode="smMaxHeight" DataSet="PlnQRY" DataSetName="ÏëàíÔàêò" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½Ð¤Ð°ÐºÑ‚.&#34;Cod_Predm&#34;] [ÐŸÐ»Ð°Ð½Ð¤Ð°ÐºÑ‚.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="521,57514" Top="0" Width="158,74026" Height="18,89765" StretchMode="smMaxHeight" DataSet="PlnQRY" DataSetName="ÏëàíÔàêò" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½Ð¤Ð°ÐºÑ‚.&#34;N_Oper_Sm&#34;] [ÐŸÐ»Ð°Ð½Ð¤Ð°ÐºÑ‚.&#34;Name_K_Oper&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="0" Top="0" Width="37,7953" Height="18,89765" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[Line]"/>
      <TfrxMemoView Name="Memo15" Left="680,3154" Top="0" Width="64,25201" Height="18,89765" StretchMode="smMaxHeight" DataField="TSm" DataSet="PlnQRY" DataSetName="ÏëàíÔàêò" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½Ð¤Ð°ÐºÑ‚.&#34;TSm&#34;]"/>
      <TfrxBarCodeView Name="BarCode2" Align="baRight" Left="904,92981" Top="3,77953" Width="142" Height="15,11812" BarType="bcCode39Extended" CalcCheckSum="True" Expression="'0 02 '+IntToStr(&#60;ÏëàíÔàêò.&#34;Key_Pasport&#34;&#62;)" HAlign="haRight" Rotation="0" ShowText="False" Text="12345678" WideBarRatio="2" Zoom="1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="260,78757" Width="1046,92981">
      <TfrxMemoView Name="Memo1" Left="971,33921" Top="0" Width="75,5906" Height="18,89765" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="98,26778" Width="1046,92981" Condition="ÏëàíÔàêò.&#34;Name_Sub&#34;" OutlineText="&#60;ÏëàíÔàêò.&#34;Name_Sub&#34;&#62;" StartNewPage="True">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="1046,92981" Height="18,89765" DataField="Name_Sub" DataSet="PlnQRY" DataSetName="ÏëàíÔàêò" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="13434879" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½Ð¤Ð°ÐºÑ‚.&#34;Name_Sub&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="181,41744" Width="1046,92981">
      <TfrxMemoView Name="Memo12" Left="952,44156" Top="0" Width="94,48825" Height="18,89765" StretchMode="smMaxHeight" DataSet="PlnQRY" DataSetName="ÏëàíÔàêò" DisplayFormat.FormatStr="%2.0f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haRight" ParentFont="False" Text="[100*SUM(MyInTime,MasterData1) / COUNT(MasterData1)] %"/>
      <TfrxMemoView Name="Memo13" Left="857,95331" Top="0" Width="94,48825" Height="18,89765" StretchMode="smMaxHeight" DataSet="PlnQRY" DataSetName="ÏëàíÔàêò" DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haCenter" ParentFont="False" Text="[SUM(MyInTime,MasterData1)] ([COUNT(MasterData1)])"/>
      <TfrxMemoView Name="Memo14" Left="0" Top="0" Width="857,95331" Height="18,89765" DataSet="PlnQRY" DataSetName="ÏëàíÔàêò" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haRight" ParentFont="False" Text="Ð¸Ñ‚Ð¾Ð³Ð¾ Ð¿Ð¾ [ÐŸÐ»Ð°Ð½Ð¤Ð°ÐºÑ‚.&#34;Name_Sub&#34;]"/>
    </TfrxGroupFooter>
  </TfrxReportPage>
</TfrxReport>
