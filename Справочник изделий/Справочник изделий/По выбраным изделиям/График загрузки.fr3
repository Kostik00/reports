<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.15" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42388,6843250926" ReportOptions.Description.Text="" ReportOptions.Name="График загрузки.fr3 Справочник изделий" ReportOptions.LastChange="42396,7257573843" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403800203546F70022008446174617365747301010C2900000020446174615365743D224D61696E46727844532220446174615365744E616D653D224D61696E44532200010C2A00000020446174615365743D2245525175657279312220446174615365744E616D653D22C4E5F2E0EBFCEDEE220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="ERQuery1" UserName="Детально" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="MainFrxDS" IgnoreDupParams="False" SQL.Text="DECLARE @Key_VKZ_Izdel int&#13;&#10;SET @Key_VKZ_Izdel = :Key_VKZ_Izdel&#13;&#10;DECLARE @CodOperGr1 varchar(50)&#13;&#10;SET @CodOperGr1 = :Cod_Gr&#13;&#10;&#13;&#10;&#13;&#10;SELECT T1.N_Str, T1.StrName, T1.Key_VKZ_Izdel, T1.SMT1 Smt1, T2.Smt2 , Isnull(T1.SMT1,0) -  Isnull(T2.Smt2,0) SMT                      &#13;&#10;FROM &#13;&#10;&#13;&#10;(&#13;&#10;SELECT     &#13;&#10;	Usr_PlnStr.N_Str,&#13;&#10;	Usr_PlnStr.StrName,&#13;&#10;	P_VKZ.Key_VKZ_Izdel, &#13;&#10;	SUM(P_VKZ.Kolvo * Isnull(T_TPRows.Tsht,0) + Isnull(T_TPRows.Tpz,0) ) SMT1  &#13;&#10;	&#13;&#10;FROM         &#13;&#10;	Usr_PlnStr &#13;&#10;&#13;&#10;	LEFT JOIN P_VKZ&#13;&#10;		ON P_VKZ.Key_VKZ_Izdel = @Key_VKZ_Izdel	  &#13;&#10;		AND P_VKZ.DataVipUtv between   Usr_PlnStr.DateFrom  and Usr_PlnStr.DateTo&#13;&#10;&#13;&#10;	LEFT JOIN T_Predm &#13;&#10;		ON P_VKZ.Key_Predm = T_Predm.Key_Predm &#13;&#10;	LEFT JOIN T_SP &#13;&#10;		ON T_Predm.Key_Predm = T_SP.Key_Predm &#13;&#10;	LEFT JOIN T_TPRows &#13;&#10;		ON T_SP.Key_TP = T_TPRows.Key_TP &#13;&#10;		AND T_TPRows.Cod_Oper  in (SELECT  COD_Oper from t_Oper where T_Oper.Cod_KLOB like @CodOperGr1 )&#13;&#10;&#13;&#10;&#13;&#10;WHERE   &#13;&#10;       Usr_PlnStr.Usr = 'dbo'&#13;&#10;       AND  Usr_PlnStr.ReportNum=:Rep_Num                                                              &#13;&#10;&#13;&#10;GROUP BY&#13;&#10;	Usr_PlnStr.N_Str,&#13;&#10;	Usr_PlnStr.StrName,&#13;&#10;	P_VKZ.Key_VKZ_Izdel&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;) T1&#13;&#10;&#13;&#10;INNER JOIN &#13;&#10;&#13;&#10;(&#13;&#10;SELECT     &#13;&#10;	Usr_PlnStr.N_Str,&#13;&#10;	Usr_PlnStr.StrName,&#13;&#10;	P_VKZ.Key_VKZ_Izdel, &#13;&#10;	SUM(Pr_Pasp_Ac.AcKolvo * Pr_Pasp_Rows.Tsm  * Pr_PaspDet.KolvoZap  /(Pr_Pasp.PaspKolvo * Pr_Pasp.PaspKolvo)) SMT2&#13;&#10;FROM         &#13;&#10;	Usr_PlnStr &#13;&#10;&#13;&#10;	LEFT JOIN P_VKZ &#13;&#10;		ON P_VKZ.Key_VKZ_Izdel = @Key_VKZ_Izdel&#13;&#10;		AND P_VKZ.DataVipUtv between   Usr_PlnStr.DateFrom  and Usr_PlnStr.DateTo&#13;&#10; &#13;&#10;	LEFT JOIN Pr_PaspDet &#13;&#10;		ON P_VKZ.Key_VKZ = Pr_PaspDet.Key_VKZ &#13;&#10;	LEFT JOIN Pr_Pasp &#13;&#10;		ON Pr_PaspDet.Key_Pasport = Pr_Pasp.Key_Pasport &#13;&#10;	LEFT JOIN Pr_Pasp_Rows &#13;&#10;		ON Pr_Pasp.Key_Pasport = Pr_Pasp_Rows.Key_Pasport &#13;&#10;		AND Pr_Pasp_Rows.Cod_Oper  in (SELECT  COD_Oper from t_Oper where T_Oper.Cod_KLOB like @CodOperGr1)&#13;&#10;	LEFT JOIN Pr_Pasp_Ac &#13;&#10;		ON Pr_Pasp_Rows.Key_Pasp_Rows = Pr_Pasp_Ac.Key_Pasp_Rows&#13;&#10;&#13;&#10;WHERE&#13;&#10;       Usr_PlnStr.ReportNum=:Rep_Num&#13;&#10;    &#13;&#10;GROUP BY &#13;&#10;	Usr_PlnStr.N_Str,&#13;&#10;	Usr_PlnStr.StrName,&#13;&#10;	P_VKZ.Key_VKZ_Izdel&#13;&#10;) T2&#13;&#10;	ON T2.N_Str = T1.N_Str&#13;&#10;&#13;&#10;&#13;&#10;ORDER BY  N_Str  &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;SELECT&#13;&#10;	Usr_PlnStr.N_Str,&#13;&#10;	Usr_PlnStr.StrName,&#13;&#10;	P_VKZ.Key_VKZ_Izdel, &#13;&#10;	SUM(P_VKZ.Kolvo * Isnull(T_TPRows.Tsht,0) + Isnull(T_TPRows.Tpz,0) ) SMT&#13;&#10;	&#13;&#10;FROM         &#13;&#10;	Usr_PlnStr &#13;&#10;&#13;&#10;	LEFT JOIN P_VKZ&#13;&#10;		ON P_VKZ.Key_VKZ_Izdel = :Key_VKZ_Izdel	  &#13;&#10;		AND P_VKZ.DataVipUtv between   Usr_PlnStr.DateFrom  and Usr_PlnStr.DateTo&#13;&#10;&#13;&#10;	LEFT JOIN T_Predm &#13;&#10;		ON P_VKZ.Key_Predm = T_Predm.Key_Predm &#13;&#10;	LEFT JOIN T_SP &#13;&#10;		ON T_Predm.Key_Predm = T_SP.Key_Predm &#13;&#10;	LEFT JOIN T_TPRows &#13;&#10;		ON T_SP.Key_TP = T_TPRows.Key_TP &#13;&#10;		AND T_TPRows.Cod_Oper  in (SELECT  COD_Oper from t_Oper where T_Oper.Cod_KLOB = :Cod_Gr )&#13;&#10;&#13;&#10;&#13;&#10;WHERE   Usr_PlnStr.Usr = 'dbo' &#13;&#10;&#13;&#10;GROUP BY&#13;&#10;	Usr_PlnStr.N_Str,&#13;&#10;	Usr_PlnStr.StrName,&#13;&#10;	P_VKZ.Key_VKZ_Izdel&#13;&#10;&#13;&#10;&#13;&#10;ORDER BY  Usr_PlnStr.N_Str  " PropData="05704C656674024C0470546F7002300A506172616D657465727301010C2A000000204E616D653D224B65795F564B5A5F497A64656C222044617461547970653D226674556E6B6E6F776E2200010C3B000000204E616D653D22436F645F4772222044617461547970653D226674537472696E67222045787072657373696F6E3D224772456469742E546578742200010C3E000000204E616D653D225265705F4E756D222044617461547970653D226674496E7465676572222045787072657373696F6E3D225265705F4E756D2E546578742200010C2B000000204E616D653D224B65795F564B5A5F497A64656C09222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="200" ClientHeight="162" Left="265" Top="150" Width="300" ClientWidth="284">
    <TfrxEditControl Name="GrEdit" Left="108" Top="60" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="ТОК"/>
    <TfrxButtonControl Name="Button1" Left="184" Top="112" Width="75" Height="25" ShowHint="True" Caption="Button1" ModalResult="1"/>
    <TfrxEditControl Name="Rep_Num" Left="108" Top="28" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="1"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" Height="57,7953" Left="0" Top="16" Width="1046,92981"/>
    <TfrxMasterData Name="MasterData1" Height="20" Left="0" Top="208" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="MainFrxDS" DataSetName="MainDS" RowCount="0" Stretched="True">
      <TfrxMemoView Name="MainDSCod_Zak" Left="22,67718" Top="0" Width="113,3859" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="Cod_Zak" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[MainDS.&#34;Cod_Zak&#34;]"/>
      <TfrxMemoView Name="MainDSCod_Predm" Left="136,06308" Top="0" Width="151,1812" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="MainFrxDS" DataSetName="MainDS" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[MainDS.&#34;Cod_Predm&#34;] [MainDS.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="411,96877" Top="0" Width="49,13389" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataField="SMT" DataSet="ERQuery1" DataSetName="Детально" DisplayFormat.FormatStr="%2.1n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Р”РµС‚Р°Р»СЊРЅРѕ.&#34;SMT&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="506,45702" Top="0" Width="52,91342" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="ERQuery1" DataSetName="Детально" DisplayFormat.FormatStr="%2.1n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Р”РµС‚Р°Р»СЊРЅРѕ.&#34;SMT&#34;&#62;,MasterData2)]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" Height="20" Left="0" Top="292" Width="1046,92981">
      <TfrxMemoView Name="Memo1" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxHeader Name="Header1" Height="718,1107" Left="22,67718" Top="0" Vertical="True" Width="264,5671"/>
    <TfrxMasterData Name="MasterData2" Height="718,1107" Left="411,96877" Top="0" Vertical="True" Width="49,13389" ColumnWidth="0" ColumnGap="0" DataSet="ERQuery1" DataSetName="Детально" RowCount="0"/>
    <TfrxHeader Name="Header2" Height="94,48825" Left="0" Top="92" Width="1046,92981" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo2" Left="411,96877" Top="0" Width="49,13382787" Height="94,48825" ShowHint="False" DataField="StrName" DataSet="ERQuery1" DataSetName="Детально" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="[Р”РµС‚Р°Р»СЊРЅРѕ.&#34;StrName&#34;]"/>
    </TfrxHeader>
    <TfrxFooter Name="Footer1" Height="22,67718" Left="0" Top="248" Width="1046,92981">
      <TfrxMemoView Name="Memo4" Left="411,96877" Top="0" Width="49,13389" Height="22,67718" ShowHint="False" DataSet="ERQuery1" DataSetName="Детально" DisplayFormat.FormatStr="%2.1n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Р”РµС‚Р°Р»СЊРЅРѕ.&#34;SMT&#34;&#62;,MasterData1)]"/>
    </TfrxFooter>
    <TfrxFooter Name="Footer2" Height="718,1107" Left="506,45702" Top="0" Vertical="True" Width="52,91342"/>
  </TfrxReportPage>
</TfrxReport>
