<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.13.1" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40888,1098601389" ReportOptions.Description.Text="" ReportOptions.Name="Процент изготовления ДСЕ.fr3 ВКЗ № 632-Н02" ReportOptions.LastChange="41595,1427136921" ScriptLanguage="PascalScript" ScriptText.Text="const&#13;&#10;  LvlWidth=20;&#13;&#10;&#13;&#10;var&#13;&#10;  Cod_PredmWidth,Cod_PredmLeft:double;&#13;&#10;  &#13;&#10;&#13;&#10;function FnTSm:double;&#13;&#10;begin&#13;&#10;  Result:=&#60;TrudQRY.&#34;SmTrudByPasp&#34;&#62;;&#13;&#10;  if Result &#60;= 0 then &#13;&#10;  Result:= &#60;TrudQRY.&#34;SmByTP&#34;&#62;;                           &#13;&#10;    &#13;&#10;end;  &#13;&#10;&#13;&#10;function FnProcent:double;&#13;&#10;begin&#13;&#10;  if  FnTSm = 0 then &#13;&#10;       Result:=0&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    Result := 100 * &#60;TrudQRY.&#34;SmTrudByPaspRowF&#34;&#62;/FnTSm;                     &#13;&#10;  end          &#13;&#10;  &#13;&#10;end;&#13;&#10;  &#13;&#10;function FnProcent1:double;&#13;&#10;begin&#13;&#10;  if  FnTSm = 0 then &#13;&#10;       Result:=0&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    Result := 100 * &#60;TrudQRY.&#34;SmTrudByZ&#34;&#62;/FnTSm;                     &#13;&#10;  end          &#13;&#10;end;          &#13;&#10;  &#13;&#10;&#13;&#10;  &#13;&#10;procedure MasterData2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Cod_Predm_Memo.Left:=Cod_PredmLeft+(&#60;TrudQRY.&#34;Lvl&#34;&#62;)*LvlWidth;&#13;&#10;  Cod_Predm_Memo.Width:=Cod_PredmWidth-(&#60;TrudQRY.&#34;Lvl&#34;&#62;)*LvlWidth;&#13;&#10;  &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  Cod_PredmWidth:=Cod_Predm_Memo.Width;&#13;&#10;  Cod_PredmLeft:=Cod_Predm_Memo.Left;  &#13;&#10;end." StoreInDFM="False" PropData="044C65667403800203546F70022008446174617365747301010C2500000020446174615365743D22564B5A66727844532220446174615365744E616D653D22C2CAC72200010C2800000020446174615365743D22547275645152592220446174615365744E616D653D2254727564515259220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="TrudQRY" UserName="TrudQRY" CloseDataSource="True" FieldAliases.Text="Lvl=Lvl&#13;&#10;Key_VKZ=Key_VKZ&#13;&#10;Cod_Predm=Cod_Predm&#13;&#10;Name_Predm=Name_Predm&#13;&#10;KontrTrud=KontrTrud&#13;&#10;KontrTrudPZ=KontrTrudPZ&#13;&#10;Kolvo=Kolvo&#13;&#10;SmTrudByPasp=SmTrudByPasp&#13;&#10;SmTrudByPaspF=SmTrudByPaspF&#13;&#10;SmTrudByPaspRowF=SmTrudByPaspRowF&#13;&#10;SmTrudByZ=SmTrudByZ&#13;&#10;SmByTP=SmByTP" BCDToCurrency="False" Master="VKZfrxDS" IgnoreDupParams="False" SQL.Text="exec [dbo].[Pr_VKZ_GetTree]&#13;&#10;@Cod_Zak=:Cod_Zak&#13;&#10;  &#13;&#10;&#13;&#10;SELECT     &#13;&#10;	P_VKZ.Lvl - (SELECT LVL from P_VKZ T2 WHERE T2.Key_VKZ= :Key_VKZ ) AS Lvl, &#13;&#10;	P_VKZ.Key_VKZ, &#13;&#10;	T_VPredm.Cod_Predm, &#13;&#10;	T_VPredm.Name_Predm,&#13;&#10; T_VPredm.KontrTrud, &#13;&#10; T_VPredm.KontrTrudPZ,  &#13;&#10;	P_VKZ.Kolvo,&#13;&#10;         &#13;&#10;       dbo.Pr_VKZ_Get_SmTrud_ByPasp(P_VKZ.Key_VKZ) SmTrudByPasp,&#13;&#10;       dbo.Pr_VKZ_Get_SmTrud_ByPaspF(P_VKZ.Key_VKZ) SmTrudByPaspF,&#13;&#10;       dbo.Pr_VKZ_Get_SmTrud_ByPaspRowF(P_VKZ.Key_VKZ) SmTrudByPaspRowF,&#13;&#10;       dbo.Pr_VKZ_Get_SmTrud_ByZ(P_VKZ.Key_VKZ) SmTrudByZ,&#13;&#10;       dbo.Pr_VKZ_Get_SmTrud_ByTP(P_VKZ.Key_Predm, P_VKZ.Kolvo) SmByTP    &#13;&#10;  &#13;&#10;FROM         &#13;&#10;       P_VKZ&#13;&#10;       INNER JOIN T_VPredm&#13;&#10;               ON P_VKZ.Key_Predm = T_VPredm.Key_Predm &#13;&#10;                 &#13;&#10;                                       &#13;&#10;                 &#13;&#10;WHERE     &#13;&#10;		   (P_VKZ.Key_VKZ_Izdel = :Key_VKZ_Izdel)              &#13;&#10;	AND (P_VKZ.CodStrSv LIKE (SELECT CodStrSv from P_VKZ T1 WHERE T1.Key_VKZ= :Key_VKZ)+'%' )&#13;&#10;--	AND (P_VKZ.LVL = (SELECT LVL from P_VKZ T2 WHERE T2.Key_VKZ= :Key_VKZ ))    &#13;&#10;-- AND ((P_VKZ.Cod_Postav in(1,2)) OR (P_VKZ.Cod_Postav IS NULL))                                           &#13;&#10;&#13;&#10;ORDER BY P_VKZ.CodStrSv  " PropData="05704C656674025C0470546F7003AC000A506172616D657465727301010C24000000204E616D653D22436F645F5A616B222044617461547970653D226674556E6B6E6F776E2200010C24000000204E616D653D224B65795F564B5A222044617461547970653D226674556E6B6E6F776E2200010C2A000000204E616D653D224B65795F564B5A5F497A64656C222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="9" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxPageFooter Name="PageFooter1" Height="22,67718" Left="0" Top="216" Width="721,89023" OnBeforePrint="PageFooter1OnBeforePrint">
      <TfrxMemoView Name="Memo1" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData2" Height="22,67718" Left="0" Top="128" Width="721,89023" OnBeforePrint="MasterData2OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="TrudQRY" DataSetName="TrudQRY" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Cod_Predm_Memo" Left="0" Top="0" Width="374,17347" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataSetName="Незапуск" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[TrudQRY.&#34;Cod_Predm&#34;] [TrudQRY.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="TrudQRYSmByTP" Left="472,44125" Top="0" Width="56,69291339" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="TrudQRY" DataSetName="TrudQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[FnTSm]"/>
      <TfrxMemoView Name="TrudQRYSmTrudByPaspF" Left="529,1342" Top="0" Width="56,69291339" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataField="SmTrudByPaspRowF" DataSet="TrudQRY" DataSetName="TrudQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[TrudQRY.&#34;SmTrudByPaspRowF&#34;]"/>
      <TfrxMemoView Name="Memo11" Left="585,82715" Top="0" Width="37,79527559" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="TrudQRY" DataSetName="TrudQRY" DisplayFormat.FormatStr="%2.1n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[FnProcent]"/>
      <TfrxMemoView Name="Memo20" Left="623,62245" Top="0" Width="56,69291339" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataField="SmTrudByZ" DataSet="TrudQRY" DataSetName="TrudQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[TrudQRY.&#34;SmTrudByZ&#34;]"/>
      <TfrxMemoView Name="Memo22" Left="680,3154" Top="0" Width="37,79527559" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="TrudQRY" DataSetName="TrudQRY" DisplayFormat.FormatStr="%2.1n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[FnProcent1]"/>
      <TfrxMemoView Name="TrudQRYKolvo" Left="374,17347" Top="0" Width="41,57483" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataField="Kolvo" DataSet="TrudQRY" DataSetName="TrudQRY" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[TrudQRY.&#34;Kolvo&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="415,7483" Top="0" Width="56,69291339" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="TrudQRY" DataSetName="TrudQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[&#60;TrudQRY.&#34;Kolvo&#34;&#62;*&#60;TrudQRY.&#34;KontrTrud&#34;&#62;+&#60;TrudQRY.&#34;KontrTrudPZ&#34;&#62;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header2" Height="49,13389" Left="0" Top="60" Width="721,89023" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo14" Left="0" Top="0" Width="374,17347" Height="49,13389" ShowHint="False" DataSetName="Незапуск" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”РЎР• "/>
      <TfrxMemoView Name="Memo16" Left="472,44125" Top="0" Width="151,1812" Height="22,67718" ShowHint="False" DataSetName="Незапуск" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџРѕ РїР°СЃРїРѕСЂС‚Сѓ"/>
      <TfrxMemoView Name="Memo17" Left="529,1342" Top="22,67718" Width="56,69291339" Height="26,45671" ShowHint="False" DataSetName="Незапуск" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РІС‹РїРѕР»."/>
      <TfrxMemoView Name="Memo18" Left="585,82715" Top="22,67718" Width="37,7953" Height="26,45671" ShowHint="False" DataSetName="Незапуск" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="%"/>
      <TfrxMemoView Name="Memo19" Left="472,44125" Top="22,67718" Width="56,69291339" Height="26,45671" ShowHint="False" DataSetName="Незапуск" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РўСЂСѓРґ."/>
      <TfrxMemoView Name="Memo21" Left="623,62245" Top="0" Width="94,48825" Height="22,67718" ShowHint="False" DataSetName="Незапуск" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџРѕ СЃРј. Р·Р°РґР°РЅ"/>
      <TfrxMemoView Name="Memo23" Left="623,62245" Top="22,67718" Width="56,69291339" Height="26,45671" ShowHint="False" DataSetName="Незапуск" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РІС‹РґР°РЅРѕ"/>
      <TfrxMemoView Name="Memo24" Left="680,3154" Top="22,67718" Width="37,7953" Height="26,45671" ShowHint="False" DataSetName="Незапуск" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="%"/>
      <TfrxMemoView Name="Memo2" Left="374,17347" Top="0" Width="41,57483" Height="49,13389" ShowHint="False" DataSetName="Незапуск" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР» - РІРѕ"/>
      <TfrxMemoView Name="Memo4" Left="415,7483" Top="0" Width="56,69291339" Height="49,13389" ShowHint="False" DataSetName="Незапуск" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЈС‚РІ.&#13;&#10;С‚СЂСѓРґ."/>
    </TfrxHeader>
    <TfrxFooter Name="Footer2" Height="22,67718" Left="0" Top="172" Width="721,89023">
      <TfrxMemoView Name="Memo12" Left="472,44125" Top="0" Width="56,69291339" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="TrudQRY" DataSetName="TrudQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(FnTSm)]"/>
      <TfrxMemoView Name="Memo13" Left="529,1342" Top="0" Width="56,69291339" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="TrudQRY" DataSetName="TrudQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;TrudQRY.&#34;SmTrudByPaspRowF&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo15" Left="585,82715" Top="0" Width="37,79527559" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="TrudQRY" DataSetName="TrudQRY" DisplayFormat.FormatStr="%2.1n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[100*SUM(&#60;TrudQRY.&#34;SmTrudByPaspRowF&#34;&#62;)/SUM(FnTSm)]"/>
      <TfrxMemoView Name="Memo9" Left="0" Top="0" Width="415,7483" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataSetName="Незапуск" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="РС‚РѕРіРѕ РїРѕ [&#60;Р’РљР—.&#34;Cod_Predm&#34;&#62;] [&#60;Р’РљР—.&#34;Name_Predm&#34;&#62;]:"/>
      <TfrxMemoView Name="Memo25" Left="623,62245" Top="0" Width="56,69291339" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="TrudQRY" DataSetName="TrudQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;TrudQRY.&#34;SmTrudByZ&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo26" Left="680,3154" Top="0" Width="37,79527559" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="TrudQRY" DataSetName="TrudQRY" DisplayFormat.FormatStr="%2.1n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[100*SUM(&#60;TrudQRY.&#34;SmTrudByZ&#34;&#62;)/SUM(FnTSm)]"/>
      <TfrxMemoView Name="Memo6" Left="415,7483" Top="0" Width="56,69291339" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="TrudQRY" DataSetName="TrudQRY" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;TrudQRY.&#34;Kolvo&#34;&#62;*&#60;TrudQRY.&#34;KontrTrud&#34;&#62;+&#60;TrudQRY.&#34;KontrTrudPZ&#34;&#62;)]"/>
    </TfrxFooter>
    <TfrxPageHeader Name="PageHeader1" Height="22,67718" Left="0" Top="16" Width="721,89023">
      <TfrxMemoView Name="Memo3" Left="0" Top="0" Width="718,1107" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="РЎРѕСЃС‚РѕСЏРЅРёРµ РёР·РіРѕС‚РѕРІР»РµРЅРёСЏ РЈР—Р›Рђ  [Р’РљР—.&#34;Cod_Predm&#34;] [Р’РљР—.&#34;Name_Predm&#34;]"/>
    </TfrxPageHeader>
  </TfrxReportPage>
</TfrxReport>
