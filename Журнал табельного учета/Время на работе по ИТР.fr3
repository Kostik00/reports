<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.15" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38513,0822621875" ReportOptions.Description.Text="" ReportOptions.Name="Время на работе по бригадам.fr3 Журнал табельного учета" ReportOptions.LastChange="42403,6145027662" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  PgSize:extended;&#13;&#10;  X:integer;                        &#13;&#10;  &#13;&#10;  &#13;&#10;procedure DateFromOnChange(Sender: TfrxComponent);&#13;&#10;var&#13;&#10; Y,M,D:word ;                               &#13;&#10;begin&#13;&#10;  DecodeDate(DateFrom.Date,Y,M,D);&#13;&#10;//  DateFrom.Date:=EncodeDate(Y,M,1);                                      &#13;&#10;  DateTo.Date:=EncodeDate(Y,M,DaysInMonth(Y,M));                                                              &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  PgSize:=Engine.FreeSpace;                                 &#13;&#10;  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupHeader2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if Engine.FreeSpace &#60; (PgSize/3) then&#13;&#10;    Engine.NewPage;                                 &#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupHeader3OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  X:=0;            &#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupFooter1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  X:=X+1;                  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Header1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Dialog1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10; x:=0;&#13;&#10; DateFrom.Date:=Date-1;                                                                                      &#13;&#10; DateTo.Date:=Date;                                                                                      &#13;&#10;       &#13;&#10;end." StoreInDFM="False" PropData="044C65667403800203546F70022008446174617365747301010C2900000020446174615365743D224D61696E46727844532220446174615365744E616D653D224D61696E44532200010C2A00000020446174615365743D2245525175657279312220446174615365744E616D653D224552517565727931220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="ERQuery1" UserName="ERQuery1" CloseDataSource="True" FieldAliases.Text="Name_Sub=Name_Sub&#13;&#10;Val_Str=Val_Str&#13;&#10;Key_Rekv=Key_Rekv&#13;&#10;DT_ENTER=DT_ENTER&#13;&#10;DT_EXIT=DT_EXIT&#13;&#10;T=T" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT DISTINCT                                      &#13;&#10;       S_Subjects.Name_Sub, &#13;&#10;       S_SubAtrib.Val_Str, &#13;&#10;       S_SubAtrib.Key_Rekv, &#13;&#10;       SKUD_InOut.DT_ENTER, &#13;&#10;       SKUD_InOut.DT_EXIT, &#13;&#10;       Convert(float,(SKUD_InOut.DT_EXIT - SKUD_InOut.DT_ENTER))*24 T&#13;&#10;FROM         &#13;&#10;	S_Subjects &#13;&#10;	INNER JOIN S_SubVer &#13;&#10;		ON S_Subjects.Key_Sub = S_SubVer.Key_Sub &#13;&#10;	INNER JOIN S_SubAtrib &#13;&#10;		 ON S_SubVer.Key_Sub = S_SubAtrib.Key_Sub &#13;&#10;		AND S_SubVer.Sub_Version = S_SubAtrib.Sub_Version &#13;&#10;	INNER JOIN SKUD_InOut &#13;&#10;		ON S_Subjects.cod_sub = SKUD_InOut.TABEL_ID&#13;&#10;WHERE     &#13;&#10;               (S_SubAtrib.Key_Rekv = 14) &#13;&#10;    AND (NOT ((S_SubAtrib.Val_Str LIKE 'бри%') OR(S_SubAtrib.Val_Str LIKE '%загото%') OR(S_SubAtrib.Val_Str LIKE '%участок%')))             &#13;&#10;    AND SKUD_InOut.DT_ENTER &#62;:Date_From&#13;&#10;    AND SKUD_InOut.DT_ENTER &#60;=:Date_To&#13;&#10;    AND S_SubVer.FL &#60;&#62; 1                              &#13;&#10;  &#13;&#10;ORDER BY S_SubAtrib.Val_Str, S_Subjects.Name_Sub, SKUD_InOut.DT_ENTER  " SQLSchema="eAGLdkksSXRKLE6N5eUKDvSxNTQwMjc1sbQwNuXlig5JTMpJLQbJ2AZ7h7rEe+b5l5boGJqCkJGBAZAyAKpyL8pMAaoxsA1xdHL1ifd00UFSHKxjqGMAhrZWzvkp8cGlSbxchrYuIfGufiGuQehKIYp5uYzAKiI8Q9AVQMwC2uqTmZcNchoAmSczOw==" PropData="05704C65667402280470546F70023C0A506172616D657465727301010C42000000204E616D653D22446174655F46726F6D222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746546726F6D2E446174652200010C3E000000204E616D653D22446174655F546F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D2244617465546F2E44617465220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="Dialog1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="265" ClientHeight="227" Left="328" Top="108" Width="369" ClientWidth="353" OnActivate="Dialog1OnActivate">
    <TfrxDateEditControl Name="DateFrom" Left="164" Top="40" Width="137" Height="21" ShowHint="True" Color="-16777211" Date="39845" Time="39845" WeekNumbers="False" OnChange="DateFromOnChange"/>
    <TfrxLabelControl Name="Label1" Left="80" Top="40" Width="41" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Дата:" Color="-16777201"/>
    <TfrxButtonControl Name="Button1" Left="232" Top="152" Width="75" Height="25" ShowHint="True" Caption="ОК" Default="True" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxDateEditControl Name="DateTo" Left="164" Top="80" Width="137" Height="21" ShowHint="True" Color="-16777211" Date="39872,9999884259" Time="39872,9999884259" WeekNumbers="False" OnChange="DateFromOnChange"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="5" RightMargin="5" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="100" Width="755,906" ColumnWidth="0" ColumnGap="0" DataSet="ERQuery1" DataSetName="ERQuery1" RowCount="0">
      <TfrxMemoView Name="Memo2" Left="109,60637" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" DataField="DT_ENTER" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="hh:mm" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[ERQuery1.&#34;DT_ENTER&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="185,19697" Top="0" Width="71,81107" Height="18,89765" ShowHint="False" DataField="DT_EXIT" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="hh:mm" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[ERQuery1.&#34;DT_EXIT&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="257,00804" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" DataField="T" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[ERQuery1.&#34;T&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="0" Top="0" Width="109,60637" Height="18,89765" ShowHint="False" DataField="DT_ENTER" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" SuppressRepeated="True" Text="[ERQuery1.&#34;DT_ENTER&#34;]"/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader1" Height="22,67718" Left="0" Top="16" Width="755,906" Condition="ERQuery1.&#34;Val_Str&#34;" OutlineText="ERQuery1.&#34;Val_Str&#34;">
      <TfrxMemoView Name="ERQuery1Val_Str" Left="0" Top="0" Width="336,37817" Height="22,67718" ShowHint="False" Color="13296895" DataField="Val_Str" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ERQuery1.&#34;Val_Str&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter1" Height="18,89765" Left="0" Top="180" Width="755,906">
      <TfrxMemoView Name="Memo9" Left="0" Top="0" Width="257,00804" Height="18,89765" ShowHint="False" Color="13408511" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="РС‚РѕРіРѕ РїРѕ [ERQuery1.&#34;Val_Str&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="257,00804" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" Color="13408511" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;ERQuery1.&#34;T&#34;&#62;)]"/>
    </TfrxGroupFooter>
    <TfrxGroupFooter Name="GroupFooter2" Height="18,89765" Left="0" Top="140" Width="755,906">
      <TfrxMemoView Name="Memo1" Left="257,00804" Top="0" Width="79,37013" Height="18,89765" ShowHint="False" Color="16774348" DataSet="ERQuery1" DataSetName="ERQuery1" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;ERQuery1.&#34;T&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo7" Left="0" Top="0" Width="257,00804" Height="18,89765" ShowHint="False" Color="16774348" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="РС‚РѕРіРѕ  [ERQuery1.&#34;Name_Sub&#34;]"/>
    </TfrxGroupFooter>
    <TfrxGroupHeader Name="GroupHeader2" Height="18,89765" Left="0" Top="60" Width="755,906" Condition="ERQuery1.&#34;Name_Sub&#34;">
      <TfrxMemoView Name="Memo6" Left="0" Top="0" Width="336,37817" Height="18,89765" ShowHint="False" Color="10218495" DataField="Name_Sub" DataSet="ERQuery1" DataSetName="ERQuery1" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ERQuery1.&#34;Name_Sub&#34;]"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
</TfrxReport>
