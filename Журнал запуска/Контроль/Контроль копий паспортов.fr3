<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.5.2" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42930,4044401736" ReportOptions.Description.Text="" ReportOptions.Name="Контроль копий паспортов.fr3 Журнал запуска" ReportOptions.LastChange="42937,4964564583" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;       SmPaspKolvo:integer;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure ERQuery1Key_ID_MatOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CopyQRYKey_PrSP_FromOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  CopyQRYKey_PrSP_From.Color:=clNone;&#13;&#10;  if &#60;Копии.&#34;Key_PrSP_From&#34;&#62; &#60;&#62; &#60;Паспорта.&#34;Key_PrSP&#34;&#62; then&#13;&#10;       CopyQRYKey_PrSP_From.Color:=clRed;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo10OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Memo10.Color:=clNone;&#13;&#10;  if SmPaspKolvo &#60;&#62; &#60;Паспорта.&#34;PaspKolvo&#34;&#62; then&#13;&#10;     Memo10.Color:=clRed;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupHeader2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  SmPaspKolvo:=SmPaspKolvo+&#60;Копии.&#34;PaspKolvo&#34;&#62;;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Header1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;         SmPaspKolvo :=0;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CopyQRYCod_ZakOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  CopyQRYCod_Zak.Color:=clNone;&#13;&#10;  if &#60;Паспорта.&#34;Cod_Zak&#34;&#62; &#60;&#62; &#60;Копии.&#34;Cod_Zak&#34;&#62; then&#13;&#10;    CopyQRYCod_Zak.Color:=clRed;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo8OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Memo8.Color:=clNone;&#13;&#10;  if &#60;Паспорта.&#34;Key_ID_Mat&#34;&#62; &#60;&#62; &#60;Копии.&#34;Key_ID_Mat&#34;&#62; then&#13;&#10;  Memo8.Color:=clRed;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure PAspStatusMemoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  PAspStatusMemo.Color:=clNone;&#13;&#10;  if &#60;Паспорта.&#34;Name_Pasp_Status&#34;&#62; = 'Приостанов (брак)'&#13;&#10;  then&#13;&#10;  PAspStatusMemo.Color:=clRed;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="PaspQRY" DataSetName="Паспорта"/>
    <item DataSet="CopyQRY" DataSetName="Копии"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="PaspQRY" UserName="Паспорта" CloseDataSource="True" FieldAliases.Text="Key_Pasp_From=Key_Pasp_From&#13;&#10;Cod_Pasp=Cod_Pasp&#13;&#10;Cod_Zak=Cod_Zak&#13;&#10;PaspKolvo=PaspKolvo&#13;&#10;Key_Predm=Key_Predm&#13;&#10;Cod_Predm=Cod_Predm&#13;&#10;Name_Predm=Name_Predm&#13;&#10;Key_PrSP=Key_PrSP&#13;&#10;Key_ID_Mat=Key_ID_Mat&#13;&#10;Name_Predm_Mat=Name_Predm_Mat&#13;&#10;Sortam_Mat=Sortam_Mat&#13;&#10;Marka_Mat=Marka_Mat&#13;&#10;Name_Pasp_Status=Name_Pasp_Status" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT        &#13;&#10;       PaspList.Key_Pasp_From, &#13;&#10;       Pr_Pasp_From.Cod_Pasp, &#13;&#10;       Pr_Pasp_From.Cod_Zak,&#13;&#10;       Pr_Pasp_From.PaspKolvo,                                 &#13;&#10;       T_VPredm.Key_Predm, &#13;&#10;       T_VPredm.Cod_Predm, &#13;&#10;       T_VPredm.Name_Predm, &#13;&#10;       Pr_SP.Key_PrSP, &#13;&#10;       Pr_SP.Key_ID_Mat,&#13;&#10;       T_VPredm_Mat.Name_Predm AS Name_Predm_Mat, &#13;&#10;       T_VPredm_Mat.Sortam AS Sortam_Mat, &#13;&#10;       T_VPredm_Mat.Marka AS Marka_Mat,&#13;&#10;       Pr_Pasp_Status.Name_Pasp_Status               &#13;&#10;FROM            &#13;&#10;  (&#13;&#10;  SELECT DISTINCT Key_Pasp_From&#13;&#10;                            FROM            Pr_Pasp&#13;&#10;  ) AS PaspList&#13;&#10;	INNER JOIN Pr_Pasp  AS Pr_Pasp_From &#13;&#10;		ON PaspList.Key_Pasp_From = Pr_Pasp_From.Key_Pasport &#13;&#10;	INNER JOIN T_VPredm &#13;&#10;		ON Pr_Pasp_From.Key_Predm = T_VPredm.Key_Predm&#13;&#10; INNER JOIN  Pr_Pasp_Status&#13;&#10;  ON Pr_Pasp_Status.Key_Pasp_Status = Pr_Pasp_From.Key_Pasp_Status                                             &#13;&#10;         &#13;&#10;	LEFT JOIN Pr_SP &#13;&#10;		ON Pr_Pasp_From.Key_Pasport = Pr_SP.Key_Pasport &#13;&#10;	LEFT JOIN A_VID_Mat &#13;&#10;		ON Pr_SP.Key_ID_Mat = A_VID_Mat.Key_ID_Mat &#13;&#10;	LEFT JOIN T_VPredm AS T_VPredm_Mat &#13;&#10;		ON A_VID_Mat.Key_Predm = T_VPredm_Mat.Key_Predm&#13;&#10;&#13;&#10;--WHERE T_VPredm.Cod_Prin = '00'                                              &#13;&#10;  &#13;&#10;ORDER BY T_VPredm.Cod_Predm, T_VPredm.Name_Predm , Pr_Pasp_From.Cod_Pasp                                                           " PropData="05704C656674024C0470546F7002300A506172616D65746572730100"/>
    <TfrxERQuery Name="CopyQRY" UserName="Копии" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="PaspQRY" IgnoreDupParams="False" SQL.Text="SELECT        &#13;&#10;       Pr_Pasp.Cod_Pasp, &#13;&#10;       Pr_Pasp.Cod_Zak,&#13;&#10;       Pr_Pasp.PaspKolvo,                                 &#13;&#10;       T_VPredm.Key_Predm, &#13;&#10;       T_VPredm.Cod_Predm, &#13;&#10;       T_VPredm.Name_Predm, &#13;&#10;       Pr_SP.Key_PrSP, &#13;&#10;       Pr_SP.Key_ID_Mat, &#13;&#10;       Pr_Pasp.Key_Pasp_From, &#13;&#10;       Pr_SP.Key_PrSP_From&#13;&#10;FROM            &#13;&#10;       Pr_Pasp AS Pr_Pasp &#13;&#10;       INNER JOIN     T_VPredm &#13;&#10;               ON Pr_Pasp.Key_Predm = T_VPredm.Key_Predm &#13;&#10;       LEFT JOIN  Pr_SP &#13;&#10;               ON Pr_Pasp.Key_Pasport = Pr_SP.Key_Pasport&#13;&#10;&#13;&#10;WHERE        (Pr_Pasp.Key_Pasp_From = :Key_Pasp_From )  " PropData="05704C65667403F8000470546F7002300A506172616D657465727301010C2A000000204E616D653D224B65795F506173705F46726F6D222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="16" Width="1046,92981"/>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="132" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="PaspQRY" DataSetName="Паспорта" RowCount="0">
      <TfrxMemoView Name="Memo2" Left="37,7953" Top="0" Width="79,37013" Height="18,89765" DataField="Key_PrSP" DataSet="PaspQRY" DataSetName="Паспорта" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Key_PrSP&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="117,16543" Top="0" Width="79,37013" Height="18,89765" DataField="Key_ID_Mat" DataSet="PaspQRY" DataSetName="Паспорта" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Key_ID_Mat&#34;]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="20" Left="0" Top="172" Width="1046,92981">
      <TfrxMemoView Name="Memo1" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="56,69295" Left="0" Top="56" Width="1046,92981" Condition="Паспорта.&#34;Key_Pasp_From&#34;" Stretched="True">
      <TfrxMemoView Name="Memo3" Left="0" Top="0" Width="264,5671" Height="18,89765" DataField="Cod_Pasp" DataSet="PaspQRY" DataSetName="Паспорта" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="16774348" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Cod_Pasp&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="264,5671" Top="0" Width="238,11039" Height="18,89765" DataField="Cod_Zak" DataSet="PaspQRY" DataSetName="Паспорта" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="16774348" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Cod_Zak&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="18,89765" Top="18,89765" Width="483,77984" Height="18,89765" DataSet="PaspQRY" DataSetName="Паспорта" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="16774348" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Cod_Predm&#34;] [РџР°СЃРїРѕСЂС‚Р°.&#34;Name_Predm&#34;]"/>
      <TfrxSubreport Name="Subreport1" Left="529,1342" Top="0" Width="94,48825" Height="18,89765" Page="Page2" PrintOnParent="True"/>
      <TfrxMemoView Name="Memo11" Left="423,30736" Top="37,7953" Width="79,37013" Height="18,89765" DataField="PaspKolvo" DataSet="PaspQRY" DataSetName="Паспорта" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434828" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;PaspKolvo&#34;]"/>
      <TfrxMemoView Name="PAspStatusMemo" Left="113,3859" Top="37,7953" Width="238,11039" Height="18,89765" OnBeforePrint="PAspStatusMemoOnBeforePrint" DataField="Name_Pasp_Status" DataSet="PaspQRY" DataSetName="Паспорта" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;Name_Pasp_Status&#34;]"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
  <TfrxReportPage Name="Page2" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page2OnBeforePrint">
    <TfrxMasterData Name="MasterData2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="120,94496" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="CopyQRY" DataSetName="Копии" RowCount="0">
      <TfrxMemoView Name="CopyQRYKey_PrSP_From" Left="370,39394" Top="0" Width="79,37013" Height="18,89765" OnBeforePrint="CopyQRYKey_PrSP_FromOnBeforePrint" DataField="Key_PrSP_From" DataSet="CopyQRY" DataSetName="Копии" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РљРѕРїРёРё.&#34;Key_PrSP_From&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="449,76407" Top="0" Width="79,37013" Height="18,89765" OnBeforePrint="Memo8OnBeforePrint" DataField="Key_ID_Mat" DataSet="CopyQRY" DataSetName="Копии" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РљРѕРїРёРё.&#34;Key_ID_Mat&#34;]"/>
    </TfrxMasterData>
    <TfrxFooter Name="Footer1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="162,51979" Width="1046,92981">
      <TfrxMemoView Name="Memo10" Left="0" Top="0" Width="79,37013" Height="18,89765" OnBeforePrint="Memo10OnBeforePrint" DataSet="CopyQRY" DataSetName="Копии" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[SmPaspKolvo]"/>
      <TfrxMemoView Name="Memo12" Left="79,37013" Top="0" Width="79,37013" Height="18,89765" DataField="PaspKolvo" DataSet="PaspQRY" DataSetName="Паспорта" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434828" ParentFont="False" Text="[РџР°СЃРїРѕСЂС‚Р°.&#34;PaspKolvo&#34;]"/>
    </TfrxFooter>
    <TfrxGroupHeader Name="GroupHeader2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="56,69295" Left="0" Top="41,57483" Width="1046,92981" OnBeforePrint="GroupHeader2OnBeforePrint" Condition="Копии.&#34;Cod_Pasp&#34;">
      <TfrxMemoView Name="Memo9" Left="37,7953" Top="37,7953" Width="79,37013" Height="18,89765" DataField="PaspKolvo" DataSet="CopyQRY" DataSetName="Копии" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РљРѕРїРёРё.&#34;PaspKolvo&#34;]"/>
      <TfrxMemoView Name="ERQuery1Cod_Pasp" Left="0" Top="0" Width="264,5671" Height="18,89765" DataField="Cod_Pasp" DataSet="CopyQRY" DataSetName="Копии" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РљРѕРїРёРё.&#34;Cod_Pasp&#34;]"/>
      <TfrxMemoView Name="CopyQRYCod_Zak" Left="264,5671" Top="0" Width="238,11039" Height="18,89765" OnBeforePrint="CopyQRYCod_ZakOnBeforePrint" DataField="Cod_Zak" DataSet="CopyQRY" DataSetName="Копии" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РљРѕРїРёРё.&#34;Cod_Zak&#34;]"/>
      <TfrxMemoView Name="ERQuery1Cod_Predm" Left="18,89765" Top="18,89765" Width="483,77984" Height="18,89765" DataSet="CopyQRY" DataSetName="Копии" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РљРѕРїРёРё.&#34;Cod_Predm&#34;] [РљРѕРїРёРё.&#34;Name_Predm&#34;]"/>
    </TfrxGroupHeader>
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="0" Left="0" Top="18,89765" Width="1046,92981" OnBeforePrint="Header1OnBeforePrint"/>
  </TfrxReportPage>
</TfrxReport>
