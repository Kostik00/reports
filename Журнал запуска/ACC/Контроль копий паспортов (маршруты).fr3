<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.5.2" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42935,4557179514" ReportOptions.Description.Text="" ReportOptions.Name="Контроль копий паспортов (маршруты).fr3 Журнал запуска" ReportOptions.LastChange="42940,5022242361" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;procedure OperFromMemoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  CASE    &#60;Маршрут.&#34;Status_Oper_From&#34;&#62; of&#13;&#10;  1:   BEGIN&#13;&#10;         OperFromMemo.Color:=$00CCFFFF;&#13;&#10;       END;&#13;&#10;  2:   BEGIN&#13;&#10;         OperFromMemo.Color:=$00CCFFCC;&#13;&#10;       END;&#13;&#10;  else&#13;&#10;   OperFromMemo.Color:=clNone&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MemoToOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  MemoFrom.Color:=clNone;&#13;&#10;  if &#60;Маршрут.&#34;Cod_Oper&#34;&#62; &#60;&#62; &#60;Маршрут.&#34;Cod_Oper_From&#34;&#62; then&#13;&#10;       MemoFrom.Color:=clRed;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure OperMemoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  CASE    &#60;Маршрут.&#34;Status_Oper&#34;&#62; of&#13;&#10;  1:   BEGIN&#13;&#10;         OperMemo.Color:=$00CCFFFF;&#13;&#10;       END;&#13;&#10;  2:   BEGIN&#13;&#10;         OperMemo.Color:=$00CCFFCC;&#13;&#10;       END;&#13;&#10;  else&#13;&#10;   OperMemo.Color:=clNone&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="ERQuery1" DataSetName="Маршрут"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="ERQuery1" UserName="Маршрут" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT        &#13;&#10;	Pr_Pasp.Key_Pasport, &#13;&#10;	Pr_Pasp.Cod_Pasp,&#13;&#10;&#13;&#10;	Pr_Pasp_From.Cod_Pasp Cod_Pasp_From,&#13;&#10;&#13;&#10;  &#13;&#10;	T_VPredm.Cod_Predm,&#13;&#10;	T_VPredm.Name_Predm,&#13;&#10;&#13;&#10;	T_VPredm_From.Cod_Predm Cod_Predm_From,&#13;&#10;	T_VPredm_From.Name_Predm Name_Predm_From,&#13;&#10;  &#13;&#10;  &#13;&#10;	Pr_Pasp.Key_Pasp_From, &#13;&#10;	Pr_Pasp_Rows.Key_Pasp_Rows, &#13;&#10;	Pr_Pasp_Rows.N_Oper_Sm,&#13;&#10;	Pr_Pasp_Rows_From.N_Oper_Sm N_Oper_Sm_From,         &#13;&#10;	Isnull( Pr_Pasp_Rows.N_Oper_Sm, Pr_Pasp_Rows_From.N_Oper_Sm )   OrderStr,                         &#13;&#10;&#13;&#10;	Pr_Pasp_Rows.Status_Oper,&#13;&#10;	Pr_Pasp_Rows_From.Status_Oper Status_Oper_From,&#13;&#10;  &#13;&#10;	Pr_Pasp_Rows.Cod_Oper,&#13;&#10;	Pr_Pasp_Rows_From.Cod_Oper Cod_Oper_From,                     &#13;&#10;	Pr_Pasp_Rows_From.Key_Pasp_Rows AS Key_Pasp_Rows_From,&#13;&#10;&#13;&#10; Pr_Pasp_Rows_From.AcDate  AcDateFrom,        &#13;&#10;&#13;&#10;  &#13;&#10;&#13;&#10;	T_Oper.Name_K_Oper,&#13;&#10;	T_Oper_From.Name_K_Oper Name_K_Oper_From&#13;&#10; ,Pr_Pasp_Rows_From.Key_Pasp_Rows Key_Pasp_Rows001&#13;&#10; ,FromTBL.key_pasp_rows_from     Key_Pasp_Rows001From                             &#13;&#10;   &#13;&#10;  &#13;&#10;FROM            &#13;&#10;	Pr_Pasp  &#13;&#10;	INNER JOIN T_VPredm&#13;&#10;		ON T_VPredm.Key_Predm = Pr_Pasp.Key_Predm&#13;&#10;	INNER JOIN Pr_Pasp AS Pr_Pasp_From &#13;&#10;		ON Pr_Pasp.Key_Pasp_From = Pr_Pasp_From.Key_Pasport &#13;&#10;&#13;&#10;	INNER JOIN T_VPredm T_VPredm_From&#13;&#10;		ON T_VPredm_From.Key_Predm = Pr_Pasp_From.Key_Predm&#13;&#10;&#13;&#10;&#13;&#10;	INNER JOIN Pr_Pasp_Rows &#13;&#10;		ON Pr_Pasp.Key_Pasport = Pr_Pasp_Rows.Key_Pasport &#13;&#10;	LEFT OUTER JOIN Pr_Pasp_Rows  AS Pr_Pasp_Rows_From &#13;&#10;		ON Pr_Pasp_From.Key_Pasport = Pr_Pasp_Rows_From.Key_Pasport &#13;&#10;		AND Pr_Pasp_Rows.N_Oper_Sm = Pr_Pasp_Rows_From.N_Oper_Sm &#13;&#10;&#13;&#10;	LEFT OUTER JOIN T_Oper&#13;&#10;		ON T_Oper.Cod_Oper = Pr_Pasp_Rows.Cod_Oper&#13;&#10;&#13;&#10;	LEFT OUTER JOIN T_Oper T_Oper_From&#13;&#10;		ON T_Oper_From.Cod_Oper = Pr_Pasp_Rows_From.Cod_Oper&#13;&#10;&#13;&#10; LEFT JOIN  Pr_Pasp_Rows_from FromTBL&#13;&#10;  ON FromTBL.Key_Pasp_Rows= Pr_Pasp_Rows.Key_Pasp_Rows                            &#13;&#10;   &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;WHERE        (Pr_Pasp.Key_Pasp_From IS NOT NULL)&#13;&#10;--			AND Pr_Pasp_Rows_From.Key_Pasp_Rows IS NULL&#13;&#10;--		AND   Isnull(Pr_Pasp_Rows.Cod_Oper,'/') &#60;&#62; Isnull(Pr_Pasp_Rows_From.Cod_Oper,'\')            &#13;&#10;  AND Pr_Pasp_Rows.TSm &#62;0                                 &#13;&#10;--  AND FromTBL.key_pasp_rows_from IS NULL                             &#13;&#10;  AND Pr_Pasp.Key_Pasp_Status&#60;&#62;6                                                 &#13;&#10;&#13;&#10;UNION&#13;&#10;&#13;&#10;&#13;&#10;SELECT        &#13;&#10;	Pr_Pasp.Key_Pasport, &#13;&#10;	Pr_Pasp.Cod_Pasp,&#13;&#10;&#13;&#10;	Pr_Pasp_From.Cod_Pasp Cod_Pasp_From,&#13;&#10;&#13;&#10;  &#13;&#10;	T_VPredm.Cod_Predm,&#13;&#10;	T_VPredm.Name_Predm,&#13;&#10;&#13;&#10;	T_VPredm_From.Cod_Predm Cod_Predm_From,&#13;&#10;	T_VPredm_From.Name_Predm Name_Predm_From,&#13;&#10;  &#13;&#10;  &#13;&#10;	Pr_Pasp.Key_Pasp_From, &#13;&#10;	Pr_Pasp_Rows.Key_Pasp_Rows, &#13;&#10;	Pr_Pasp_Rows.N_Oper_Sm,&#13;&#10;	Pr_Pasp_Rows_From.N_Oper_Sm N_Oper_Sm_From,         &#13;&#10;	Isnull( Pr_Pasp_Rows.N_Oper_Sm, Pr_Pasp_Rows_From.N_Oper_Sm )   OrderStr,                         &#13;&#10;  &#13;&#10; 	Pr_Pasp_Rows.Status_Oper,&#13;&#10;	Pr_Pasp_Rows_From.Status_Oper Status_Oper_From,&#13;&#10; &#13;&#10;	Pr_Pasp_Rows.Cod_Oper,&#13;&#10;	Pr_Pasp_Rows_From.Cod_Oper Cod_Oper_From,                     &#13;&#10;	Pr_Pasp_Rows_From.Key_Pasp_Rows AS Key_Pasp_Rows_From,&#13;&#10;&#13;&#10; Pr_Pasp_Rows_From.AcDate AcDateFrom,&#13;&#10;&#13;&#10;  &#13;&#10;	T_Oper.Name_K_Oper,&#13;&#10;	T_Oper_From.Name_K_Oper Name_K_Oper_From&#13;&#10;&#13;&#10;	,Pr_Pasp_Rows_From.Key_Pasp_Rows Key_Pasp_Rows001&#13;&#10;	,FromTBL.key_pasp_rows_from  &#13;&#10;FROM&#13;&#10;	Pr_Pasp  &#13;&#10;	INNER JOIN T_VPredm&#13;&#10;		ON T_VPredm.Key_Predm = Pr_Pasp.Key_Predm&#13;&#10;	INNER JOIN Pr_Pasp AS Pr_Pasp_From &#13;&#10;		ON Pr_Pasp.Key_Pasp_From = Pr_Pasp_From.Key_Pasport &#13;&#10;&#13;&#10;	INNER JOIN T_VPredm T_VPredm_From&#13;&#10;		ON T_VPredm_From.Key_Predm = Pr_Pasp_From.Key_Predm&#13;&#10;&#13;&#10;&#13;&#10;	INNER JOIN Pr_Pasp_Rows  AS Pr_Pasp_Rows_From &#13;&#10;		ON Pr_Pasp_From.Key_Pasport = Pr_Pasp_Rows_From.Key_Pasport &#13;&#10;&#13;&#10;	LEFT OUTER JOIN Pr_Pasp_Rows&#13;&#10;		ON Pr_Pasp.Key_Pasport = Pr_Pasp_Rows.Key_Pasport&#13;&#10;		AND Pr_Pasp_Rows.N_Oper_Sm = Pr_Pasp_Rows_From.N_Oper_Sm&#13;&#10;&#13;&#10;&#13;&#10;	LEFT OUTER JOIN T_Oper&#13;&#10;		ON T_Oper.Cod_Oper = Pr_Pasp_Rows.Cod_Oper&#13;&#10;&#13;&#10;	LEFT OUTER JOIN T_Oper T_Oper_From&#13;&#10;		ON T_Oper_From.Cod_Oper = Pr_Pasp_Rows_From.Cod_Oper&#13;&#10;&#13;&#10; LEFT JOIN  Pr_Pasp_Rows_from FromTBL&#13;&#10;  ON FromTBL.Key_Pasp_Rows= Pr_Pasp_Rows.Key_Pasp_Rows                            &#13;&#10;  &#13;&#10;WHERE        (Pr_Pasp.Key_Pasp_From IS NOT NULL)&#13;&#10;--			AND Pr_Pasp_Rows_From.Key_Pasp_Rows IS NULL&#13;&#10;--		AND   Isnull(Pr_Pasp_Rows.Cod_Oper,'/') &#60;&#62; Isnull(Pr_Pasp_Rows_From.Cod_Oper,'\')            &#13;&#10;  AND Pr_Pasp_Rows_From.TSm &#62;0&#13;&#10;--  AND FromTBL.key_pasp_rows_from IS NULL                             &#13;&#10;  AND Pr_Pasp.Key_Pasp_Status&#60;&#62;6                                                 &#13;&#10;    &#13;&#10;    &#13;&#10;ORDER BY Pr_Pasp.Key_Pasport, OrderStr          &#13;&#10;    &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;  " PropData="05704C656674024C0470546F7002400A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="18,89765" Width="718,1107"/>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="162,51979" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="ERQuery1" DataSetName="Маршрут" RowCount="0">
      <TfrxMemoView Name="OperMemo" Left="37,7953" Top="0" Width="75,5906" Height="18,89765" OnBeforePrint="OperMemoOnBeforePrint" DataField="N_Oper_Sm" DataSet="ERQuery1" DataSetName="Маршрут" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РњР°СЂС€СЂСѓС‚.&#34;N_Oper_Sm&#34;]"/>
      <TfrxMemoView Name="MemoFrom" Left="302,3624" Top="0" Width="170,07885" Height="18,89765" DataSet="ERQuery1" DataSetName="Маршрут" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РњР°СЂС€СЂСѓС‚.&#34;Cod_Oper&#34;] [РњР°СЂС€СЂСѓС‚.&#34;Name_K_Oper&#34;]"/>
      <TfrxMemoView Name="MemoTo" Left="472,44125" Top="0" Width="188,9765" Height="18,89765" OnBeforePrint="MemoToOnBeforePrint" DataSet="ERQuery1" DataSetName="Маршрут" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РњР°СЂС€СЂСѓС‚.&#34;Cod_Oper_From&#34;] [РњР°СЂС€СЂСѓС‚.&#34;Name_K_Oper_From&#34;]"/>
      <TfrxMemoView Name="OperFromMemo" Left="113,3859" Top="0" Width="75,5906" Height="18,89765" OnBeforePrint="OperFromMemoOnBeforePrint" DataField="N_Oper_Sm_From" DataSet="ERQuery1" DataSetName="Маршрут" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434828" ParentFont="False" Text="[РњР°СЂС€СЂСѓС‚.&#34;N_Oper_Sm_From&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="245,66945" Top="0" Width="56,69295" Height="18,89765" DataField="Key_Pasp_Rows001From" DataSet="ERQuery1" DataSetName="Маршрут" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РњР°СЂС€СЂСѓС‚.&#34;Key_Pasp_Rows001From&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="661,41775" Top="0" Width="56,69291339" Height="18,89765" DataField="Key_Pasp_Rows001" DataSet="ERQuery1" DataSetName="Маршрут" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РњР°СЂС€СЂСѓС‚.&#34;Key_Pasp_Rows001&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="188,9765" Top="0" Width="56,69295" Height="18,89765" DataField="AcDateFrom" DataSet="ERQuery1" DataSetName="Маршрут" DisplayFormat.FormatStr="dd.mm.yy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РњР°СЂС€СЂСѓС‚.&#34;AcDateFrom&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="3,77953" Top="0" Width="22,67718" Height="18,89765" DataField="Status_Oper" DataSet="ERQuery1" DataSetName="Маршрут" Text="[РњР°СЂС€СЂСѓС‚.&#34;Status_Oper&#34;]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="241,88992" Width="718,1107">
      <TfrxMemoView Name="Memo1" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="37,7953" Left="0" Top="102,04731" Width="718,1107" Condition="Маршрут.&#34;Key_Pasport&#34;">
      <TfrxMemoView Name="Memo2" Left="37,7953" Top="0" Width="226,7718" Height="18,89765" DataField="Cod_Pasp" DataSet="ERQuery1" DataSetName="Маршрут" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РњР°СЂС€СЂСѓС‚.&#34;Cod_Pasp&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="264,5671" Top="0" Width="400,63018" Height="18,89765" DataSet="ERQuery1" DataSetName="Маршрут" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РњР°СЂС€СЂСѓС‚.&#34;Cod_Predm&#34;] [РњР°СЂС€СЂСѓС‚.&#34;Name_Predm&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="75,5906" Top="18,89765" Width="226,7718" Height="18,89765" DataField="Cod_Pasp_From" DataSet="ERQuery1" DataSetName="Маршрут" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РњР°СЂС€СЂСѓС‚.&#34;Cod_Pasp_From&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="302,3624" Top="18,89765" Width="400,63018" Height="18,89765" DataSet="ERQuery1" DataSetName="Маршрут" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[РњР°СЂС€СЂСѓС‚.&#34;Cod_Predm_From&#34;] [РњР°СЂС€СЂСѓС‚.&#34;Name_Predm_From&#34;]">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo10" Left="0" Top="0" Width="37,7953" Height="18,89765" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[Line]"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
</TfrxReport>
