<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.5.2" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38548,9924498958" ReportOptions.Description.Text="" ReportOptions.Name="Ïëàí 1-ãî óðîâíÿ çà ïåðèîä.fr3 Ñïèñîê Äîãîâîðîâ" ReportOptions.LastChange="42872,7073987153" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;&#13;&#10;procedure FMemoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  FMemo.Color :=clNone;&#13;&#10;&#13;&#10;  if &#60;Ïëàí.&#34;DateP&#34;&#62; &#60;= &#60;Date&#62; then&#13;&#10;  begin&#13;&#10;     FMemo.Color := $0080FF80;&#13;&#10;    if &#60;Ïëàí.&#34;DtF&#34;&#62; = 0 then&#13;&#10;    begin&#13;&#10;      FMemo.Color :=  $008080FF;&#13;&#10;    end&#13;&#10;    else&#13;&#10;    begin&#13;&#10;      if &#60;Ïëàí.&#34;DtF&#34;&#62;  &#62; &#60;Ïëàí.&#34;DateP&#34;&#62; then&#13;&#10;      begin&#13;&#10;          FMemo.Color :=  $0080FFFF ;&#13;&#10;      end;&#13;&#10;    end;&#13;&#10;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;function FnDiff:integer;&#13;&#10;begin&#13;&#10;  Result:=0;&#13;&#10;  if &#60;Ïëàí.&#34;DtF&#34;&#62; = 0 then&#13;&#10;  begin&#13;&#10;    Result:= &#60;Date&#62; - &#60;Ïëàí.&#34;DateP&#34;&#62; ;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10;  DateFrom.Date:=Date;&#13;&#10;  DateTo.Date:=Date;&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="Plan" DataSetName="Ïëàí"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="Plan" UserName="Ïëàí" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT  DISTINCT                                       &#13;&#10;       D_VPlan.Key_DocType, &#13;&#10;       D_VPlan.Cod_Dogov, &#13;&#10;       D_PlanAdInfo.Ad_Info, &#13;&#10;       D_DocType.PlanName, &#13;&#10;       S_Subjects.Name_Sub, &#13;&#10;       D_VPlan.DateP, &#13;&#10;       D_VProduct.Cod_ByDog,&#13;&#10;       D_VProduct.Name_ByDog, &#13;&#10;       IsNull(T_VPredm.Cod_Predm,T_VPredm_Izdel.Cod_Predm)  Cod_Predm, &#13;&#10;       IsNull(T_VPredm.Name_Predm, T_VPredm_Izdel.Name_Predm) Name_Predm,&#13;&#10;       dbo.D_GetIspDate(D_VPlan.Key_DocType, D_VPlan.Key_Product , D_VPlan.Ad_Cod, D_VPlan.Key_Isp ) DtF,&#13;&#10;       D_VProduct.PriceSm *  dbo.D_FnGetKurs(D_VDogovor.Cod_Val,GetDate())  PriceSm,&#13;&#10;       D_PlanAdInfo.K_Sm,&#13;&#10;       Convert(varchar,D_VPlan.DateP, 112) DTStr&#13;&#10;&#13;&#10;       ,dbo.S_GegSubVerAtrib(S_Subjects.Key_Sub_Ver,18)  OtvFIO                                              &#13;&#10;         &#13;&#10;                  &#13;&#10;&#13;&#10;         &#13;&#10;FROM         &#13;&#10;       D_VPlan &#13;&#10;       INNER JOIN  D_PlanAdInfo &#13;&#10;               ON D_VPlan.Ad_Cod = D_PlanAdInfo.Ad_Cod &#13;&#10;       INNER JOIN D_DocType &#13;&#10;               ON D_VPlan.Key_DocType = D_DocType.Key_DocType &#13;&#10;       INNER JOIN S_VCurSub S_Subjects &#13;&#10;               ON D_VPlan.Key_Isp = S_Subjects.Key_Sub &#13;&#10;       INNER JOIN D_VProduct &#13;&#10;               ON D_VPlan.Key_Product = D_VProduct.Key_Product &#13;&#10;       INNER JOIN T_VPredm AS T_VPredm_Izdel &#13;&#10;               ON D_VProduct.Key_Izdel = T_VPredm_Izdel.Key_Predm &#13;&#10;       LEFT OUTER JOIN T_VPredm &#13;&#10;               ON D_VPlan.Key_Predm = T_VPredm.Key_Predm&#13;&#10;       INNER JOIN D_VDogovor&#13;&#10;               ON D_VDogovor.Cod_Dogov= D_VProduct.Cod_Dogov                                                                                      &#13;&#10;WHERE     &#13;&#10;           (D_VPlan.Key_DocType = 3) &#13;&#10;       AND (D_VPlan.DateP IS NOT NULL)&#13;&#10;       AND&#13;&#10;       (&#13;&#10;         (&#13;&#10;               D_VPlan.DateP &#62;= :DateFrom&#13;&#10;               AND &#13;&#10;               D_VPlan.DateP &#60;= :DateTo&#13;&#10;          )&#13;&#10;--       OR(&#13;&#10;--              dbo.D_GetIspDate(D_VPlan.Key_DocType, D_VPlan.Key_Product , D_VPlan.Ad_Cod, D_VPlan.Key_Isp ) &#62;= :DateFrom                                                       &#13;&#10;--           AND&#13;&#10;--              dbo.D_GetIspDate(D_VPlan.Key_DocType, D_VPlan.Key_Product , D_VPlan.Ad_Cod, D_VPlan.Key_Isp ) &#60;= :DateTo&#13;&#10;--         )&#13;&#10;       )&#13;&#10;           &#13;&#10;ORDER BY &#13;&#10;       S_Subjects.Name_Sub, &#13;&#10;       D_DocType.PlanName, &#13;&#10;       D_VPlan.DateP" SQLSchema="eAF9UtFqq0AQfRf8k3nY2V01PuxD26WX0lJSlLyEi9jovbQ3iSWaQv7+nlk1WChFWV3OnDNzZmbr66G+rfv2dxwVL0/Oss70yirDcbQt69d92wPxzleb9b4+EifyaqPxUaC4oirOr+/tbuiJUwqAsiPoGTTf7crLR0srssyU8wRpQCJ40zwc/3TEqxxcRVopyEDYGwRs1qeuOe8GYs5B12R0Cn4eR6UrUdCpbQ6gUorMRmeAhGmF6bu/3Wd3AstCmElbYQIueCx50wJMUrLZlDUBuP11emvgV7nH9lI99B80+/bEpMITR+zuuqYKGb7gY0Qc6cCejS8V5gjjxPtzfWghcA1Eb0IGRXEEE/XQrgGPfZf8MztxN00V2uYr0Zl66DGTKz91xVAP5/6LwGwgCwZuL7AQ8KnL3ixMrpyUV/0clLvHbv/ZBRHZDqlyTsLKFYfvkbGB6zC+6xzLRXLW7r4K+bFcFFZM5lUsO8RmrPAaMS5hsZDZPr0d/8n+KpeiMxNbBpiFq8GJqWun8YMdwYmrcSwemJLxbp3FD5OcgBPHwmMSSdxTaGO3SCRx/Q9SAdZr" PropData="05704C65667402380470546F7002180A506172616D657465727301010C41000000204E616D653D224461746546726F6D222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746546726F6D2E446174652200010C3D000000204E616D653D2244617465546F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D2244617465546F2E44617465220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Height="182" ClientHeight="143" Left="366" Top="150" Width="300" ClientWidth="284">
    <TfrxDateEditControl Name="DateTo" Left="120" Top="60" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="41078,9999884259" Time="41078,9999884259" WeekNumbers="False"/>
    <TfrxButtonControl Name="Ok" Left="192" Top="104" Width="75" Height="25" ShowHint="True" Caption="Ok" ModalResult="1"/>
    <TfrxDateEditControl Name="DateFrom" Left="120" Top="24" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="41078" Time="41078" WeekNumbers="False"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="PlanData" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="419,52783" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="Plan" DataSetName="Ïëàí" KeepFooter="True" KeepHeader="True" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo3" Left="287,24428" Top="0" Width="113,3859" Height="18,89765" StretchMode="smMaxHeight" DataField="DateP" DataSet="Plan" DataSetName="Ïëàí" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[ÐŸÐ»Ð°Ð½.&#34;DateP&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="400,63018" Top="0" Width="158,74026" Height="18,89765" StretchMode="smMaxHeight" DataSet="Plan" DataSetName="Ïëàí" Frame.Typ="15" VAlign="vaCenter" Text="[ÐŸÐ»Ð°Ð½.&#34;Ad_Info&#34;] ([ÐŸÐ»Ð°Ð½.&#34;Cod_Predm&#34;])"/>
      <TfrxMemoView Name="Memo5" Left="0" Top="0" Width="287,24428" Height="18,89765" StretchMode="smMaxHeight" DataSet="Plan" DataSetName="Ïëàí" Frame.Typ="15" VAlign="vaCenter" Text="[ÐŸÐ»Ð°Ð½.&#34;Cod_ByDog&#34;] - [ÐŸÐ»Ð°Ð½.&#34;Name_ByDog&#34;]"/>
      <TfrxMemoView Name="FMemo" Left="559,37044" Top="0" Width="79,37013" Height="18,89765" OnBeforePrint="FMemoOnBeforePrint" StretchMode="smMaxHeight" DataField="DtF" DataSet="Plan" DataSetName="Ïëàí" Frame.Typ="15" Fill.BackColor="8454016" HideZeros="True" VAlign="vaCenter" Text="[ÐŸÐ»Ð°Ð½.&#34;DtF&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="638,74057" Top="0" Width="79,37013" Height="18,89765" StretchMode="smMaxHeight" DataSet="Plan" DataSetName="Ïëàí" DisplayFormat.FormatStr="%2.0f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[FnDiff]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="597,16574" Width="718,1107">
      <TfrxMemoView Name="Memo1" Left="642,099312326667" Top="0" Width="75,5906" Height="18,89765" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="OtvHeader" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="37,7953" Left="0" Top="275,90569" Width="718,1107" Condition="Ïëàí.&#34;Name_Sub&#34;" OutlineText="Ïëàí.&#34;Name_Sub&#34;">
      <TfrxMemoView Name="Memo10" Left="0" Top="0" Width="718,1107" Height="37,7953" DataSet="Plan" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐŸÐ»Ð°Ð½ &#34;[ÐŸÐ»Ð°Ð½.&#34;PlanName&#34;]&#34;  Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹:  [ÐŸÐ»Ð°Ð½.&#34;OtvFIO&#34;] ([ÐŸÐ»Ð°Ð½.&#34;Name_Sub&#34;])">
        <Formats>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="PlanFooter" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18,89765" Left="0" Top="461,10266" Width="718,1107" Stretched="True">
      <TfrxMemoView Name="Memo13" Left="638,74057" Top="0" Width="79,37013" Height="18,89765" StretchMode="smMaxHeight" DataSet="Plan" DataSetName="Ïëàí" DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434879" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo16" Left="0" Top="0" Width="638,74057" Height="18,89765" DataSet="Plan" DataSetName="Ïëàí" DisplayFormat.FormatStr="mmmm yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="13434879" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½.&#34;DateP&#34;]"/>
    </TfrxGroupFooter>
    <TfrxGroupHeader Name="PlaanHeader" Description="Ïëàí.&#34;PlanName&#34;" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="60,47248" Left="0" Top="336,37817" Width="718,1107" Condition="Copy(&#60;Ïëàí.&#34;DTStr&#34;&#62;,1,6)" OutlineText="Copy(&#60;Ïëàí.&#34;DTStr&#34;&#62;,1,6)">
      <TfrxMemoView Name="Memo2" Left="287,24428" Top="34,01577" Width="113,3859" Height="26,45671" StretchMode="smMaxHeight" DataSet="Plan" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐŸÐ»Ð°Ð½Ð¾Ð²Ð°Ñ Ð´Ð°Ñ‚Ð°"/>
      <TfrxMemoView Name="Memo8" Left="400,63018" Top="34,01577" Width="158,74026" Height="26,45671" StretchMode="smMaxHeight" DataSet="Plan" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐŸÐ»Ð°Ð½. ÑÑ‚Ð°Ð¿"/>
      <TfrxMemoView Name="Memo9" Left="0" Top="34,01577" Width="287,24428" Height="26,45671" StretchMode="smMaxHeight" DataSet="Plan" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐžÐ±Ð¾Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð”Ð¡Ð•"/>
      <TfrxMemoView Name="Memo11" Left="559,37044" Top="34,01577" Width="79,37013" Height="26,45671" StretchMode="smMaxHeight" DataSet="Plan" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="Ð”Ð°Ñ‚Ð° Ð¤Ð°ÐºÑ‚"/>
      <TfrxMemoView Name="Memo12" Left="638,74057" Top="34,01577" Width="79,37013" Height="26,45671" StretchMode="smMaxHeight" DataSet="Plan" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="Ð¡Ñ€Ñ‹Ð² ÑÑ€Ð¾ÐºÐ°"/>
      <TfrxMemoView Name="Memo15" Left="0" Top="15,11812" Width="718,1107" Height="18,89765" DataSet="Plan" DataSetName="Ïëàí" DisplayFormat.FormatStr="mmmm yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Fill.BackColor="13434879" ParentFont="False" Text="[ÐŸÐ»Ð°Ð½.&#34;DateP&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="OtvFooter" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="34,01577" Left="0" Top="502,67749" Width="718,1107" Stretched="True">
      <TfrxMemoView Name="Memo14" Left="638,74057" Top="0" Width="79,37013" Height="18,89765" StretchMode="smMaxHeight" DataSet="Plan" DataSetName="Ïëàí" DisplayFormat.FormatStr="%2.0n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Fill.BackColor="16774348" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo17" Left="0" Top="0" Width="638,74057" Height="18,89765" DataSet="Plan" DataSetName="Ïëàí" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="16774348" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="Ð˜Ñ‚Ð¾Ð³Ð¾  Ð¿Ð¾ Ð¾Ñ‚Ð´ÐµÐ»Ñƒ  [ÐŸÐ»Ð°Ð½.&#34;Name_Sub&#34;] Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ñ [DateFrom.Date #ddd.mm.yyyy] Ð¿Ð¾ [DateTo.Date #ddd.mm.yyyy]"/>
    </TfrxGroupFooter>
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="196,53556" Left="0" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo6" Align="baWidth" Left="0" Top="139,84261" Width="718,1107" Height="56,69295" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text="     Ð”Ð¾Ð²Ð¾Ð¶Ñƒ Ð´Ð¾ Ð²Ð°ÑˆÐµÐ³Ð¾ ÑÐ²ÐµÐ´ÐµÐ½Ð¸Ñ, Ñ‡Ñ‚Ð¾ Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ñ [DateFrom.Date] Ð¿Ð¾ [DateTo.Date] ÑÐ¾Ð³Ð»Ð°ÑÐ½Ð¾ Ð¿Ð»Ð°Ð½Ñƒ 1-Ð³Ð¾ ÑƒÑ€Ð¾Ð²Ð½Ñ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ñ‹ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ ÑÑ‚Ð°Ð¿Ñ‹ Ñ€Ð°Ð±Ð¾Ñ‚:">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo18" Left="480,00031" Top="0" Width="238,11039" Height="98,26778" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text="Ð”Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ñƒ [MyReadProp('ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸')]&#13;&#10;Ð¾Ñ‚ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¸ÐºÐ° ÐŸÐ Ð‘ Ð¥Ð°Ð»Ð¸ÐºÐ¾Ð²Ð° Ð.Ð¥"/>
      <TfrxMemoView Name="Memo19" Align="baWidth" Left="0" Top="105,82684" Width="718,1107" Height="22,67718" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð”Ð¾ÐºÐ»Ð°Ð´Ð½Ð°Ñ Ð·Ð°Ð¿Ð¸ÑÐºÐ°">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxReportTitle>
  </TfrxReportPage>
</TfrxReport>
