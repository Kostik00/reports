<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="6.9.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="44357,4635479861" ReportOptions.Description.Text="" ReportOptions.Name="Список сотрудников по подразделениям (verr. 2.2.2.4).fr3 Справочник субъектов" ReportOptions.LastChange="44358,4133793171" ReportOptions.VersionBuild="5" ReportOptions.VersionMajor="2" ReportOptions.VersionMinor="3" ReportOptions.VersionRelease="3" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;procedure SetEmpList;&#13;&#10;begin&#13;&#10;  if qEmp.Active then qEmp.Close;&#13;&#10;  qEmp.Open;&#13;&#10;  qEmp.First;&#13;&#10;  clbEmp.Items.Clear;&#13;&#10;  while not qEmp.Eof&#13;&#10;    do begin&#13;&#10;      clbEmp.Items.Add(FormatFloat('0#', qEmp.RecNo+1)+' '+&#60;dsEmp.&#34;cod_sub&#34;&#62;+' '+&#60;dsEmp.&#34;F_Name_Sub&#34;&#62;);&#13;&#10;      qEmp.Next;&#13;&#10;    end;&#13;&#10;  qEmp.Close;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  SetEmpList;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnDeactivate(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  i: Integer = 0;&#13;&#10;  sTmp: String = '';&#13;&#10;begin&#13;&#10;  if DialogPage1.ModalResult = mrOk&#13;&#10;    then begin&#13;&#10;      for i:=0 to clbEmp.Items.Count-1&#13;&#10;        do begin&#13;&#10;          if clbEmp.Checked[i]&#13;&#10;            then begin&#13;&#10;              if sTmp = ''&#13;&#10;                then sTmp:=''''+Copy(clbEmp.Items.Strings[i], 4, 4)+''''&#13;&#10;                else sTmp:=sTmp+', '''+Copy(clbEmp.Items.Strings[i], 4, 4)+'''';&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;      if sTmp = ''&#13;&#10;        then DialogPage1.ModalResult:=mrCancel&#13;&#10;        else qMain.SQL.Strings[15]:=sTmp&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;{      for i:=0 to clbEmp.Items.Count-1&#13;&#10;        do begin&#13;&#10;          if clbEmp.Checked[i]&#13;&#10;            then begin&#13;&#10;              if sTmp = ''&#13;&#10;                then sTmp:=''''+Copy(clbEmp.Items.Strings[i], 1, 4)+''''&#13;&#10;                else sTmp:=sTmp+', '''+Copy(clbEmp.Items.Strings[i], 1, 4)+'''';&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;      ShowMessage('sTmp:'+#10+sTmp);  }&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DBLookupComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  SetEmpList;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="qEmp" DataSetName="dsEmp"/>
    <item DataSet="qMain" DataSetName="dsMain"/>
    <item DataSet="qDep" DataSetName="dsDep"/>
  </Datasets>
  <TfrxDataPage Name="Data" HGuides.Text="" VGuides.Text="" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="qEmp" UserName="dsEmp" CloseDataSource="False" FieldAliases.Text="cod_sub=cod_sub&#13;&#10;Key_Sub=Key_Sub&#13;&#10;F_Name_Sub=F_Name_Sub&#13;&#10;Fl=Fl&#13;&#10;Val_Str=Val_Str&#13;&#10;Val_Key_Sub_Ver=Val_Key_Sub_Ver" BCDToCurrency="False" Master="qDep" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;     [S].[cod_sub],&#13;&#10;     [S].[Key_Sub],&#13;&#10;     [S].[F_Name_Sub],&#13;&#10;     [S].[Fl],&#13;&#10;    [SA].[Val_Str],&#13;&#10;    [SA].[Val_Key_Sub_Ver]  &#13;&#10;  FROM&#13;&#10;    [S_ALL_Sub] AS [S]&#13;&#10;      INNER JOIN [S_SubAtrib] AS [SA] ON [SA].[Key_Sub] = [S].[Key_Sub] AND [SA].[Sub_Version] = [S].[Sub_Version] AND [SA].Key_Rekv = 17&#13;&#10;  WHERE&#13;&#10;            [S].[Key_Class] = 5&#13;&#10;    AND     [S].[FL] = 0&#13;&#10;    AND NOT [S].[cod_sub] IS NULL&#13;&#10;    AND NOT dbo.TRIM([S].[cod_sub]) = ''&#13;&#10;    AND     [SA].Val_Key_Sub_Ver in (SELECT [SV].[Key_Sub_Ver] FROM [S_SubVer] AS [SV] WHERE [SV].Key_Sub = :Key_Sub AND [SV].Fl = 0)      &#13;&#10;  ORDER BY&#13;&#10;    [S].[F_Name_Sub] ASC;    " PropData="05704C65667403CC000470546F7003A0000A506172616D657465727301010C53000000204E616D653D224B65795F537562222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B64734465702E262333343B4B65795F537562262333343B262336323B220000"/>
    <TfrxERQuery Name="qMain" UserName="dsMain" CloseDataSource="False" FieldAliases.Text="Key_Sub=Key_Sub&#13;&#10;cod_sub=cod_sub&#13;&#10;Key_Sub_Ver=Key_Sub_Ver&#13;&#10;Sub_Version=Sub_Version&#13;&#10;F_Name_Sub=F_Name_Sub&#13;&#10;DEP=DEP&#13;&#10;CAT=CAT&#13;&#10;PROF=PROF" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;    [S].Key_Sub,&#13;&#10;    ISNULL([S].cod_sub, '') AS cod_sub,&#13;&#10;    [S].Key_Sub_Ver,&#13;&#10;    [S].Sub_Version,&#13;&#10;    [S].F_Name_Sub,&#13;&#10;    ISNULL((SELECT dbo.TRIM([SA].[Val_Str]) FROM [S_SubAtrib] AS [SA] WHERE [SA].[Key_Sub] = [S].[Key_Sub] AND [SA].[Sub_Version] = [S].[Sub_Version] AND [SA].Key_Rekv = 17), '') AS DEP,&#13;&#10;    ISNULL((SELECT dbo.TRIM([SA].[Val_Str]) FROM [S_SubAtrib] AS [SA] WHERE [SA].[Key_Sub] = [S].[Key_Sub] AND [SA].[Sub_Version] = [S].[Sub_Version] AND [SA].Key_Rekv = 16), '') AS CAT,&#13;&#10;    ISNULL((SELECT dbo.TRIM([SA].[Val_Str]) FROM [S_SubAtrib] AS [SA] WHERE [SA].[Key_Sub] = [S].[Key_Sub] AND [SA].[Sub_Version] = [S].[Sub_Version] AND [SA].Key_Rekv = 9), '')  AS PROF      &#13;&#10;  FROM&#13;&#10;    [S_ALL_Sub] AS [S]&#13;&#10;  WHERE&#13;&#10;        [S].[Key_Class] = 5 AND [S].Fl = 0 &#13;&#10;    AND [S].cod_sub in&#13;&#10;        (&#13;&#10;        '1032', '1474', '0948', '0799', '1180'&#13;&#10;        )&#13;&#10;  ORDER BY [S].F_Name_Sub;  " PropData="05704C6566740388000470546F7002300A506172616D65746572730100"/>
    <TfrxERQuery Name="qDep" UserName="dsDep" CloseDataSource="False" FieldAliases.Text="Key_Sub=Key_Sub&#13;&#10;cod_sub=cod_sub&#13;&#10;Key_Class=Key_Class&#13;&#10;Name_Sub=Name_Sub&#13;&#10;Key_Sub_Ver_DF=Key_Sub_Ver_DF" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;    [S].[Key_Sub],&#13;&#10;    [S].[cod_sub],&#13;&#10;    [S].[Key_Class],&#13;&#10;    [S].[Name_Sub],&#13;&#10;    [S].[Key_Sub_Ver_DF]  &#13;&#10;  FROM&#13;&#10;    [S_Subjects] AS [S]&#13;&#10;  WHERE&#13;&#10;    [S].[Key_Class] = 1&#13;&#10;  ORDER BY&#13;&#10;    [S].[Name_Sub];  " PropData="05704C65667402540470546F700390000A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" HGuides.Text="" VGuides.Text="" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" Frame.Typ="0" MirrorMode="0">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Font.Charset="1" Font.Color="16777215" Font.Height="-11" Font.Name="Arial" Font.Style="1" Height="15,11811024" Left="0" ParentFont="False" Top="16" Width="718,1107">
      <TfrxMemoView Name="Memo2" IndexTag="1" AllowVectorExport="True" Left="37,7953" Top="0" Width="45,35436" Height="15,11811024" DataSet="qMain" DataSetName="dsMain" Font.Charset="1" Font.Color="16777215" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Frame.Width="2" Fill.BackColor="8421504" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РўР°Р±. в„–"/>
      <TfrxMemoView Name="Memo3" IndexTag="1" AllowVectorExport="True" Left="83,14966" Top="0" Width="188,9765" Height="15,11811024" DataSet="qMain" DataSetName="dsMain" Font.Charset="1" Font.Color="16777215" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Frame.Width="2" Fill.BackColor="8421504" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р¤.Р.Рћ."/>
      <TfrxMemoView Name="Memo4" IndexTag="1" AllowVectorExport="True" Left="272,12616" Top="0" Width="207,87401575" Height="15,11811024" DataSet="qMain" DataSetName="dsMain" Font.Charset="1" Font.Color="16777215" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Frame.Width="2" Fill.BackColor="8421504" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџРћР”Р РђР—Р”Р•Р›Р•РќРР•"/>
      <TfrxMemoView Name="Memo5" IndexTag="1" AllowVectorExport="True" Left="510,23655" Top="0" Width="207,87401575" Height="15,11811024" DataSet="qMain" DataSetName="dsMain" Font.Charset="1" Font.Color="16777215" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Frame.Width="2" Fill.BackColor="8421504" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџР РћР¤Р•РЎРЎРРЇ"/>
      <TfrxMemoView Name="Memo8" IndexTag="1" AllowVectorExport="True" Left="0" Top="0" Width="37,7953" Height="15,11811024" DataSet="qMain" DataSetName="dsMain" Font.Charset="1" Font.Color="16777215" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Frame.Width="2" Fill.BackColor="8421504" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„–"/>
      <TfrxMemoView Name="Memo9" IndexTag="1" AllowVectorExport="True" Left="480,00031" Top="0" Width="30,23610575" Height="15,11811024" DataSet="qMain" DataSetName="dsMain" Font.Charset="1" Font.Color="16777215" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Frame.Width="2" Fill.BackColor="8421504" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљвЂ“Рў"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Height="15,11811024" Left="0" ParentFont="False" Top="56" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="qMain" DataSetName="dsMain" RowCount="0">
      <TfrxMemoView Name="Memo6" AllowVectorExport="True" Left="0" Top="0" Width="718,1107" Height="15,11811024" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" Fill.BackColor="15790320" ParentFont="False" Text="">
        <Highlights>
          <item ApplyFont="False" Font.Charset="1" Font.Color="255" Font.Height="-13" Font.Name="Arial" Font.Style="0" Condition="&#60;Line&#62; mod 2 = 1" FillType="ftBrush" Frame.Typ="0" uin="1"/>
          <item ApplyFont="False" Font.Charset="1" Font.Color="255" Font.Height="-13" Font.Name="Arial" Font.Style="0" Condition="&#60;Line&#62; mod 2 = 0" FillType="ftBrush" Fill.BackColor="15790320" Frame.Typ="0" uin="2"/>
        </Highlights>
      </TfrxMemoView>
      <TfrxMemoView Name="dsMaincod_sub" IndexTag="1" AllowVectorExport="True" Left="37,7953" Top="0" Width="45,35436" Height="15,11811024" DataSet="qMain" DataSetName="dsMain" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Color="16777215" Frame.Typ="15" Frame.Width="2" HAlign="haCenter" ParentFont="False" Text="[dsMain.&#34;cod_sub&#34;]">
        <Highlights>
          <item ApplyFont="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Condition="&#60;Line&#62; mod 2 = 1" FillType="ftBrush" Frame.Typ="0" uin="1"/>
          <item ApplyFont="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Condition="&#60;Line&#62; mod 2 = 0" FillType="ftBrush" Fill.BackColor="15790320" Frame.Typ="0" uin="2"/>
        </Highlights>
      </TfrxMemoView>
      <TfrxMemoView Name="dsMainF_Name_Sub" IndexTag="1" AllowVectorExport="True" Left="83,14966" Top="0" Width="188,9765" Height="15,11811024" DataField="F_Name_Sub" DataSet="qMain" DataSetName="dsMain" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Color="16777215" Frame.Typ="15" Frame.Width="2" ParentFont="False" Text="[dsMain.&#34;F_Name_Sub&#34;]"/>
      <TfrxMemoView Name="dsMainDEP" IndexTag="1" AllowVectorExport="True" Left="272,12616" Top="0" Width="207,87401575" Height="15,11811024" DataField="DEP" DataSet="qMain" DataSetName="dsMain" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Color="16777215" Frame.Typ="15" Frame.Width="2" ParentFont="False" Text="[dsMain.&#34;DEP&#34;]"/>
      <TfrxMemoView Name="dsMainPROF" IndexTag="1" AllowVectorExport="True" Left="510,23655" Top="0" Width="207,87401575" Height="15,11811024" DataField="PROF" DataSet="qMain" DataSetName="dsMain" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Color="16777215" Frame.Typ="15" Frame.Width="2" ParentFont="False" Text="[dsMain.&#34;PROF&#34;]"/>
      <TfrxMemoView Name="Memo7" IndexTag="1" AllowVectorExport="True" Left="0" Top="0" Width="37,7953" Height="15,11811024" DataSet="qMain" DataSetName="dsMain" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Color="16777215" Frame.Typ="15" Frame.Width="2" HAlign="haRight" ParentFont="False" Text="[Line]">
        <Highlights>
          <item ApplyFont="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Condition="&#60;Line&#62; mod 2 = 1" FillType="ftBrush" Frame.Typ="0" uin="1"/>
          <item ApplyFont="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Condition="&#60;Line&#62; mod 2 = 0" FillType="ftBrush" Fill.BackColor="15790320" Frame.Typ="0" uin="2"/>
        </Highlights>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo10" IndexTag="1" AllowVectorExport="True" Left="480,00031" Top="0" Width="30,23610575" Height="15,11811024" DataSet="qMain" DataSetName="dsMain" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Color="16777215" Frame.Typ="15" Frame.Width="2" HAlign="haCenter" ParentFont="False" Text="[dsMain.&#34;CAT&#34;]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Height="15,11811024" Left="0" ParentFont="False" Top="96" Width="718,1107">
      <TfrxMemoView Name="Memo1" AllowVectorExport="True" Left="566,9295" Top="0" Width="151,1812" Height="15,11811024" Frame.Typ="0" HAlign="haRight" Text="РЎС‚СЂ. [Page#] РёР· [TotalPages#]"/>
    </TfrxPageFooter>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" HGuides.Text="" VGuides.Text="" DoubleBuffered="False" Height="600" ClientHeight="573" Left="519" Top="174" Width="828" Scaled="True" ClientWidth="820" OnActivate="DialogPage1OnActivate" OnDeactivate="DialogPage1OnDeactivate">
    <TfrxLabelControl Name="lblMain" Anchors="7" Left="0" Top="0" Width="820" Height="23" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Tahoma" Font.Style="1" ParentFont="False" ShowHint="True" Alignment="taCenter" AutoSize="False" Caption="Список сотрудников по подразделениям" Color="-16777201"/>
    <TfrxButtonControl Name="btOk" Anchors="12" Left="738" Top="539" Width="75" Height="25" ShowHint="True" Caption="Ok" ModalResult="1"/>
    <TfrxButtonControl Name="btCancel" Anchors="9" Left="8" Top="539" Width="75" Height="25" ShowHint="True" Caption="Отмена" ModalResult="2"/>
    <TfrxCheckListBoxControl Name="clbEmp" Anchors="15" Left="8" Top="64" Width="799" Height="466" ShowHint="True" Color="-16777211" Items.Text=""/>
    <TfrxDBLookupComboBox Name="dblDep" Anchors="7" Left="8" Top="32" Width="801" Height="21" ShowHint="True" AutoOpenDataSet="True" DataSet="qDep" DataSetName="dsDep" ListField="Name_Sub" KeyField="Key_Sub" DropDownWidth="0" DropDownRows="7" OnClick="DBLookupComboBox1OnClick"/>
  </TfrxDialogPage>
</TfrxReport>
