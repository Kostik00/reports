<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="6.9.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42934,7860694676" ReportOptions.Description.Text="" ReportOptions.Name="Активность перемещений по дням.fr3 Список заданий на перемещение" ReportOptions.LastChange="44280,6530032176" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   DateFrom.Date:=Date;&#13;&#10;   DateTo.Date:=Date;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="Subj" DataSetName="ФИО"/>
    <item DataSet="ERQuery1" DataSetName="ERQuery1"/>
  </Datasets>
  <TfrxDataPage Name="Data" HGuides.Text="" VGuides.Text="" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="Subj" UserName="ФИО" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="		SELECT      &#13;&#10;    Pr_MTask_Detail.Key_Sub, &#13;&#10;    S_Subjects.Name_Sub,&#13;&#10;    Count(Pr_MTask_Detail.Key_MTask )   Cnt                      &#13;&#10;		FROM            &#13;&#10;				Pr_MTask_Detail &#13;&#10;			 &#13;&#10;				INNER JOIN S_Subjects ON Pr_MTask_Detail.Key_Sub = S_Subjects.Key_Sub&#13;&#10;                                   &#13;&#10;&#13;&#10;		WHERE &#13;&#10;			 (&#13;&#10;        (Pr_MTask_Detail.DtZayavka  Between :Datefrom AND :DateTo)&#13;&#10;        OR &#13;&#10;        (Pr_MTask_Detail.DtCompl  Between :Datefrom AND :DateTo)&#13;&#10;        )&#13;&#10;&#13;&#10;GROUP BY &#13;&#10;    Pr_MTask_Detail.Key_Sub,&#13;&#10;    S_Subjects.Name_Sub&#13;&#10;&#13;&#10;HAVING(Count(Pr_MTask_Detail.Key_MTask )&#62;50)                        " PropData="05704C65667402680470546F70024C0A506172616D657465727301010C41000000204E616D653D224461746566726F6D222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746546726F6D2E446174652200010C3D000000204E616D653D2244617465546F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D2244617465546F2E44617465220000"/>
    <TfrxERQuery Name="ERQuery1" UserName="ERQuery1" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="Subj" IgnoreDupParams="False" SQL.Text="DECLARE @DateFrom datetime&#13;&#10;DECLARE @DateTo datetime&#13;&#10;DECLARE @Key_Sub int&#13;&#10;&#13;&#10;SET @DateFrom = :DateFrom  &#13;&#10;SET @DateTo = :DateTo    &#13;&#10;SET @Key_Sub = :Key_Sub  &#13;&#10;&#13;&#10;SELECT  Subj.*, TmpTimeTable.H -1 H, TblCnt.Cnt, TblCnt1.Cnt Cnt1         &#13;&#10;FROM&#13;&#10;	(&#13;&#10;		SELECT   NumRec H&#13;&#10;		FROM [dbo].[SYS_Days] &#13;&#10;		WHERE NumRec between 1  and 7  &#13;&#10;&#13;&#10;	) TmpTimeTable&#13;&#10;	CROSS JOIN &#13;&#10;	(&#13;&#10;		SELECT DISTINCT Pr_MTask_Detail.Key_Sub, S_Subjects.Name_Sub&#13;&#10;		FROM            &#13;&#10;				Pr_MTask_Detail &#13;&#10;&#13;&#10;				INNER JOIN S_Subjects ON Pr_MTask_Detail.Key_Sub = S_Subjects.Key_Sub&#13;&#10;   	WHERE &#13;&#10;			    Pr_MTask_Detail.DtCompl BETWEEN @DateFrom AND @DateTo&#13;&#10;      OR&#13;&#10;      	Pr_MTask_Detail.DtZayavka  BETWEEN @DateFrom AND @DateTo          &#13;&#10;&#13;&#10;	) Subj&#13;&#10;	LEFT JOIN &#13;&#10;	(&#13;&#10;&#13;&#10;		SELECT        &#13;&#10;			Pr_MTask_Detail.Key_Sub, &#13;&#10;			DATEPART(dw, Pr_MTask_Detail.DtCompl) AS H, &#13;&#10;			COUNT(Pr_MTask_Detail.Key_MTask) AS Cnt&#13;&#10;		FROM&#13;&#10;			Pr_MTask_Detail &#13;&#10;			INNER JOIN Pr_MTask&#13;&#10;				ON Pr_MTask.Key_MTask = Pr_MTask_Detail.Key_MTask&#13;&#10;		WHERE &#13;&#10;			    Pr_MTask_Detail.DtCompl BETWEEN @DateFrom AND @DateTo                                                                                              &#13;&#10;&#13;&#10;		GROUP BY &#13;&#10;			Pr_MTask_Detail.Key_Sub, &#13;&#10;			DATEPART(dw, Pr_MTask_Detail.DtCompl)&#13;&#10;	) TblCnt&#13;&#10;	ON&#13;&#10;		   	TblCnt.H=TmpTimeTable.H&#13;&#10;		AND TblCnt.Key_Sub = Subj.Key_Sub&#13;&#10;LEFT JOIN                        &#13;&#10;	(&#13;&#10;&#13;&#10;		SELECT        &#13;&#10;			Pr_MTask_Detail.Key_Sub, &#13;&#10;			DATEPART(dw, Pr_MTask_Detail.DtZayavka) AS H, &#13;&#10;			COUNT(Pr_MTask_Detail.Key_MTask) AS Cnt&#13;&#10;		FROM&#13;&#10;			Pr_MTask_Detail &#13;&#10;			&#13;&#10;		WHERE &#13;&#10;			Pr_MTask_Detail.DtZayavka  BETWEEN @DateFrom AND @DateTo&#13;&#10;--   AND Pr_MTask_Detail.DtCompl BETWEEN :DateFrom AND :DateTo                                                                                              &#13;&#10;			AND Pr_MTask_Detail.DtCompl is not null&#13;&#10;		GROUP BY &#13;&#10;			Pr_MTask_Detail.Key_Sub, &#13;&#10;			DATEPART(dw, Pr_MTask_Detail.DtZayavka)&#13;&#10;	) TblCnt1      &#13;&#10;	ON&#13;&#10;		   	TblCnt1.H=TmpTimeTable.H&#13;&#10;		AND TblCnt1.Key_Sub = Subj.Key_Sub  &#13;&#10;  &#13;&#10;WHERE Subj.Key_Sub= @Key_Sub                                                              &#13;&#10;ORDER BY Subj.Name_Sub, TmpTimeTable.H  " PropData="05704C6566740304010470546F7002500A506172616D657465727301010C41000000204E616D653D224461746546726F6D222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746546726F6D2E446174652200010C3D000000204E616D653D2244617465546F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D2244617465546F2E446174652200010C24000000204E616D653D224B65795F537562222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" HGuides.Text="" VGuides.Text="" DoubleBuffered="False" Height="200" ClientHeight="161" Left="408" Top="119" Width="300" Scaled="True" ClientWidth="284" OnActivate="DialogPage1OnActivate">
    <TfrxDateEditControl Name="DateFrom" Left="124" Top="24" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="42934" Time="42934" WeekNumbers="False"/>
    <TfrxDateEditControl Name="DateTo" Left="124" Top="68" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="42934,9999884259" Time="42934,9999884259" WeekNumbers="False"/>
    <TfrxButtonControl Name="OK" Left="192" Top="120" Width="75" Height="25" ShowHint="True" Caption="OK" ModalResult="1"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" HGuides.Text="" VGuides.Text="" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" Frame.Typ="0" MirrorMode="0">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="22,67718" Left="0" Top="16" Width="718,1107">
      <TfrxMemoView Name="Memo3" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="718,1107" Height="18,89765" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="РџРѕ РґРЅСЏРј РЅРµРґРµР»Рё Р·Р° РїРµСЂРёРѕРґ СЃ [DateFrom.Date] РїРѕ [DateTo.Date]">
        <Formats>
          <item FormatStr="dd.mm.yyyy" Kind="fkDateTime"/>
          <item FormatStr="dd.mm.yyyy" Kind="fkDateTime"/>
        </Formats>
      </TfrxMemoView>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="200,31509" Left="0" Top="60" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="Subj" DataSetName="ФИО" RowCount="0">
      <TfrxMemoView Name="Memo2" AllowVectorExport="True" Left="15,11812" Top="0" Width="400,63018" Height="18,89765" DataField="Name_Sub" DataSet="Subj" DataSetName="ФИО" Frame.Typ="0" Text="[Р¤РРћ.&#34;Name_Sub&#34;]"/>
      <TfrxChartView Name="Chart1" AllowVectorExport="True" Left="11,33859" Top="37,7953" Width="668,97681" Height="158,74026" HighlightColor="0" Frame.Typ="0" PropData="0543686172740AED0200005450463006544368617274054368617274044C656674020003546F7002000557696474680390010648656967687403FA00144261636B57616C6C2E50656E2E56697369626C65080E4368617274334450657263656E7402030D4672616D652E56697369626C6508165669657733444F7074696F6E732E526F746174696F6E02000A426576656C4F75746572070662764E6F6E6505436F6C6F720707636C5768697465000B544C696E655365726965730753657269657331194D61726B732E43616C6C6F75742E42727573682E436F6C6F720707636C426C61636B0D4D61726B732E56697369626C6508055469746C651206000000170430044F0432043A04380416506F696E7465722E496E666C6174654D617267696E73090D506F696E7465722E5374796C65070B707352656374616E676C650F506F696E7465722E56697369626C65080C5856616C7565732E4E616D650601580D5856616C7565732E4F72646572070B6C6F417363656E64696E670C5956616C7565732E4E616D650601590D5956616C7565732E4F7264657207066C6F4E6F6E6500000B544C696E655365726965730753657269657332194D61726B732E43616C6C6F75742E42727573682E436F6C6F720707636C426C61636B144D61726B732E43616C6C6F75742E4C656E67746802040F4D61726B732E4472617745766572790202114D61726B732E466F6E742E48656967687402F70D4D61726B732E56697369626C65080B536572696573436F6C6F72070C636C4D6F6E6579477265656E055469746C65120B0000001F043504400435043C043504490435043D0438044F0416506F696E7465722E496E666C6174654D617267696E73090D506F696E7465722E5374796C65070B707352656374616E676C650F506F696E7465722E56697369626C65080C5856616C7565732E4E616D650601580D5856616C7565732E4F72646572070B6C6F417363656E64696E670C5956616C7565732E4E616D650601590D5956616C7565732E4F7264657207066C6F4E6F6E650000000E4368617274456C65766174696F6E0359010A5365726965734461746101010CCE0000002044617461547970653D2264744442446174612220446174615365743D2245525175657279312220446174615365744E616D653D2245525175657279312220536F72744F726465723D22736F4E6F6E652220546F704E3D2230222058547970653D2278744E756D6265722220536F75726365323D2245525175657279312E262333343B436E7431262333343B2220536F75726365333D2245525175657279312E262333343B48262333343B222059536F757263653D2245525175657279312E262333343B436E7431262333343B2200010CCC0000002044617461547970653D2264744442446174612220446174615365743D2245525175657279312220446174615365744E616D653D2245525175657279312220536F72744F726465723D22736F4E6F6E652220546F704E3D2230222058547970653D2278744E756D6265722220536F75726365323D2245525175657279312E262333343B436E74262333343B2220536F75726365333D2245525175657279312E262333343B48262333343B222059536F757263653D2245525175657279312E262333343B436E74262333343B220000"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="22,67718" Left="0" Top="280" Width="718,1107">
      <TfrxMemoView Name="Memo1" AllowVectorExport="True" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" Frame.Typ="0" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
  </TfrxReportPage>
</TfrxReport>
