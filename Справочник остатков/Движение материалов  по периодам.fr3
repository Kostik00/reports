<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="6.9.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="44335,6100722222" ReportOptions.Description.Text="" ReportOptions.Name="Движение материалов  по периодам.fr3 Справочник остатков" ReportOptions.LastChange="44336,6219647454" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="MasterQRY" DataSetName="Сортам"/>
    <item DataSet="Detail" DataSetName="Движение"/>
  </Datasets>
  <TfrxDataPage Name="Data" HGuides.Text="" VGuides.Text="" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxERQuery Name="MasterQRY" UserName="Сортам" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT DISTINCT&#13;&#10;&#13;&#10; &#13;&#10;	T_VPredm.Name_Predm,&#13;&#10;	T_EdIzm.Name_K_Ed,&#13;&#10;	&#13;&#10;&#13;&#10;--	T_VPredm.MarkaPrn,&#13;&#10;	dbo.T_ExtractMainSortam(T_VPredm.Sortam, T_VPredm.Name_Predm)  Sortam,&#13;&#10;	dbo.T_OrderSortam(dbo.T_ExtractMainSortam(T_VPredm.Sortam, T_VPredm.Name_Predm))  OrderSortam&#13;&#10;&#13;&#10;FROM &#13;&#10;	A_VId_Mat&#13;&#10;	INNER JOIN T_VPredm&#13;&#10;		ON T_VPredm.Key_Predm = A_VId_Mat.Key_Predm&#13;&#10;	INNER JOIN T_EdIzm&#13;&#10;		ON T_EdIzm.Cod_Ed_Izm = T_VPredm.Sklad_Ed_Izm&#13;&#10;		AND  T_EdIzm.Name_K_Ed ='КГ'&#13;&#10;	INNER JOIN A_Nacl_Str&#13;&#10;		ON A_Nacl_Str.Key_ID_Mat = A_VId_Mat.Key_ID_Mat&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;WHERE &#13;&#10;	T_VPredm.MarkaPrn  like :Str1           &#13;&#10;OR         &#13;&#10;	T_VPredm.MarkaPrn  like :Str2       &#13;&#10;&#13;&#10;ORDER BY &#13;&#10;--MarkaPrn,&#13;&#10;Name_Predm,  OrderSortam" PropData="05704C65667402680470546F70024C0A506172616D657465727301010C37000000204E616D653D2253747231222044617461547970653D226674537472696E67222045787072657373696F6E3D22537472312E546578742200010C37000000204E616D653D2253747232222044617461547970653D226674537472696E67222045787072657373696F6E3D22537472322E54657874220000"/>
    <TfrxERQuery Name="Detail" UserName="Движение" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="MasterQRY" IgnoreDupParams="False" SQL.Text="DECLARE @Name_Predm varchar(500)&#13;&#10;DECLARE @MarkaPrn	varchar(500)&#13;&#10;DECLARE @Sortam		varchar(500)&#13;&#10;&#13;&#10;SET @Name_Predm= :Name_Predm     &#13;&#10;SET @MarkaPrn = :MarkaPrn  &#13;&#10;SET @Sortam = :Sortam&#13;&#10;  &#13;&#10;SELECT &#13;&#10;	Usr_PlnStr.N_Str, &#13;&#10;	Usr_PlnStr.StrName,&#13;&#10;	PrihodTbl.Prihod,&#13;&#10;	RashodTbl.Rashod&#13;&#10;FROM &#13;&#10;	Usr_PlnStr&#13;&#10;	INNER JOIN &#13;&#10;	(&#13;&#10;&#13;&#10;		SELECT &#13;&#10;			Usr_PlnStr.N_Str,&#13;&#10;			SUM(TblRashod.Rashod) Rashod&#13;&#10;		FROM&#13;&#10;			A_ID_Mat&#13;&#10;			INNER JOIN T_VPredm&#13;&#10;				ON T_VPredm.Key_Predm = A_ID_Mat.Key_Predm&#13;&#10;				AND T_VPredm.Name_Predm = @Name_Predm&#13;&#10;  &#13;&#10;	   AND (&#13;&#10;          T_VPredm.MarkaPrn  like :Str1        &#13;&#10;          OR         &#13;&#10;        	T_VPredm.MarkaPrn  like :Str2      &#13;&#10;        )            &#13;&#10;  &#13;&#10;				AND dbo.T_ExtractMainSortam(T_VPredm.Sortam, T_VPredm.Name_Predm) = @Sortam&#13;&#10;			CROSS JOIN Usr_PlnStr&#13;&#10;		&#13;&#10;			LEFT JOIN &#13;&#10;			(&#13;&#10;				SELECT &#13;&#10;					A_Nacl.DateAc,&#13;&#10;					A_Nacl_Str.Key_Id_Mat ,&#13;&#10;					A_Nacl_Str.KolvoInBaseEd- Isnull(SUM(Vozvrat.KolvoInBaseEd),0)  Rashod&#13;&#10;				FROM &#13;&#10;					A_Nacl&#13;&#10;					INNER JOIN 	A_Nacl_Str&#13;&#10;						ON A_Nacl_Str.Key_Nacl= A_Nacl.Key_Nacl&#13;&#10;					INNER jOIN S_ALL_Sub SubFrom&#13;&#10;						ON SubFrom.Key_Sub_Ver = A_Nacl.Key_Sub_Ver_From&#13;&#10;						AND SubFrom.Key_Class = 6&#13;&#10;					INNER jOIN S_ALL_Sub SubTo&#13;&#10;						ON SubTo.Key_Sub_Ver = A_Nacl.Key_Sub_Ver_To&#13;&#10;						AND SubTo.Key_Class = 1&#13;&#10;&#13;&#10;					LEFT JOIN  A_Nacl_Str Vozvrat&#13;&#10;						ON Vozvrat.Key_Nacl_Str_From = A_Nacl_Str.Key_Nacl_Str&#13;&#10;				GROUP BY &#13;&#10;					A_Nacl.DateAc,&#13;&#10;					A_Nacl_Str.Key_Id_Mat ,&#13;&#10;					A_Nacl_Str.KolvoInBaseEd&#13;&#10;&#13;&#10;			) TblRashod&#13;&#10;				ON TblRashod.Key_ID_Mat = A_ID_Mat.Key_ID_Mat&#13;&#10;				AND TblRashod.DateAc BETWEEN Usr_PlnStr.DateFrom AND Usr_PlnStr.DateTo&#13;&#10;		WHERE &#13;&#10;				Usr_PlnStr.Usr = User&#13;&#10;			AND Usr_PlnStr.ReportNum = 0&#13;&#10;		GROUP BY Usr_PlnStr.N_Str&#13;&#10;		&#13;&#10;	) RashodTbl&#13;&#10;		ON RashodTbl.N_Str = Usr_PlnStr.N_Str&#13;&#10;&#13;&#10;&#13;&#10;	LEFT JOIN &#13;&#10;	(&#13;&#10;&#13;&#10;		SELECT &#13;&#10;			Usr_PlnStr.N_Str,&#13;&#10;			SUM(TblPrihod.Prihod) Prihod&#13;&#10;		FROM&#13;&#10;			A_ID_Mat&#13;&#10;			INNER JOIN T_VPredm&#13;&#10;				ON T_VPredm.Key_Predm = A_ID_Mat.Key_Predm&#13;&#10;				AND T_VPredm.Name_Predm = @Name_Predm&#13;&#10;	   AND (&#13;&#10;          T_VPredm.MarkaPrn  like :Str1        &#13;&#10;          OR         &#13;&#10;        	T_VPredm.MarkaPrn  like :Str2      &#13;&#10;        )            &#13;&#10;				AND dbo.T_ExtractMainSortam(T_VPredm.Sortam, T_VPredm.Name_Predm) = @Sortam&#13;&#10;			CROSS JOIN Usr_PlnStr&#13;&#10;		&#13;&#10;			LEFT JOIN &#13;&#10;			(&#13;&#10;				SELECT &#13;&#10;					A_Nacl.DateAc,&#13;&#10;					A_Nacl_Str.Key_Id_Mat ,&#13;&#10;					A_Nacl_Str.KolvoInBaseEd   Prihod&#13;&#10;				FROM &#13;&#10;					A_Nacl&#13;&#10;					INNER JOIN 	A_Nacl_Str&#13;&#10;						ON A_Nacl_Str.Key_Nacl= A_Nacl.Key_Nacl&#13;&#10;					INNER jOIN S_ALL_Sub SubFrom&#13;&#10;						ON SubFrom.Key_Sub_Ver = A_Nacl.Key_Sub_Ver_From&#13;&#10;						AND SubFrom.Key_Class = 2&#13;&#10;					INNER jOIN S_ALL_Sub SubTo&#13;&#10;						ON SubTo.Key_Sub_Ver = A_Nacl.Key_Sub_Ver_To&#13;&#10;						AND SubTo.Key_Class = 6&#13;&#10; &#13;&#10;&#13;&#10;			) TblPrihod&#13;&#10;				ON TblPrihod.Key_ID_Mat = A_ID_Mat.Key_ID_Mat&#13;&#10;				AND TblPrihod.DateAc BETWEEN Usr_PlnStr.DateFrom AND Usr_PlnStr.DateTo&#13;&#10;		WHERE &#13;&#10;				Usr_PlnStr.Usr = User&#13;&#10;			AND Usr_PlnStr.ReportNum = 0&#13;&#10;		GROUP BY Usr_PlnStr.N_Str&#13;&#10;		&#13;&#10;	) PrihodTbl&#13;&#10;		ON PrihodTbl.N_Str = Usr_PlnStr.N_Str&#13;&#10;&#13;&#10;WHERE &#13;&#10;			Usr_PlnStr.Usr = User&#13;&#10;		AND Usr_PlnStr.ReportNum = 0&#13;&#10;ORDER BY  Usr_PlnStr.N_Str   " PropData="05704C65667403DC000470546F70026C0A506172616D657465727301010C27000000204E616D653D224E616D655F507265646D222044617461547970653D226674556E6B6E6F776E2200010C25000000204E616D653D224D61726B6150726E222044617461547970653D226674556E6B6E6F776E2200010C23000000204E616D653D22536F7274616D222044617461547970653D226674556E6B6E6F776E2200010C37000000204E616D653D2253747231222044617461547970653D226674537472696E67222045787072657373696F6E3D22537472312E546578742200010C37000000204E616D653D2253747232222044617461547970653D226674537472696E67222045787072657373696F6E3D22537472322E54657874220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="Form1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" HGuides.Text="" VGuides.Text="" DoubleBuffered="False" Height="200" ClientHeight="161" Left="415" Top="152" Width="300" Scaled="True" ClientWidth="284">
    <TfrxButtonControl Name="Button1" Left="196" Top="124" Width="75" Height="25" ShowHint="True" Caption="Button1" ModalResult="1"/>
    <TfrxEditControl Name="Str1" Left="148" Top="20" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="08Х18%"/>
    <TfrxEditControl Name="Str2" Left="148" Top="48" Width="121" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="12Х18%"/>
    <TfrxLabelControl Name="Label1" Left="24" Top="24" Width="31" Height="13" ShowHint="True" Caption="Label1" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" HGuides.Text="" VGuides.Text="" PaperWidth="420" PaperHeight="297" PaperSize="256" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" Frame.Typ="0" EndlessHeight="True" EndlessWidth="True" LargeDesignHeight="True" MirrorMode="0">
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="37,7953" Left="0" Top="122,834725" Width="1511,812" ColumnWidth="0" ColumnGap="0" DataSet="MasterQRY" DataSetName="Сортам" RowCount="0">
      <TfrxMemoView Name="Memo2" IndexTag="1" AllowVectorExport="True" Left="77,480365" Top="0" Width="147,40167" Height="37,7953" DataField="Sortam" DataSet="MasterQRY" DataSetName="Сортам" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[РЎРѕСЂС‚Р°Рј.&#34;Sortam&#34;]"/>
      <TfrxMemoView Name="Memo4" IndexTag="1" AllowVectorExport="True" Left="340,1577" Top="0" Width="64,25201" Height="18,89765" DataSet="Detail" DataSetName="Движение" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="13434828" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[Р”РІРёР¶РµРЅРёРµ.&#34;Prihod&#34;]"/>
      <TfrxMemoView Name="Memo6" IndexTag="1" AllowVectorExport="True" Left="340,1577" Top="18,89765" Width="64,25201" Height="18,89765" DataField="Rashod" DataSet="Detail" DataSetName="Движение" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="16774348" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[Р”РІРёР¶РµРЅРёРµ.&#34;Rashod&#34;]"/>
      <TfrxMemoView Name="Memo7" IndexTag="1" AllowVectorExport="True" Left="472,44125" Top="0" Width="94,48825" Height="18,89765" DataSet="Detail" DataSetName="Движение" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="13434828" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Р”РІРёР¶РµРЅРёРµ.&#34;Prihod&#34;&#62;, MasterData2)]"/>
      <TfrxMemoView Name="Memo8" IndexTag="1" AllowVectorExport="True" Left="472,44125" Top="18,89765" Width="94,48825" Height="18,89765" DataSet="Detail" DataSetName="Движение" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="16774348" HAlign="haRight" HideZeros="True" Highlight.ApplyFont="False" Highlight.Font.Charset="1" Highlight.Font.Color="255" Highlight.Font.Height="-13" Highlight.Font.Name="Arial" Highlight.Font.Style="0" Highlight.Condition="SUM(&#60;Движение.&#34;Prihod&#34;&#62;, MasterData2) &#60; SUM(&#60;Движение.&#34;Rashod&#34;&#62;, MasterData2)" Highlight.FillType="ftBrush" Highlight.Fill.BackColor="13408511" Highlight.Fill.ForeColor="536870911" Highlight.Frame.Typ="0" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Р”РІРёР¶РµРЅРёРµ.&#34;Rashod&#34;&#62;, MasterData2)]"/>
      <TfrxMemoView Name="Memo9" IndexTag="1" AllowVectorExport="True" Left="224,882035" Top="0" Width="39,685065" Height="18,89765" DataSet="Detail" DataSetName="Движение" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="13434828" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="РџРѕСЃС‚."/>
      <TfrxMemoView Name="Memo10" IndexTag="1" AllowVectorExport="True" Left="224,882035" Top="18,89765" Width="39,685065" Height="18,89765" DataSet="Detail" DataSetName="Движение" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="16774348" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="Р’С‹Рґ."/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="20,787415" Left="0" Top="79,37013" Width="1511,812" Condition="Сортам.&#34;Name_Predm&#34;" ReprintOnNewPage="True" OutlineText="Сортам.&#34;Name_Predm&#34;">
      <TfrxMemoView Name="Memo3" IndexTag="1" AllowVectorExport="True" Left="0" Top="0" Width="1509,922235" Height="18,89765" DataField="Name_Predm" DataSet="MasterQRY" DataSetName="Сортам" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="[РЎРѕСЂС‚Р°Рј.&#34;Name_Predm&#34;]"/>
    </TfrxGroupHeader>
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="1046,92981" Left="77,480365" Top="0" Vertical="True" Width="187,086735"/>
    <TfrxMasterData Name="MasterData2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="1046,92981" Left="340,1577" Top="0" Vertical="True" Width="64,25201" ColumnWidth="0" ColumnGap="0" DataSet="Detail" DataSetName="Движение" RowCount="0"/>
    <TfrxGroupHeader Name="GroupHeader3" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="37,7953" Left="0" Top="18,89765" Width="1511,812" Condition="1" ReprintOnNewPage="True" Stretched="True">
      <TfrxMemoView Name="Memo5" IndexTag="1" AllowVectorExport="True" Left="340,1577" Top="0" Width="64,25201" Height="37,7953" StretchMode="smMaxHeight" DataSet="Detail" DataSetName="Движение" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[Р”РІРёР¶РµРЅРёРµ.&#34;StrName&#34;]"/>
    </TfrxGroupHeader>
    <TfrxFooter Name="Footer1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="1046,92981" Left="472,44125" Top="0" Vertical="True" Width="94,48825"/>
  </TfrxReportPage>
</TfrxReport>
